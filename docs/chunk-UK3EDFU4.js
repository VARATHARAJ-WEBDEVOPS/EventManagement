import{a as Jl,f as __,g as Ns,i as x_,k as v_,m as b_,x as w_,y as y_}from"./chunk-DUUXXDJI.js";import{A as hd,B as O_,C as Uo,D as Pr,E as Ai,F as rf,G as md,H as P_,I as Os,J as Wo,K as pd,L as L_,M as gd,N as M_,O as ea,P as xr,a as de,b as Ds,c as Zl,d as E_,e as T_,f as k_,g as tr,h as S_,i as dd,j as A_,k as ti,l as C_,m as F_,n as ef,o as Ut,p as I_,q as R_,r as Tn,s as Zi,t as tf,u as Bo,v as N_,w as D_,x as Oe,y as Qr,z as qt}from"./chunk-34DONSSN.js";import{a as p_,e as g_}from"./chunk-7M4WHHWC.js";import{Ab as Is,Ac as h_,B as Po,Ba as Xl,Bb as ei,C as Z1,Ca as ks,Dc as m_,E as e_,Ha as Ss,I as Lo,Ia as $l,Ib as Mo,Jb as cd,K as t_,Kb as ld,L as r_,M as n_,Ob as Rs,P as nd,Q as Vl,R as id,T as i_,Ta as As,Tb as l_,Ub as f_,V as ki,Va as Si,W as ad,Wa as Dt,Xa as c_,Y as Es,Z as a_,a as K1,ba as qr,c as ws,ca as Mn,cb as En,ea as Yt,ec as fd,f as Y1,fb as jl,ga as Ve,gb as Kl,h as Wl,ha as Ts,i as q1,ia as sd,ic as Pa,k as Na,kb as od,l as ys,la as Da,lb as Cs,m as rd,ma as qi,mb as Qi,n as on,na as Bn,nb as Yl,o as Q1,oa as s_,ob as Ji,oc as ud,pb as Fs,r as Hl,rb as Un,s as Kt,sb as Jn,tb as Oa,ub as ql,va as zl,wa as Gl,wc as u_,xb as Ql,xc as d_,y as J1,za as o_,zb as Zn}from"./chunk-BFC4OSZC.js";import{a as Ki,b as Yi,f as x4,h as v4,j as lr}from"./chunk-ZC6IZ3YH.js";var Lb=x4((to,Tc)=>{"use strict";(function(){var e,r="4.17.21",t=200,n="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",i="Expected a function",a="Invalid `variable` option passed into `_.template`",o="__lodash_hash_undefined__",l=500,f="__lodash_placeholder__",d=1,h=2,p=4,g=1,x=2,v=1,_=2,y=4,N=8,R=16,T=32,z=64,J=128,U=256,D=512,j=30,V="...",re=800,te=16,X=1,me=2,Ce=3,he=1/0,Ae=9007199254740991,Se=17976931348623157e292,qe=NaN,pe=4294967295,Fe=pe-1,oe=pe>>>1,L=[["ary",J],["bind",v],["bindKey",_],["curry",N],["curryRight",R],["flip",D],["partial",T],["partialRight",z],["rearg",U]],K="[object Arguments]",W="[object Array]",B="[object AsyncFunction]",ae="[object Boolean]",Ee="[object Date]",ve="[object DOMException]",be="[object Error]",fe="[object Function]",Je="[object GeneratorFunction]",O="[object Map]",ht="[object Number]",rt="[object Null]",Ze="[object Object]",Xe="[object Promise]",we="[object Proxy]",gt="[object RegExp]",Tt="[object Set]",mr="[object String]",zr="[object Symbol]",ba="[object Undefined]",Gr="[object WeakMap]",Cr="[object WeakSet]",Fr="[object ArrayBuffer]",Ir="[object DataView]",mi="[object Float32Array]",Xt="[object Float64Array]",Xr="[object Int8Array]",He="[object Int16Array]",yt="[object Int32Array]",pr="[object Uint8Array]",Ct="[object Uint8ClampedArray]",Nn="[object Uint16Array]",as="[object Uint32Array]",Ou=/\b__p \+= '';/g,Pu=/\b(__p \+=) '' \+/g,Jc=/(__e\(.*?\)|\b__t\)) \+\n'';/g,po=/&(?:amp|lt|gt|quot|#39);/g,go=/[&<>"']/g,Lu=RegExp(po.source),Mu=RegExp(go.source),ss=/<%-([\s\S]+?)%>/g,Bu=/<%([\s\S]+?)%>/g,Zc=/<%=([\s\S]+?)%>/g,Uu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Wu=/^\w*$/,Hu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_o=/[\\^$.*+?()[\]{}|]/g,Vu=RegExp(_o.source),xo=/^\s+/,vo=/\s/,zu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Gu=/\{\n\/\* \[wrapped with (.+)\] \*/,Xu=/,? & /,w=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,C=/[()=,{}\[\]\/\s]/,S=/\\(\\)?/g,A=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,F=/\w*$/,I=/^[-+]0x[0-9a-f]+$/i,Y=/^0b[01]+$/i,ne=/^\[object .+?Constructor\]$/,Q=/^0o[0-7]+$/i,q=/^(?:0|[1-9]\d*)$/,Z=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ue=/($^)/,ge=/['\n\r\u2028\u2029\\]/g,Te="\\ud800-\\udfff",_e="\\u0300-\\u036f",xe="\\ufe20-\\ufe2f",Le="\\u20d0-\\u20ff",pt=_e+xe+Le,or="\\u2700-\\u27bf",Ft="a-z\\xdf-\\xf6\\xf8-\\xff",Rr="\\xac\\xb1\\xd7\\xf7",wa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ya="\\u2000-\\u206f",pi=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",os="A-Z\\xc0-\\xd6\\xd8-\\xde",mn="\\ufe0e\\ufe0f",Cp=Rr+wa+ya+pi,$u="['\u2019]",xy="["+Te+"]",Fp="["+Cp+"]",el="["+pt+"]",Ip="\\d+",vy="["+or+"]",Rp="["+Ft+"]",Np="[^"+Te+Cp+Ip+or+Ft+os+"]",ju="\\ud83c[\\udffb-\\udfff]",by="(?:"+el+"|"+ju+")",Dp="[^"+Te+"]",Ku="(?:\\ud83c[\\udde6-\\uddff]){2}",Yu="[\\ud800-\\udbff][\\udc00-\\udfff]",cs="["+os+"]",Op="\\u200d",Pp="(?:"+Rp+"|"+Np+")",wy="(?:"+cs+"|"+Np+")",Lp="(?:"+$u+"(?:d|ll|m|re|s|t|ve))?",Mp="(?:"+$u+"(?:D|LL|M|RE|S|T|VE))?",Bp=by+"?",Up="["+mn+"]?",yy="(?:"+Op+"(?:"+[Dp,Ku,Yu].join("|")+")"+Up+Bp+")*",Ey="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ty="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Wp=Up+Bp+yy,ky="(?:"+[vy,Ku,Yu].join("|")+")"+Wp,Sy="(?:"+[Dp+el+"?",el,Ku,Yu,xy].join("|")+")",Ay=RegExp($u,"g"),Cy=RegExp(el,"g"),qu=RegExp(ju+"(?="+ju+")|"+Sy+Wp,"g"),Fy=RegExp([cs+"?"+Rp+"+"+Lp+"(?="+[Fp,cs,"$"].join("|")+")",wy+"+"+Mp+"(?="+[Fp,cs+Pp,"$"].join("|")+")",cs+"?"+Pp+"+"+Lp,cs+"+"+Mp,Ty,Ey,Ip,ky].join("|"),"g"),Iy=RegExp("["+Op+Te+pt+mn+"]"),Ry=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ny=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Dy=-1,Et={};Et[mi]=Et[Xt]=Et[Xr]=Et[He]=Et[yt]=Et[pr]=Et[Ct]=Et[Nn]=Et[as]=!0,Et[K]=Et[W]=Et[Fr]=Et[ae]=Et[Ir]=Et[Ee]=Et[be]=Et[fe]=Et[O]=Et[ht]=Et[Ze]=Et[gt]=Et[Tt]=Et[mr]=Et[Gr]=!1;var vt={};vt[K]=vt[W]=vt[Fr]=vt[Ir]=vt[ae]=vt[Ee]=vt[mi]=vt[Xt]=vt[Xr]=vt[He]=vt[yt]=vt[O]=vt[ht]=vt[Ze]=vt[gt]=vt[Tt]=vt[mr]=vt[zr]=vt[pr]=vt[Ct]=vt[Nn]=vt[as]=!0,vt[be]=vt[fe]=vt[Gr]=!1;var Oy={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Py={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ly={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},My={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},By=parseFloat,Uy=parseInt,Hp=typeof global=="object"&&global&&global.Object===Object&&global,Wy=typeof self=="object"&&self&&self.Object===Object&&self,Zt=Hp||Wy||Function("return this")(),Qu=typeof to=="object"&&to&&!to.nodeType&&to,Ea=Qu&&typeof Tc=="object"&&Tc&&!Tc.nodeType&&Tc,Vp=Ea&&Ea.exports===Qu,Ju=Vp&&Hp.process,pn=function(){try{var H=Ea&&Ea.require&&Ea.require("util").types;return H||Ju&&Ju.binding&&Ju.binding("util")}catch{}}(),zp=pn&&pn.isArrayBuffer,Gp=pn&&pn.isDate,Xp=pn&&pn.isMap,$p=pn&&pn.isRegExp,jp=pn&&pn.isSet,Kp=pn&&pn.isTypedArray;function en(H,ie,ee){switch(ee.length){case 0:return H.call(ie);case 1:return H.call(ie,ee[0]);case 2:return H.call(ie,ee[0],ee[1]);case 3:return H.call(ie,ee[0],ee[1],ee[2])}return H.apply(ie,ee)}function Hy(H,ie,ee,ke){for(var Me=-1,ft=H==null?0:H.length;++Me<ft;){var $t=H[Me];ie(ke,$t,ee($t),H)}return ke}function gn(H,ie){for(var ee=-1,ke=H==null?0:H.length;++ee<ke&&ie(H[ee],ee,H)!==!1;);return H}function Vy(H,ie){for(var ee=H==null?0:H.length;ee--&&ie(H[ee],ee,H)!==!1;);return H}function Yp(H,ie){for(var ee=-1,ke=H==null?0:H.length;++ee<ke;)if(!ie(H[ee],ee,H))return!1;return!0}function Bi(H,ie){for(var ee=-1,ke=H==null?0:H.length,Me=0,ft=[];++ee<ke;){var $t=H[ee];ie($t,ee,H)&&(ft[Me++]=$t)}return ft}function tl(H,ie){var ee=H==null?0:H.length;return!!ee&&ls(H,ie,0)>-1}function Zu(H,ie,ee){for(var ke=-1,Me=H==null?0:H.length;++ke<Me;)if(ee(ie,H[ke]))return!0;return!1}function kt(H,ie){for(var ee=-1,ke=H==null?0:H.length,Me=Array(ke);++ee<ke;)Me[ee]=ie(H[ee],ee,H);return Me}function Ui(H,ie){for(var ee=-1,ke=ie.length,Me=H.length;++ee<ke;)H[Me+ee]=ie[ee];return H}function e0(H,ie,ee,ke){var Me=-1,ft=H==null?0:H.length;for(ke&&ft&&(ee=H[++Me]);++Me<ft;)ee=ie(ee,H[Me],Me,H);return ee}function zy(H,ie,ee,ke){var Me=H==null?0:H.length;for(ke&&Me&&(ee=H[--Me]);Me--;)ee=ie(ee,H[Me],Me,H);return ee}function t0(H,ie){for(var ee=-1,ke=H==null?0:H.length;++ee<ke;)if(ie(H[ee],ee,H))return!0;return!1}var Gy=r0("length");function Xy(H){return H.split("")}function $y(H){return H.match(w)||[]}function qp(H,ie,ee){var ke;return ee(H,function(Me,ft,$t){if(ie(Me,ft,$t))return ke=ft,!1}),ke}function rl(H,ie,ee,ke){for(var Me=H.length,ft=ee+(ke?1:-1);ke?ft--:++ft<Me;)if(ie(H[ft],ft,H))return ft;return-1}function ls(H,ie,ee){return ie===ie?iE(H,ie,ee):rl(H,Qp,ee)}function jy(H,ie,ee,ke){for(var Me=ee-1,ft=H.length;++Me<ft;)if(ke(H[Me],ie))return Me;return-1}function Qp(H){return H!==H}function Jp(H,ie){var ee=H==null?0:H.length;return ee?i0(H,ie)/ee:qe}function r0(H){return function(ie){return ie==null?e:ie[H]}}function n0(H){return function(ie){return H==null?e:H[ie]}}function Zp(H,ie,ee,ke,Me){return Me(H,function(ft,$t,_t){ee=ke?(ke=!1,ft):ie(ee,ft,$t,_t)}),ee}function Ky(H,ie){var ee=H.length;for(H.sort(ie);ee--;)H[ee]=H[ee].value;return H}function i0(H,ie){for(var ee,ke=-1,Me=H.length;++ke<Me;){var ft=ie(H[ke]);ft!==e&&(ee=ee===e?ft:ee+ft)}return ee}function a0(H,ie){for(var ee=-1,ke=Array(H);++ee<H;)ke[ee]=ie(ee);return ke}function Yy(H,ie){return kt(ie,function(ee){return[ee,H[ee]]})}function eg(H){return H&&H.slice(0,ig(H)+1).replace(xo,"")}function tn(H){return function(ie){return H(ie)}}function s0(H,ie){return kt(ie,function(ee){return H[ee]})}function bo(H,ie){return H.has(ie)}function tg(H,ie){for(var ee=-1,ke=H.length;++ee<ke&&ls(ie,H[ee],0)>-1;);return ee}function rg(H,ie){for(var ee=H.length;ee--&&ls(ie,H[ee],0)>-1;);return ee}function qy(H,ie){for(var ee=H.length,ke=0;ee--;)H[ee]===ie&&++ke;return ke}var Qy=n0(Oy),Jy=n0(Py);function Zy(H){return"\\"+My[H]}function eE(H,ie){return H==null?e:H[ie]}function fs(H){return Iy.test(H)}function tE(H){return Ry.test(H)}function rE(H){for(var ie,ee=[];!(ie=H.next()).done;)ee.push(ie.value);return ee}function o0(H){var ie=-1,ee=Array(H.size);return H.forEach(function(ke,Me){ee[++ie]=[Me,ke]}),ee}function ng(H,ie){return function(ee){return H(ie(ee))}}function Wi(H,ie){for(var ee=-1,ke=H.length,Me=0,ft=[];++ee<ke;){var $t=H[ee];($t===ie||$t===f)&&(H[ee]=f,ft[Me++]=ee)}return ft}function nl(H){var ie=-1,ee=Array(H.size);return H.forEach(function(ke){ee[++ie]=ke}),ee}function nE(H){var ie=-1,ee=Array(H.size);return H.forEach(function(ke){ee[++ie]=[ke,ke]}),ee}function iE(H,ie,ee){for(var ke=ee-1,Me=H.length;++ke<Me;)if(H[ke]===ie)return ke;return-1}function aE(H,ie,ee){for(var ke=ee+1;ke--;)if(H[ke]===ie)return ke;return ke}function us(H){return fs(H)?oE(H):Gy(H)}function Dn(H){return fs(H)?cE(H):Xy(H)}function ig(H){for(var ie=H.length;ie--&&vo.test(H.charAt(ie)););return ie}var sE=n0(Ly);function oE(H){for(var ie=qu.lastIndex=0;qu.test(H);)++ie;return ie}function cE(H){return H.match(qu)||[]}function lE(H){return H.match(Fy)||[]}var fE=function H(ie){ie=ie==null?Zt:Hi.defaults(Zt.Object(),ie,Hi.pick(Zt,Ny));var ee=ie.Array,ke=ie.Date,Me=ie.Error,ft=ie.Function,$t=ie.Math,_t=ie.Object,c0=ie.RegExp,uE=ie.String,_n=ie.TypeError,il=ee.prototype,dE=ft.prototype,ds=_t.prototype,al=ie["__core-js_shared__"],sl=dE.toString,mt=ds.hasOwnProperty,hE=0,ag=function(){var s=/[^.]+$/.exec(al&&al.keys&&al.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),ol=ds.toString,mE=sl.call(_t),pE=Zt._,gE=c0("^"+sl.call(mt).replace(_o,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cl=Vp?ie.Buffer:e,Vi=ie.Symbol,ll=ie.Uint8Array,sg=cl?cl.allocUnsafe:e,fl=ng(_t.getPrototypeOf,_t),og=_t.create,cg=ds.propertyIsEnumerable,ul=il.splice,lg=Vi?Vi.isConcatSpreadable:e,wo=Vi?Vi.iterator:e,Ta=Vi?Vi.toStringTag:e,dl=function(){try{var s=Fa(_t,"defineProperty");return s({},"",{}),s}catch{}}(),_E=ie.clearTimeout!==Zt.clearTimeout&&ie.clearTimeout,xE=ke&&ke.now!==Zt.Date.now&&ke.now,vE=ie.setTimeout!==Zt.setTimeout&&ie.setTimeout,hl=$t.ceil,ml=$t.floor,l0=_t.getOwnPropertySymbols,bE=cl?cl.isBuffer:e,fg=ie.isFinite,wE=il.join,yE=ng(_t.keys,_t),jt=$t.max,gr=$t.min,EE=ke.now,TE=ie.parseInt,ug=$t.random,kE=il.reverse,f0=Fa(ie,"DataView"),yo=Fa(ie,"Map"),u0=Fa(ie,"Promise"),hs=Fa(ie,"Set"),Eo=Fa(ie,"WeakMap"),To=Fa(_t,"create"),pl=Eo&&new Eo,ms={},SE=Ia(f0),AE=Ia(yo),CE=Ia(u0),FE=Ia(hs),IE=Ia(Eo),gl=Vi?Vi.prototype:e,ko=gl?gl.valueOf:e,dg=gl?gl.toString:e;function E(s){if(Nt(s)&&!Ue(s)&&!(s instanceof tt)){if(s instanceof xn)return s;if(mt.call(s,"__wrapped__"))return h1(s)}return new xn(s)}var ps=function(){function s(){}return function(c){if(!It(c))return{};if(og)return og(c);s.prototype=c;var u=new s;return s.prototype=e,u}}();function _l(){}function xn(s,c){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!c,this.__index__=0,this.__values__=e}E.templateSettings={escape:ss,evaluate:Bu,interpolate:Zc,variable:"",imports:{_:E}},E.prototype=_l.prototype,E.prototype.constructor=E,xn.prototype=ps(_l.prototype),xn.prototype.constructor=xn;function tt(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=pe,this.__views__=[]}function RE(){var s=new tt(this.__wrapped__);return s.__actions__=$r(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=$r(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=$r(this.__views__),s}function NE(){if(this.__filtered__){var s=new tt(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function DE(){var s=this.__wrapped__.value(),c=this.__dir__,u=Ue(s),m=c<0,b=u?s.length:0,k=XT(0,b,this.__views__),P=k.start,M=k.end,G=M-P,se=m?M:P-1,ce=this.__iteratees__,le=ce.length,ye=0,Ie=gr(G,this.__takeCount__);if(!u||!m&&b==G&&Ie==G)return Lg(s,this.__actions__);var Ne=[];e:for(;G--&&ye<Ie;){se+=c;for(var $e=-1,De=s[se];++$e<le;){var et=ce[$e],nt=et.iteratee,an=et.type,Or=nt(De);if(an==me)De=Or;else if(!Or){if(an==X)continue e;break e}}Ne[ye++]=De}return Ne}tt.prototype=ps(_l.prototype),tt.prototype.constructor=tt;function ka(s){var c=-1,u=s==null?0:s.length;for(this.clear();++c<u;){var m=s[c];this.set(m[0],m[1])}}function OE(){this.__data__=To?To(null):{},this.size=0}function PE(s){var c=this.has(s)&&delete this.__data__[s];return this.size-=c?1:0,c}function LE(s){var c=this.__data__;if(To){var u=c[s];return u===o?e:u}return mt.call(c,s)?c[s]:e}function ME(s){var c=this.__data__;return To?c[s]!==e:mt.call(c,s)}function BE(s,c){var u=this.__data__;return this.size+=this.has(s)?0:1,u[s]=To&&c===e?o:c,this}ka.prototype.clear=OE,ka.prototype.delete=PE,ka.prototype.get=LE,ka.prototype.has=ME,ka.prototype.set=BE;function gi(s){var c=-1,u=s==null?0:s.length;for(this.clear();++c<u;){var m=s[c];this.set(m[0],m[1])}}function UE(){this.__data__=[],this.size=0}function WE(s){var c=this.__data__,u=xl(c,s);if(u<0)return!1;var m=c.length-1;return u==m?c.pop():ul.call(c,u,1),--this.size,!0}function HE(s){var c=this.__data__,u=xl(c,s);return u<0?e:c[u][1]}function VE(s){return xl(this.__data__,s)>-1}function zE(s,c){var u=this.__data__,m=xl(u,s);return m<0?(++this.size,u.push([s,c])):u[m][1]=c,this}gi.prototype.clear=UE,gi.prototype.delete=WE,gi.prototype.get=HE,gi.prototype.has=VE,gi.prototype.set=zE;function _i(s){var c=-1,u=s==null?0:s.length;for(this.clear();++c<u;){var m=s[c];this.set(m[0],m[1])}}function GE(){this.size=0,this.__data__={hash:new ka,map:new(yo||gi),string:new ka}}function XE(s){var c=Il(this,s).delete(s);return this.size-=c?1:0,c}function $E(s){return Il(this,s).get(s)}function jE(s){return Il(this,s).has(s)}function KE(s,c){var u=Il(this,s),m=u.size;return u.set(s,c),this.size+=u.size==m?0:1,this}_i.prototype.clear=GE,_i.prototype.delete=XE,_i.prototype.get=$E,_i.prototype.has=jE,_i.prototype.set=KE;function Sa(s){var c=-1,u=s==null?0:s.length;for(this.__data__=new _i;++c<u;)this.add(s[c])}function YE(s){return this.__data__.set(s,o),this}function qE(s){return this.__data__.has(s)}Sa.prototype.add=Sa.prototype.push=YE,Sa.prototype.has=qE;function On(s){var c=this.__data__=new gi(s);this.size=c.size}function QE(){this.__data__=new gi,this.size=0}function JE(s){var c=this.__data__,u=c.delete(s);return this.size=c.size,u}function ZE(s){return this.__data__.get(s)}function eT(s){return this.__data__.has(s)}function tT(s,c){var u=this.__data__;if(u instanceof gi){var m=u.__data__;if(!yo||m.length<t-1)return m.push([s,c]),this.size=++u.size,this;u=this.__data__=new _i(m)}return u.set(s,c),this.size=u.size,this}On.prototype.clear=QE,On.prototype.delete=JE,On.prototype.get=ZE,On.prototype.has=eT,On.prototype.set=tT;function hg(s,c){var u=Ue(s),m=!u&&Ra(s),b=!u&&!m&&ji(s),k=!u&&!m&&!b&&vs(s),P=u||m||b||k,M=P?a0(s.length,uE):[],G=M.length;for(var se in s)(c||mt.call(s,se))&&!(P&&(se=="length"||b&&(se=="offset"||se=="parent")||k&&(se=="buffer"||se=="byteLength"||se=="byteOffset")||wi(se,G)))&&M.push(se);return M}function mg(s){var c=s.length;return c?s[y0(0,c-1)]:e}function rT(s,c){return Rl($r(s),Aa(c,0,s.length))}function nT(s){return Rl($r(s))}function d0(s,c,u){(u!==e&&!Pn(s[c],u)||u===e&&!(c in s))&&xi(s,c,u)}function So(s,c,u){var m=s[c];(!(mt.call(s,c)&&Pn(m,u))||u===e&&!(c in s))&&xi(s,c,u)}function xl(s,c){for(var u=s.length;u--;)if(Pn(s[u][0],c))return u;return-1}function iT(s,c,u,m){return zi(s,function(b,k,P){c(m,b,u(b),P)}),m}function pg(s,c){return s&&qn(c,er(c),s)}function aT(s,c){return s&&qn(c,Kr(c),s)}function xi(s,c,u){c=="__proto__"&&dl?dl(s,c,{configurable:!0,enumerable:!0,value:u,writable:!0}):s[c]=u}function h0(s,c){for(var u=-1,m=c.length,b=ee(m),k=s==null;++u<m;)b[u]=k?e:j0(s,c[u]);return b}function Aa(s,c,u){return s===s&&(u!==e&&(s=s<=u?s:u),c!==e&&(s=s>=c?s:c)),s}function vn(s,c,u,m,b,k){var P,M=c&d,G=c&h,se=c&p;if(u&&(P=b?u(s,m,b,k):u(s)),P!==e)return P;if(!It(s))return s;var ce=Ue(s);if(ce){if(P=jT(s),!M)return $r(s,P)}else{var le=_r(s),ye=le==fe||le==Je;if(ji(s))return Ug(s,M);if(le==Ze||le==K||ye&&!b){if(P=G||ye?{}:i1(s),!M)return G?LT(s,aT(P,s)):PT(s,pg(P,s))}else{if(!vt[le])return b?s:{};P=KT(s,le,M)}}k||(k=new On);var Ie=k.get(s);if(Ie)return Ie;k.set(s,P),D1(s)?s.forEach(function(De){P.add(vn(De,c,u,De,s,k))}):R1(s)&&s.forEach(function(De,et){P.set(et,vn(De,c,u,et,s,k))});var Ne=se?G?D0:N0:G?Kr:er,$e=ce?e:Ne(s);return gn($e||s,function(De,et){$e&&(et=De,De=s[et]),So(P,et,vn(De,c,u,et,s,k))}),P}function sT(s){var c=er(s);return function(u){return gg(u,s,c)}}function gg(s,c,u){var m=u.length;if(s==null)return!m;for(s=_t(s);m--;){var b=u[m],k=c[b],P=s[b];if(P===e&&!(b in s)||!k(P))return!1}return!0}function _g(s,c,u){if(typeof s!="function")throw new _n(i);return Do(function(){s.apply(e,u)},c)}function Ao(s,c,u,m){var b=-1,k=tl,P=!0,M=s.length,G=[],se=c.length;if(!M)return G;u&&(c=kt(c,tn(u))),m?(k=Zu,P=!1):c.length>=t&&(k=bo,P=!1,c=new Sa(c));e:for(;++b<M;){var ce=s[b],le=u==null?ce:u(ce);if(ce=m||ce!==0?ce:0,P&&le===le){for(var ye=se;ye--;)if(c[ye]===le)continue e;G.push(ce)}else k(c,le,m)||G.push(ce)}return G}var zi=Gg(Yn),xg=Gg(p0,!0);function oT(s,c){var u=!0;return zi(s,function(m,b,k){return u=!!c(m,b,k),u}),u}function vl(s,c,u){for(var m=-1,b=s.length;++m<b;){var k=s[m],P=c(k);if(P!=null&&(M===e?P===P&&!nn(P):u(P,M)))var M=P,G=k}return G}function cT(s,c,u,m){var b=s.length;for(u=Ge(u),u<0&&(u=-u>b?0:b+u),m=m===e||m>b?b:Ge(m),m<0&&(m+=b),m=u>m?0:P1(m);u<m;)s[u++]=c;return s}function vg(s,c){var u=[];return zi(s,function(m,b,k){c(m,b,k)&&u.push(m)}),u}function cr(s,c,u,m,b){var k=-1,P=s.length;for(u||(u=qT),b||(b=[]);++k<P;){var M=s[k];c>0&&u(M)?c>1?cr(M,c-1,u,m,b):Ui(b,M):m||(b[b.length]=M)}return b}var m0=Xg(),bg=Xg(!0);function Yn(s,c){return s&&m0(s,c,er)}function p0(s,c){return s&&bg(s,c,er)}function bl(s,c){return Bi(c,function(u){return yi(s[u])})}function Ca(s,c){c=Xi(c,s);for(var u=0,m=c.length;s!=null&&u<m;)s=s[Qn(c[u++])];return u&&u==m?s:e}function wg(s,c,u){var m=c(s);return Ue(s)?m:Ui(m,u(s))}function Nr(s){return s==null?s===e?ba:rt:Ta&&Ta in _t(s)?GT(s):nk(s)}function g0(s,c){return s>c}function lT(s,c){return s!=null&&mt.call(s,c)}function fT(s,c){return s!=null&&c in _t(s)}function uT(s,c,u){return s>=gr(c,u)&&s<jt(c,u)}function _0(s,c,u){for(var m=u?Zu:tl,b=s[0].length,k=s.length,P=k,M=ee(k),G=1/0,se=[];P--;){var ce=s[P];P&&c&&(ce=kt(ce,tn(c))),G=gr(ce.length,G),M[P]=!u&&(c||b>=120&&ce.length>=120)?new Sa(P&&ce):e}ce=s[0];var le=-1,ye=M[0];e:for(;++le<b&&se.length<G;){var Ie=ce[le],Ne=c?c(Ie):Ie;if(Ie=u||Ie!==0?Ie:0,!(ye?bo(ye,Ne):m(se,Ne,u))){for(P=k;--P;){var $e=M[P];if(!($e?bo($e,Ne):m(s[P],Ne,u)))continue e}ye&&ye.push(Ne),se.push(Ie)}}return se}function dT(s,c,u,m){return Yn(s,function(b,k,P){c(m,u(b),k,P)}),m}function Co(s,c,u){c=Xi(c,s),s=c1(s,c);var m=s==null?s:s[Qn(wn(c))];return m==null?e:en(m,s,u)}function yg(s){return Nt(s)&&Nr(s)==K}function hT(s){return Nt(s)&&Nr(s)==Fr}function mT(s){return Nt(s)&&Nr(s)==Ee}function Fo(s,c,u,m,b){return s===c?!0:s==null||c==null||!Nt(s)&&!Nt(c)?s!==s&&c!==c:pT(s,c,u,m,Fo,b)}function pT(s,c,u,m,b,k){var P=Ue(s),M=Ue(c),G=P?W:_r(s),se=M?W:_r(c);G=G==K?Ze:G,se=se==K?Ze:se;var ce=G==Ze,le=se==Ze,ye=G==se;if(ye&&ji(s)){if(!ji(c))return!1;P=!0,ce=!1}if(ye&&!ce)return k||(k=new On),P||vs(s)?t1(s,c,u,m,b,k):VT(s,c,G,u,m,b,k);if(!(u&g)){var Ie=ce&&mt.call(s,"__wrapped__"),Ne=le&&mt.call(c,"__wrapped__");if(Ie||Ne){var $e=Ie?s.value():s,De=Ne?c.value():c;return k||(k=new On),b($e,De,u,m,k)}}return ye?(k||(k=new On),zT(s,c,u,m,b,k)):!1}function gT(s){return Nt(s)&&_r(s)==O}function x0(s,c,u,m){var b=u.length,k=b,P=!m;if(s==null)return!k;for(s=_t(s);b--;){var M=u[b];if(P&&M[2]?M[1]!==s[M[0]]:!(M[0]in s))return!1}for(;++b<k;){M=u[b];var G=M[0],se=s[G],ce=M[1];if(P&&M[2]){if(se===e&&!(G in s))return!1}else{var le=new On;if(m)var ye=m(se,ce,G,s,c,le);if(!(ye===e?Fo(ce,se,g|x,m,le):ye))return!1}}return!0}function Eg(s){if(!It(s)||JT(s))return!1;var c=yi(s)?gE:ne;return c.test(Ia(s))}function _T(s){return Nt(s)&&Nr(s)==gt}function xT(s){return Nt(s)&&_r(s)==Tt}function vT(s){return Nt(s)&&Ml(s.length)&&!!Et[Nr(s)]}function Tg(s){return typeof s=="function"?s:s==null?Yr:typeof s=="object"?Ue(s)?Ag(s[0],s[1]):Sg(s):$1(s)}function v0(s){if(!No(s))return yE(s);var c=[];for(var u in _t(s))mt.call(s,u)&&u!="constructor"&&c.push(u);return c}function bT(s){if(!It(s))return rk(s);var c=No(s),u=[];for(var m in s)m=="constructor"&&(c||!mt.call(s,m))||u.push(m);return u}function b0(s,c){return s<c}function kg(s,c){var u=-1,m=jr(s)?ee(s.length):[];return zi(s,function(b,k,P){m[++u]=c(b,k,P)}),m}function Sg(s){var c=P0(s);return c.length==1&&c[0][2]?s1(c[0][0],c[0][1]):function(u){return u===s||x0(u,s,c)}}function Ag(s,c){return M0(s)&&a1(c)?s1(Qn(s),c):function(u){var m=j0(u,s);return m===e&&m===c?K0(u,s):Fo(c,m,g|x)}}function wl(s,c,u,m,b){s!==c&&m0(c,function(k,P){if(b||(b=new On),It(k))wT(s,c,P,u,wl,m,b);else{var M=m?m(U0(s,P),k,P+"",s,c,b):e;M===e&&(M=k),d0(s,P,M)}},Kr)}function wT(s,c,u,m,b,k,P){var M=U0(s,u),G=U0(c,u),se=P.get(G);if(se){d0(s,u,se);return}var ce=k?k(M,G,u+"",s,c,P):e,le=ce===e;if(le){var ye=Ue(G),Ie=!ye&&ji(G),Ne=!ye&&!Ie&&vs(G);ce=G,ye||Ie||Ne?Ue(M)?ce=M:Lt(M)?ce=$r(M):Ie?(le=!1,ce=Ug(G,!0)):Ne?(le=!1,ce=Wg(G,!0)):ce=[]:Oo(G)||Ra(G)?(ce=M,Ra(M)?ce=L1(M):(!It(M)||yi(M))&&(ce=i1(G))):le=!1}le&&(P.set(G,ce),b(ce,G,m,k,P),P.delete(G)),d0(s,u,ce)}function Cg(s,c){var u=s.length;if(u)return c+=c<0?u:0,wi(c,u)?s[c]:e}function Fg(s,c,u){c.length?c=kt(c,function(k){return Ue(k)?function(P){return Ca(P,k.length===1?k[0]:k)}:k}):c=[Yr];var m=-1;c=kt(c,tn(Re()));var b=kg(s,function(k,P,M){var G=kt(c,function(se){return se(k)});return{criteria:G,index:++m,value:k}});return Ky(b,function(k,P){return OT(k,P,u)})}function yT(s,c){return Ig(s,c,function(u,m){return K0(s,m)})}function Ig(s,c,u){for(var m=-1,b=c.length,k={};++m<b;){var P=c[m],M=Ca(s,P);u(M,P)&&Io(k,Xi(P,s),M)}return k}function ET(s){return function(c){return Ca(c,s)}}function w0(s,c,u,m){var b=m?jy:ls,k=-1,P=c.length,M=s;for(s===c&&(c=$r(c)),u&&(M=kt(s,tn(u)));++k<P;)for(var G=0,se=c[k],ce=u?u(se):se;(G=b(M,ce,G,m))>-1;)M!==s&&ul.call(M,G,1),ul.call(s,G,1);return s}function Rg(s,c){for(var u=s?c.length:0,m=u-1;u--;){var b=c[u];if(u==m||b!==k){var k=b;wi(b)?ul.call(s,b,1):k0(s,b)}}return s}function y0(s,c){return s+ml(ug()*(c-s+1))}function TT(s,c,u,m){for(var b=-1,k=jt(hl((c-s)/(u||1)),0),P=ee(k);k--;)P[m?k:++b]=s,s+=u;return P}function E0(s,c){var u="";if(!s||c<1||c>Ae)return u;do c%2&&(u+=s),c=ml(c/2),c&&(s+=s);while(c);return u}function je(s,c){return W0(o1(s,c,Yr),s+"")}function kT(s){return mg(bs(s))}function ST(s,c){var u=bs(s);return Rl(u,Aa(c,0,u.length))}function Io(s,c,u,m){if(!It(s))return s;c=Xi(c,s);for(var b=-1,k=c.length,P=k-1,M=s;M!=null&&++b<k;){var G=Qn(c[b]),se=u;if(G==="__proto__"||G==="constructor"||G==="prototype")return s;if(b!=P){var ce=M[G];se=m?m(ce,G,M):e,se===e&&(se=It(ce)?ce:wi(c[b+1])?[]:{})}So(M,G,se),M=M[G]}return s}var Ng=pl?function(s,c){return pl.set(s,c),s}:Yr,AT=dl?function(s,c){return dl(s,"toString",{configurable:!0,enumerable:!1,value:q0(c),writable:!0})}:Yr;function CT(s){return Rl(bs(s))}function bn(s,c,u){var m=-1,b=s.length;c<0&&(c=-c>b?0:b+c),u=u>b?b:u,u<0&&(u+=b),b=c>u?0:u-c>>>0,c>>>=0;for(var k=ee(b);++m<b;)k[m]=s[m+c];return k}function FT(s,c){var u;return zi(s,function(m,b,k){return u=c(m,b,k),!u}),!!u}function yl(s,c,u){var m=0,b=s==null?m:s.length;if(typeof c=="number"&&c===c&&b<=oe){for(;m<b;){var k=m+b>>>1,P=s[k];P!==null&&!nn(P)&&(u?P<=c:P<c)?m=k+1:b=k}return b}return T0(s,c,Yr,u)}function T0(s,c,u,m){var b=0,k=s==null?0:s.length;if(k===0)return 0;c=u(c);for(var P=c!==c,M=c===null,G=nn(c),se=c===e;b<k;){var ce=ml((b+k)/2),le=u(s[ce]),ye=le!==e,Ie=le===null,Ne=le===le,$e=nn(le);if(P)var De=m||Ne;else se?De=Ne&&(m||ye):M?De=Ne&&ye&&(m||!Ie):G?De=Ne&&ye&&!Ie&&(m||!$e):Ie||$e?De=!1:De=m?le<=c:le<c;De?b=ce+1:k=ce}return gr(k,Fe)}function Dg(s,c){for(var u=-1,m=s.length,b=0,k=[];++u<m;){var P=s[u],M=c?c(P):P;if(!u||!Pn(M,G)){var G=M;k[b++]=P===0?0:P}}return k}function Og(s){return typeof s=="number"?s:nn(s)?qe:+s}function rn(s){if(typeof s=="string")return s;if(Ue(s))return kt(s,rn)+"";if(nn(s))return dg?dg.call(s):"";var c=s+"";return c=="0"&&1/s==-he?"-0":c}function Gi(s,c,u){var m=-1,b=tl,k=s.length,P=!0,M=[],G=M;if(u)P=!1,b=Zu;else if(k>=t){var se=c?null:WT(s);if(se)return nl(se);P=!1,b=bo,G=new Sa}else G=c?[]:M;e:for(;++m<k;){var ce=s[m],le=c?c(ce):ce;if(ce=u||ce!==0?ce:0,P&&le===le){for(var ye=G.length;ye--;)if(G[ye]===le)continue e;c&&G.push(le),M.push(ce)}else b(G,le,u)||(G!==M&&G.push(le),M.push(ce))}return M}function k0(s,c){return c=Xi(c,s),s=c1(s,c),s==null||delete s[Qn(wn(c))]}function Pg(s,c,u,m){return Io(s,c,u(Ca(s,c)),m)}function El(s,c,u,m){for(var b=s.length,k=m?b:-1;(m?k--:++k<b)&&c(s[k],k,s););return u?bn(s,m?0:k,m?k+1:b):bn(s,m?k+1:0,m?b:k)}function Lg(s,c){var u=s;return u instanceof tt&&(u=u.value()),e0(c,function(m,b){return b.func.apply(b.thisArg,Ui([m],b.args))},u)}function S0(s,c,u){var m=s.length;if(m<2)return m?Gi(s[0]):[];for(var b=-1,k=ee(m);++b<m;)for(var P=s[b],M=-1;++M<m;)M!=b&&(k[b]=Ao(k[b]||P,s[M],c,u));return Gi(cr(k,1),c,u)}function Mg(s,c,u){for(var m=-1,b=s.length,k=c.length,P={};++m<b;){var M=m<k?c[m]:e;u(P,s[m],M)}return P}function A0(s){return Lt(s)?s:[]}function C0(s){return typeof s=="function"?s:Yr}function Xi(s,c){return Ue(s)?s:M0(s,c)?[s]:d1(ut(s))}var IT=je;function $i(s,c,u){var m=s.length;return u=u===e?m:u,!c&&u>=m?s:bn(s,c,u)}var Bg=_E||function(s){return Zt.clearTimeout(s)};function Ug(s,c){if(c)return s.slice();var u=s.length,m=sg?sg(u):new s.constructor(u);return s.copy(m),m}function F0(s){var c=new s.constructor(s.byteLength);return new ll(c).set(new ll(s)),c}function RT(s,c){var u=c?F0(s.buffer):s.buffer;return new s.constructor(u,s.byteOffset,s.byteLength)}function NT(s){var c=new s.constructor(s.source,F.exec(s));return c.lastIndex=s.lastIndex,c}function DT(s){return ko?_t(ko.call(s)):{}}function Wg(s,c){var u=c?F0(s.buffer):s.buffer;return new s.constructor(u,s.byteOffset,s.length)}function Hg(s,c){if(s!==c){var u=s!==e,m=s===null,b=s===s,k=nn(s),P=c!==e,M=c===null,G=c===c,se=nn(c);if(!M&&!se&&!k&&s>c||k&&P&&G&&!M&&!se||m&&P&&G||!u&&G||!b)return 1;if(!m&&!k&&!se&&s<c||se&&u&&b&&!m&&!k||M&&u&&b||!P&&b||!G)return-1}return 0}function OT(s,c,u){for(var m=-1,b=s.criteria,k=c.criteria,P=b.length,M=u.length;++m<P;){var G=Hg(b[m],k[m]);if(G){if(m>=M)return G;var se=u[m];return G*(se=="desc"?-1:1)}}return s.index-c.index}function Vg(s,c,u,m){for(var b=-1,k=s.length,P=u.length,M=-1,G=c.length,se=jt(k-P,0),ce=ee(G+se),le=!m;++M<G;)ce[M]=c[M];for(;++b<P;)(le||b<k)&&(ce[u[b]]=s[b]);for(;se--;)ce[M++]=s[b++];return ce}function zg(s,c,u,m){for(var b=-1,k=s.length,P=-1,M=u.length,G=-1,se=c.length,ce=jt(k-M,0),le=ee(ce+se),ye=!m;++b<ce;)le[b]=s[b];for(var Ie=b;++G<se;)le[Ie+G]=c[G];for(;++P<M;)(ye||b<k)&&(le[Ie+u[P]]=s[b++]);return le}function $r(s,c){var u=-1,m=s.length;for(c||(c=ee(m));++u<m;)c[u]=s[u];return c}function qn(s,c,u,m){var b=!u;u||(u={});for(var k=-1,P=c.length;++k<P;){var M=c[k],G=m?m(u[M],s[M],M,u,s):e;G===e&&(G=s[M]),b?xi(u,M,G):So(u,M,G)}return u}function PT(s,c){return qn(s,L0(s),c)}function LT(s,c){return qn(s,r1(s),c)}function Tl(s,c){return function(u,m){var b=Ue(u)?Hy:iT,k=c?c():{};return b(u,s,Re(m,2),k)}}function gs(s){return je(function(c,u){var m=-1,b=u.length,k=b>1?u[b-1]:e,P=b>2?u[2]:e;for(k=s.length>3&&typeof k=="function"?(b--,k):e,P&&Dr(u[0],u[1],P)&&(k=b<3?e:k,b=1),c=_t(c);++m<b;){var M=u[m];M&&s(c,M,m,k)}return c})}function Gg(s,c){return function(u,m){if(u==null)return u;if(!jr(u))return s(u,m);for(var b=u.length,k=c?b:-1,P=_t(u);(c?k--:++k<b)&&m(P[k],k,P)!==!1;);return u}}function Xg(s){return function(c,u,m){for(var b=-1,k=_t(c),P=m(c),M=P.length;M--;){var G=P[s?M:++b];if(u(k[G],G,k)===!1)break}return c}}function MT(s,c,u){var m=c&v,b=Ro(s);function k(){var P=this&&this!==Zt&&this instanceof k?b:s;return P.apply(m?u:this,arguments)}return k}function $g(s){return function(c){c=ut(c);var u=fs(c)?Dn(c):e,m=u?u[0]:c.charAt(0),b=u?$i(u,1).join(""):c.slice(1);return m[s]()+b}}function _s(s){return function(c){return e0(G1(z1(c).replace(Ay,"")),s,"")}}function Ro(s){return function(){var c=arguments;switch(c.length){case 0:return new s;case 1:return new s(c[0]);case 2:return new s(c[0],c[1]);case 3:return new s(c[0],c[1],c[2]);case 4:return new s(c[0],c[1],c[2],c[3]);case 5:return new s(c[0],c[1],c[2],c[3],c[4]);case 6:return new s(c[0],c[1],c[2],c[3],c[4],c[5]);case 7:return new s(c[0],c[1],c[2],c[3],c[4],c[5],c[6])}var u=ps(s.prototype),m=s.apply(u,c);return It(m)?m:u}}function BT(s,c,u){var m=Ro(s);function b(){for(var k=arguments.length,P=ee(k),M=k,G=xs(b);M--;)P[M]=arguments[M];var se=k<3&&P[0]!==G&&P[k-1]!==G?[]:Wi(P,G);if(k-=se.length,k<u)return Qg(s,c,kl,b.placeholder,e,P,se,e,e,u-k);var ce=this&&this!==Zt&&this instanceof b?m:s;return en(ce,this,P)}return b}function jg(s){return function(c,u,m){var b=_t(c);if(!jr(c)){var k=Re(u,3);c=er(c),u=function(M){return k(b[M],M,b)}}var P=s(c,u,m);return P>-1?b[k?c[P]:P]:e}}function Kg(s){return bi(function(c){var u=c.length,m=u,b=xn.prototype.thru;for(s&&c.reverse();m--;){var k=c[m];if(typeof k!="function")throw new _n(i);if(b&&!P&&Fl(k)=="wrapper")var P=new xn([],!0)}for(m=P?m:u;++m<u;){k=c[m];var M=Fl(k),G=M=="wrapper"?O0(k):e;G&&B0(G[0])&&G[1]==(J|N|T|U)&&!G[4].length&&G[9]==1?P=P[Fl(G[0])].apply(P,G[3]):P=k.length==1&&B0(k)?P[M]():P.thru(k)}return function(){var se=arguments,ce=se[0];if(P&&se.length==1&&Ue(ce))return P.plant(ce).value();for(var le=0,ye=u?c[le].apply(this,se):ce;++le<u;)ye=c[le].call(this,ye);return ye}})}function kl(s,c,u,m,b,k,P,M,G,se){var ce=c&J,le=c&v,ye=c&_,Ie=c&(N|R),Ne=c&D,$e=ye?e:Ro(s);function De(){for(var et=arguments.length,nt=ee(et),an=et;an--;)nt[an]=arguments[an];if(Ie)var Or=xs(De),sn=qy(nt,Or);if(m&&(nt=Vg(nt,m,b,Ie)),k&&(nt=zg(nt,k,P,Ie)),et-=sn,Ie&&et<se){var Mt=Wi(nt,Or);return Qg(s,c,kl,De.placeholder,u,nt,Mt,M,G,se-et)}var Ln=le?u:this,Ti=ye?Ln[s]:s;return et=nt.length,M?nt=ik(nt,M):Ne&&et>1&&nt.reverse(),ce&&G<et&&(nt.length=G),this&&this!==Zt&&this instanceof De&&(Ti=$e||Ro(Ti)),Ti.apply(Ln,nt)}return De}function Yg(s,c){return function(u,m){return dT(u,s,c(m),{})}}function Sl(s,c){return function(u,m){var b;if(u===e&&m===e)return c;if(u!==e&&(b=u),m!==e){if(b===e)return m;typeof u=="string"||typeof m=="string"?(u=rn(u),m=rn(m)):(u=Og(u),m=Og(m)),b=s(u,m)}return b}}function I0(s){return bi(function(c){return c=kt(c,tn(Re())),je(function(u){var m=this;return s(c,function(b){return en(b,m,u)})})})}function Al(s,c){c=c===e?" ":rn(c);var u=c.length;if(u<2)return u?E0(c,s):c;var m=E0(c,hl(s/us(c)));return fs(c)?$i(Dn(m),0,s).join(""):m.slice(0,s)}function UT(s,c,u,m){var b=c&v,k=Ro(s);function P(){for(var M=-1,G=arguments.length,se=-1,ce=m.length,le=ee(ce+G),ye=this&&this!==Zt&&this instanceof P?k:s;++se<ce;)le[se]=m[se];for(;G--;)le[se++]=arguments[++M];return en(ye,b?u:this,le)}return P}function qg(s){return function(c,u,m){return m&&typeof m!="number"&&Dr(c,u,m)&&(u=m=e),c=Ei(c),u===e?(u=c,c=0):u=Ei(u),m=m===e?c<u?1:-1:Ei(m),TT(c,u,m,s)}}function Cl(s){return function(c,u){return typeof c=="string"&&typeof u=="string"||(c=yn(c),u=yn(u)),s(c,u)}}function Qg(s,c,u,m,b,k,P,M,G,se){var ce=c&N,le=ce?P:e,ye=ce?e:P,Ie=ce?k:e,Ne=ce?e:k;c|=ce?T:z,c&=~(ce?z:T),c&y||(c&=~(v|_));var $e=[s,c,b,Ie,le,Ne,ye,M,G,se],De=u.apply(e,$e);return B0(s)&&l1(De,$e),De.placeholder=m,f1(De,s,c)}function R0(s){var c=$t[s];return function(u,m){if(u=yn(u),m=m==null?0:gr(Ge(m),292),m&&fg(u)){var b=(ut(u)+"e").split("e"),k=c(b[0]+"e"+(+b[1]+m));return b=(ut(k)+"e").split("e"),+(b[0]+"e"+(+b[1]-m))}return c(u)}}var WT=hs&&1/nl(new hs([,-0]))[1]==he?function(s){return new hs(s)}:Z0;function Jg(s){return function(c){var u=_r(c);return u==O?o0(c):u==Tt?nE(c):Yy(c,s(c))}}function vi(s,c,u,m,b,k,P,M){var G=c&_;if(!G&&typeof s!="function")throw new _n(i);var se=m?m.length:0;if(se||(c&=~(T|z),m=b=e),P=P===e?P:jt(Ge(P),0),M=M===e?M:Ge(M),se-=b?b.length:0,c&z){var ce=m,le=b;m=b=e}var ye=G?e:O0(s),Ie=[s,c,u,m,b,ce,le,k,P,M];if(ye&&tk(Ie,ye),s=Ie[0],c=Ie[1],u=Ie[2],m=Ie[3],b=Ie[4],M=Ie[9]=Ie[9]===e?G?0:s.length:jt(Ie[9]-se,0),!M&&c&(N|R)&&(c&=~(N|R)),!c||c==v)var Ne=MT(s,c,u);else c==N||c==R?Ne=BT(s,c,M):(c==T||c==(v|T))&&!b.length?Ne=UT(s,c,u,m):Ne=kl.apply(e,Ie);var $e=ye?Ng:l1;return f1($e(Ne,Ie),s,c)}function Zg(s,c,u,m){return s===e||Pn(s,ds[u])&&!mt.call(m,u)?c:s}function e1(s,c,u,m,b,k){return It(s)&&It(c)&&(k.set(c,s),wl(s,c,e,e1,k),k.delete(c)),s}function HT(s){return Oo(s)?e:s}function t1(s,c,u,m,b,k){var P=u&g,M=s.length,G=c.length;if(M!=G&&!(P&&G>M))return!1;var se=k.get(s),ce=k.get(c);if(se&&ce)return se==c&&ce==s;var le=-1,ye=!0,Ie=u&x?new Sa:e;for(k.set(s,c),k.set(c,s);++le<M;){var Ne=s[le],$e=c[le];if(m)var De=P?m($e,Ne,le,c,s,k):m(Ne,$e,le,s,c,k);if(De!==e){if(De)continue;ye=!1;break}if(Ie){if(!t0(c,function(et,nt){if(!bo(Ie,nt)&&(Ne===et||b(Ne,et,u,m,k)))return Ie.push(nt)})){ye=!1;break}}else if(!(Ne===$e||b(Ne,$e,u,m,k))){ye=!1;break}}return k.delete(s),k.delete(c),ye}function VT(s,c,u,m,b,k,P){switch(u){case Ir:if(s.byteLength!=c.byteLength||s.byteOffset!=c.byteOffset)return!1;s=s.buffer,c=c.buffer;case Fr:return!(s.byteLength!=c.byteLength||!k(new ll(s),new ll(c)));case ae:case Ee:case ht:return Pn(+s,+c);case be:return s.name==c.name&&s.message==c.message;case gt:case mr:return s==c+"";case O:var M=o0;case Tt:var G=m&g;if(M||(M=nl),s.size!=c.size&&!G)return!1;var se=P.get(s);if(se)return se==c;m|=x,P.set(s,c);var ce=t1(M(s),M(c),m,b,k,P);return P.delete(s),ce;case zr:if(ko)return ko.call(s)==ko.call(c)}return!1}function zT(s,c,u,m,b,k){var P=u&g,M=N0(s),G=M.length,se=N0(c),ce=se.length;if(G!=ce&&!P)return!1;for(var le=G;le--;){var ye=M[le];if(!(P?ye in c:mt.call(c,ye)))return!1}var Ie=k.get(s),Ne=k.get(c);if(Ie&&Ne)return Ie==c&&Ne==s;var $e=!0;k.set(s,c),k.set(c,s);for(var De=P;++le<G;){ye=M[le];var et=s[ye],nt=c[ye];if(m)var an=P?m(nt,et,ye,c,s,k):m(et,nt,ye,s,c,k);if(!(an===e?et===nt||b(et,nt,u,m,k):an)){$e=!1;break}De||(De=ye=="constructor")}if($e&&!De){var Or=s.constructor,sn=c.constructor;Or!=sn&&"constructor"in s&&"constructor"in c&&!(typeof Or=="function"&&Or instanceof Or&&typeof sn=="function"&&sn instanceof sn)&&($e=!1)}return k.delete(s),k.delete(c),$e}function bi(s){return W0(o1(s,e,g1),s+"")}function N0(s){return wg(s,er,L0)}function D0(s){return wg(s,Kr,r1)}var O0=pl?function(s){return pl.get(s)}:Z0;function Fl(s){for(var c=s.name+"",u=ms[c],m=mt.call(ms,c)?u.length:0;m--;){var b=u[m],k=b.func;if(k==null||k==s)return b.name}return c}function xs(s){var c=mt.call(E,"placeholder")?E:s;return c.placeholder}function Re(){var s=E.iteratee||Q0;return s=s===Q0?Tg:s,arguments.length?s(arguments[0],arguments[1]):s}function Il(s,c){var u=s.__data__;return QT(c)?u[typeof c=="string"?"string":"hash"]:u.map}function P0(s){for(var c=er(s),u=c.length;u--;){var m=c[u],b=s[m];c[u]=[m,b,a1(b)]}return c}function Fa(s,c){var u=eE(s,c);return Eg(u)?u:e}function GT(s){var c=mt.call(s,Ta),u=s[Ta];try{s[Ta]=e;var m=!0}catch{}var b=ol.call(s);return m&&(c?s[Ta]=u:delete s[Ta]),b}var L0=l0?function(s){return s==null?[]:(s=_t(s),Bi(l0(s),function(c){return cg.call(s,c)}))}:ed,r1=l0?function(s){for(var c=[];s;)Ui(c,L0(s)),s=fl(s);return c}:ed,_r=Nr;(f0&&_r(new f0(new ArrayBuffer(1)))!=Ir||yo&&_r(new yo)!=O||u0&&_r(u0.resolve())!=Xe||hs&&_r(new hs)!=Tt||Eo&&_r(new Eo)!=Gr)&&(_r=function(s){var c=Nr(s),u=c==Ze?s.constructor:e,m=u?Ia(u):"";if(m)switch(m){case SE:return Ir;case AE:return O;case CE:return Xe;case FE:return Tt;case IE:return Gr}return c});function XT(s,c,u){for(var m=-1,b=u.length;++m<b;){var k=u[m],P=k.size;switch(k.type){case"drop":s+=P;break;case"dropRight":c-=P;break;case"take":c=gr(c,s+P);break;case"takeRight":s=jt(s,c-P);break}}return{start:s,end:c}}function $T(s){var c=s.match(Gu);return c?c[1].split(Xu):[]}function n1(s,c,u){c=Xi(c,s);for(var m=-1,b=c.length,k=!1;++m<b;){var P=Qn(c[m]);if(!(k=s!=null&&u(s,P)))break;s=s[P]}return k||++m!=b?k:(b=s==null?0:s.length,!!b&&Ml(b)&&wi(P,b)&&(Ue(s)||Ra(s)))}function jT(s){var c=s.length,u=new s.constructor(c);return c&&typeof s[0]=="string"&&mt.call(s,"index")&&(u.index=s.index,u.input=s.input),u}function i1(s){return typeof s.constructor=="function"&&!No(s)?ps(fl(s)):{}}function KT(s,c,u){var m=s.constructor;switch(c){case Fr:return F0(s);case ae:case Ee:return new m(+s);case Ir:return RT(s,u);case mi:case Xt:case Xr:case He:case yt:case pr:case Ct:case Nn:case as:return Wg(s,u);case O:return new m;case ht:case mr:return new m(s);case gt:return NT(s);case Tt:return new m;case zr:return DT(s)}}function YT(s,c){var u=c.length;if(!u)return s;var m=u-1;return c[m]=(u>1?"& ":"")+c[m],c=c.join(u>2?", ":" "),s.replace(zu,`{
/* [wrapped with `+c+`] */
`)}function qT(s){return Ue(s)||Ra(s)||!!(lg&&s&&s[lg])}function wi(s,c){var u=typeof s;return c=c??Ae,!!c&&(u=="number"||u!="symbol"&&q.test(s))&&s>-1&&s%1==0&&s<c}function Dr(s,c,u){if(!It(u))return!1;var m=typeof c;return(m=="number"?jr(u)&&wi(c,u.length):m=="string"&&c in u)?Pn(u[c],s):!1}function M0(s,c){if(Ue(s))return!1;var u=typeof s;return u=="number"||u=="symbol"||u=="boolean"||s==null||nn(s)?!0:Wu.test(s)||!Uu.test(s)||c!=null&&s in _t(c)}function QT(s){var c=typeof s;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?s!=="__proto__":s===null}function B0(s){var c=Fl(s),u=E[c];if(typeof u!="function"||!(c in tt.prototype))return!1;if(s===u)return!0;var m=O0(u);return!!m&&s===m[0]}function JT(s){return!!ag&&ag in s}var ZT=al?yi:td;function No(s){var c=s&&s.constructor,u=typeof c=="function"&&c.prototype||ds;return s===u}function a1(s){return s===s&&!It(s)}function s1(s,c){return function(u){return u==null?!1:u[s]===c&&(c!==e||s in _t(u))}}function ek(s){var c=Pl(s,function(m){return u.size===l&&u.clear(),m}),u=c.cache;return c}function tk(s,c){var u=s[1],m=c[1],b=u|m,k=b<(v|_|J),P=m==J&&u==N||m==J&&u==U&&s[7].length<=c[8]||m==(J|U)&&c[7].length<=c[8]&&u==N;if(!(k||P))return s;m&v&&(s[2]=c[2],b|=u&v?0:y);var M=c[3];if(M){var G=s[3];s[3]=G?Vg(G,M,c[4]):M,s[4]=G?Wi(s[3],f):c[4]}return M=c[5],M&&(G=s[5],s[5]=G?zg(G,M,c[6]):M,s[6]=G?Wi(s[5],f):c[6]),M=c[7],M&&(s[7]=M),m&J&&(s[8]=s[8]==null?c[8]:gr(s[8],c[8])),s[9]==null&&(s[9]=c[9]),s[0]=c[0],s[1]=b,s}function rk(s){var c=[];if(s!=null)for(var u in _t(s))c.push(u);return c}function nk(s){return ol.call(s)}function o1(s,c,u){return c=jt(c===e?s.length-1:c,0),function(){for(var m=arguments,b=-1,k=jt(m.length-c,0),P=ee(k);++b<k;)P[b]=m[c+b];b=-1;for(var M=ee(c+1);++b<c;)M[b]=m[b];return M[c]=u(P),en(s,this,M)}}function c1(s,c){return c.length<2?s:Ca(s,bn(c,0,-1))}function ik(s,c){for(var u=s.length,m=gr(c.length,u),b=$r(s);m--;){var k=c[m];s[m]=wi(k,u)?b[k]:e}return s}function U0(s,c){if(!(c==="constructor"&&typeof s[c]=="function")&&c!="__proto__")return s[c]}var l1=u1(Ng),Do=vE||function(s,c){return Zt.setTimeout(s,c)},W0=u1(AT);function f1(s,c,u){var m=c+"";return W0(s,YT(m,ak($T(m),u)))}function u1(s){var c=0,u=0;return function(){var m=EE(),b=te-(m-u);if(u=m,b>0){if(++c>=re)return arguments[0]}else c=0;return s.apply(e,arguments)}}function Rl(s,c){var u=-1,m=s.length,b=m-1;for(c=c===e?m:c;++u<c;){var k=y0(u,b),P=s[k];s[k]=s[u],s[u]=P}return s.length=c,s}var d1=ek(function(s){var c=[];return s.charCodeAt(0)===46&&c.push(""),s.replace(Hu,function(u,m,b,k){c.push(b?k.replace(S,"$1"):m||u)}),c});function Qn(s){if(typeof s=="string"||nn(s))return s;var c=s+"";return c=="0"&&1/s==-he?"-0":c}function Ia(s){if(s!=null){try{return sl.call(s)}catch{}try{return s+""}catch{}}return""}function ak(s,c){return gn(L,function(u){var m="_."+u[0];c&u[1]&&!tl(s,m)&&s.push(m)}),s.sort()}function h1(s){if(s instanceof tt)return s.clone();var c=new xn(s.__wrapped__,s.__chain__);return c.__actions__=$r(s.__actions__),c.__index__=s.__index__,c.__values__=s.__values__,c}function sk(s,c,u){(u?Dr(s,c,u):c===e)?c=1:c=jt(Ge(c),0);var m=s==null?0:s.length;if(!m||c<1)return[];for(var b=0,k=0,P=ee(hl(m/c));b<m;)P[k++]=bn(s,b,b+=c);return P}function ok(s){for(var c=-1,u=s==null?0:s.length,m=0,b=[];++c<u;){var k=s[c];k&&(b[m++]=k)}return b}function ck(){var s=arguments.length;if(!s)return[];for(var c=ee(s-1),u=arguments[0],m=s;m--;)c[m-1]=arguments[m];return Ui(Ue(u)?$r(u):[u],cr(c,1))}var lk=je(function(s,c){return Lt(s)?Ao(s,cr(c,1,Lt,!0)):[]}),fk=je(function(s,c){var u=wn(c);return Lt(u)&&(u=e),Lt(s)?Ao(s,cr(c,1,Lt,!0),Re(u,2)):[]}),uk=je(function(s,c){var u=wn(c);return Lt(u)&&(u=e),Lt(s)?Ao(s,cr(c,1,Lt,!0),e,u):[]});function dk(s,c,u){var m=s==null?0:s.length;return m?(c=u||c===e?1:Ge(c),bn(s,c<0?0:c,m)):[]}function hk(s,c,u){var m=s==null?0:s.length;return m?(c=u||c===e?1:Ge(c),c=m-c,bn(s,0,c<0?0:c)):[]}function mk(s,c){return s&&s.length?El(s,Re(c,3),!0,!0):[]}function pk(s,c){return s&&s.length?El(s,Re(c,3),!0):[]}function gk(s,c,u,m){var b=s==null?0:s.length;return b?(u&&typeof u!="number"&&Dr(s,c,u)&&(u=0,m=b),cT(s,c,u,m)):[]}function m1(s,c,u){var m=s==null?0:s.length;if(!m)return-1;var b=u==null?0:Ge(u);return b<0&&(b=jt(m+b,0)),rl(s,Re(c,3),b)}function p1(s,c,u){var m=s==null?0:s.length;if(!m)return-1;var b=m-1;return u!==e&&(b=Ge(u),b=u<0?jt(m+b,0):gr(b,m-1)),rl(s,Re(c,3),b,!0)}function g1(s){var c=s==null?0:s.length;return c?cr(s,1):[]}function _k(s){var c=s==null?0:s.length;return c?cr(s,he):[]}function xk(s,c){var u=s==null?0:s.length;return u?(c=c===e?1:Ge(c),cr(s,c)):[]}function vk(s){for(var c=-1,u=s==null?0:s.length,m={};++c<u;){var b=s[c];m[b[0]]=b[1]}return m}function _1(s){return s&&s.length?s[0]:e}function bk(s,c,u){var m=s==null?0:s.length;if(!m)return-1;var b=u==null?0:Ge(u);return b<0&&(b=jt(m+b,0)),ls(s,c,b)}function wk(s){var c=s==null?0:s.length;return c?bn(s,0,-1):[]}var yk=je(function(s){var c=kt(s,A0);return c.length&&c[0]===s[0]?_0(c):[]}),Ek=je(function(s){var c=wn(s),u=kt(s,A0);return c===wn(u)?c=e:u.pop(),u.length&&u[0]===s[0]?_0(u,Re(c,2)):[]}),Tk=je(function(s){var c=wn(s),u=kt(s,A0);return c=typeof c=="function"?c:e,c&&u.pop(),u.length&&u[0]===s[0]?_0(u,e,c):[]});function kk(s,c){return s==null?"":wE.call(s,c)}function wn(s){var c=s==null?0:s.length;return c?s[c-1]:e}function Sk(s,c,u){var m=s==null?0:s.length;if(!m)return-1;var b=m;return u!==e&&(b=Ge(u),b=b<0?jt(m+b,0):gr(b,m-1)),c===c?aE(s,c,b):rl(s,Qp,b,!0)}function Ak(s,c){return s&&s.length?Cg(s,Ge(c)):e}var Ck=je(x1);function x1(s,c){return s&&s.length&&c&&c.length?w0(s,c):s}function Fk(s,c,u){return s&&s.length&&c&&c.length?w0(s,c,Re(u,2)):s}function Ik(s,c,u){return s&&s.length&&c&&c.length?w0(s,c,e,u):s}var Rk=bi(function(s,c){var u=s==null?0:s.length,m=h0(s,c);return Rg(s,kt(c,function(b){return wi(b,u)?+b:b}).sort(Hg)),m});function Nk(s,c){var u=[];if(!(s&&s.length))return u;var m=-1,b=[],k=s.length;for(c=Re(c,3);++m<k;){var P=s[m];c(P,m,s)&&(u.push(P),b.push(m))}return Rg(s,b),u}function H0(s){return s==null?s:kE.call(s)}function Dk(s,c,u){var m=s==null?0:s.length;return m?(u&&typeof u!="number"&&Dr(s,c,u)?(c=0,u=m):(c=c==null?0:Ge(c),u=u===e?m:Ge(u)),bn(s,c,u)):[]}function Ok(s,c){return yl(s,c)}function Pk(s,c,u){return T0(s,c,Re(u,2))}function Lk(s,c){var u=s==null?0:s.length;if(u){var m=yl(s,c);if(m<u&&Pn(s[m],c))return m}return-1}function Mk(s,c){return yl(s,c,!0)}function Bk(s,c,u){return T0(s,c,Re(u,2),!0)}function Uk(s,c){var u=s==null?0:s.length;if(u){var m=yl(s,c,!0)-1;if(Pn(s[m],c))return m}return-1}function Wk(s){return s&&s.length?Dg(s):[]}function Hk(s,c){return s&&s.length?Dg(s,Re(c,2)):[]}function Vk(s){var c=s==null?0:s.length;return c?bn(s,1,c):[]}function zk(s,c,u){return s&&s.length?(c=u||c===e?1:Ge(c),bn(s,0,c<0?0:c)):[]}function Gk(s,c,u){var m=s==null?0:s.length;return m?(c=u||c===e?1:Ge(c),c=m-c,bn(s,c<0?0:c,m)):[]}function Xk(s,c){return s&&s.length?El(s,Re(c,3),!1,!0):[]}function $k(s,c){return s&&s.length?El(s,Re(c,3)):[]}var jk=je(function(s){return Gi(cr(s,1,Lt,!0))}),Kk=je(function(s){var c=wn(s);return Lt(c)&&(c=e),Gi(cr(s,1,Lt,!0),Re(c,2))}),Yk=je(function(s){var c=wn(s);return c=typeof c=="function"?c:e,Gi(cr(s,1,Lt,!0),e,c)});function qk(s){return s&&s.length?Gi(s):[]}function Qk(s,c){return s&&s.length?Gi(s,Re(c,2)):[]}function Jk(s,c){return c=typeof c=="function"?c:e,s&&s.length?Gi(s,e,c):[]}function V0(s){if(!(s&&s.length))return[];var c=0;return s=Bi(s,function(u){if(Lt(u))return c=jt(u.length,c),!0}),a0(c,function(u){return kt(s,r0(u))})}function v1(s,c){if(!(s&&s.length))return[];var u=V0(s);return c==null?u:kt(u,function(m){return en(c,e,m)})}var Zk=je(function(s,c){return Lt(s)?Ao(s,c):[]}),eS=je(function(s){return S0(Bi(s,Lt))}),tS=je(function(s){var c=wn(s);return Lt(c)&&(c=e),S0(Bi(s,Lt),Re(c,2))}),rS=je(function(s){var c=wn(s);return c=typeof c=="function"?c:e,S0(Bi(s,Lt),e,c)}),nS=je(V0);function iS(s,c){return Mg(s||[],c||[],So)}function aS(s,c){return Mg(s||[],c||[],Io)}var sS=je(function(s){var c=s.length,u=c>1?s[c-1]:e;return u=typeof u=="function"?(s.pop(),u):e,v1(s,u)});function b1(s){var c=E(s);return c.__chain__=!0,c}function oS(s,c){return c(s),s}function Nl(s,c){return c(s)}var cS=bi(function(s){var c=s.length,u=c?s[0]:0,m=this.__wrapped__,b=function(k){return h0(k,s)};return c>1||this.__actions__.length||!(m instanceof tt)||!wi(u)?this.thru(b):(m=m.slice(u,+u+(c?1:0)),m.__actions__.push({func:Nl,args:[b],thisArg:e}),new xn(m,this.__chain__).thru(function(k){return c&&!k.length&&k.push(e),k}))});function lS(){return b1(this)}function fS(){return new xn(this.value(),this.__chain__)}function uS(){this.__values__===e&&(this.__values__=O1(this.value()));var s=this.__index__>=this.__values__.length,c=s?e:this.__values__[this.__index__++];return{done:s,value:c}}function dS(){return this}function hS(s){for(var c,u=this;u instanceof _l;){var m=h1(u);m.__index__=0,m.__values__=e,c?b.__wrapped__=m:c=m;var b=m;u=u.__wrapped__}return b.__wrapped__=s,c}function mS(){var s=this.__wrapped__;if(s instanceof tt){var c=s;return this.__actions__.length&&(c=new tt(this)),c=c.reverse(),c.__actions__.push({func:Nl,args:[H0],thisArg:e}),new xn(c,this.__chain__)}return this.thru(H0)}function pS(){return Lg(this.__wrapped__,this.__actions__)}var gS=Tl(function(s,c,u){mt.call(s,u)?++s[u]:xi(s,u,1)});function _S(s,c,u){var m=Ue(s)?Yp:oT;return u&&Dr(s,c,u)&&(c=e),m(s,Re(c,3))}function xS(s,c){var u=Ue(s)?Bi:vg;return u(s,Re(c,3))}var vS=jg(m1),bS=jg(p1);function wS(s,c){return cr(Dl(s,c),1)}function yS(s,c){return cr(Dl(s,c),he)}function ES(s,c,u){return u=u===e?1:Ge(u),cr(Dl(s,c),u)}function w1(s,c){var u=Ue(s)?gn:zi;return u(s,Re(c,3))}function y1(s,c){var u=Ue(s)?Vy:xg;return u(s,Re(c,3))}var TS=Tl(function(s,c,u){mt.call(s,u)?s[u].push(c):xi(s,u,[c])});function kS(s,c,u,m){s=jr(s)?s:bs(s),u=u&&!m?Ge(u):0;var b=s.length;return u<0&&(u=jt(b+u,0)),Bl(s)?u<=b&&s.indexOf(c,u)>-1:!!b&&ls(s,c,u)>-1}var SS=je(function(s,c,u){var m=-1,b=typeof c=="function",k=jr(s)?ee(s.length):[];return zi(s,function(P){k[++m]=b?en(c,P,u):Co(P,c,u)}),k}),AS=Tl(function(s,c,u){xi(s,u,c)});function Dl(s,c){var u=Ue(s)?kt:kg;return u(s,Re(c,3))}function CS(s,c,u,m){return s==null?[]:(Ue(c)||(c=c==null?[]:[c]),u=m?e:u,Ue(u)||(u=u==null?[]:[u]),Fg(s,c,u))}var FS=Tl(function(s,c,u){s[u?0:1].push(c)},function(){return[[],[]]});function IS(s,c,u){var m=Ue(s)?e0:Zp,b=arguments.length<3;return m(s,Re(c,4),u,b,zi)}function RS(s,c,u){var m=Ue(s)?zy:Zp,b=arguments.length<3;return m(s,Re(c,4),u,b,xg)}function NS(s,c){var u=Ue(s)?Bi:vg;return u(s,Ll(Re(c,3)))}function DS(s){var c=Ue(s)?mg:kT;return c(s)}function OS(s,c,u){(u?Dr(s,c,u):c===e)?c=1:c=Ge(c);var m=Ue(s)?rT:ST;return m(s,c)}function PS(s){var c=Ue(s)?nT:CT;return c(s)}function LS(s){if(s==null)return 0;if(jr(s))return Bl(s)?us(s):s.length;var c=_r(s);return c==O||c==Tt?s.size:v0(s).length}function MS(s,c,u){var m=Ue(s)?t0:FT;return u&&Dr(s,c,u)&&(c=e),m(s,Re(c,3))}var BS=je(function(s,c){if(s==null)return[];var u=c.length;return u>1&&Dr(s,c[0],c[1])?c=[]:u>2&&Dr(c[0],c[1],c[2])&&(c=[c[0]]),Fg(s,cr(c,1),[])}),Ol=xE||function(){return Zt.Date.now()};function US(s,c){if(typeof c!="function")throw new _n(i);return s=Ge(s),function(){if(--s<1)return c.apply(this,arguments)}}function E1(s,c,u){return c=u?e:c,c=s&&c==null?s.length:c,vi(s,J,e,e,e,e,c)}function T1(s,c){var u;if(typeof c!="function")throw new _n(i);return s=Ge(s),function(){return--s>0&&(u=c.apply(this,arguments)),s<=1&&(c=e),u}}var z0=je(function(s,c,u){var m=v;if(u.length){var b=Wi(u,xs(z0));m|=T}return vi(s,m,c,u,b)}),k1=je(function(s,c,u){var m=v|_;if(u.length){var b=Wi(u,xs(k1));m|=T}return vi(c,m,s,u,b)});function S1(s,c,u){c=u?e:c;var m=vi(s,N,e,e,e,e,e,c);return m.placeholder=S1.placeholder,m}function A1(s,c,u){c=u?e:c;var m=vi(s,R,e,e,e,e,e,c);return m.placeholder=A1.placeholder,m}function C1(s,c,u){var m,b,k,P,M,G,se=0,ce=!1,le=!1,ye=!0;if(typeof s!="function")throw new _n(i);c=yn(c)||0,It(u)&&(ce=!!u.leading,le="maxWait"in u,k=le?jt(yn(u.maxWait)||0,c):k,ye="trailing"in u?!!u.trailing:ye);function Ie(Mt){var Ln=m,Ti=b;return m=b=e,se=Mt,P=s.apply(Ti,Ln),P}function Ne(Mt){return se=Mt,M=Do(et,c),ce?Ie(Mt):P}function $e(Mt){var Ln=Mt-G,Ti=Mt-se,j1=c-Ln;return le?gr(j1,k-Ti):j1}function De(Mt){var Ln=Mt-G,Ti=Mt-se;return G===e||Ln>=c||Ln<0||le&&Ti>=k}function et(){var Mt=Ol();if(De(Mt))return nt(Mt);M=Do(et,$e(Mt))}function nt(Mt){return M=e,ye&&m?Ie(Mt):(m=b=e,P)}function an(){M!==e&&Bg(M),se=0,m=G=b=M=e}function Or(){return M===e?P:nt(Ol())}function sn(){var Mt=Ol(),Ln=De(Mt);if(m=arguments,b=this,G=Mt,Ln){if(M===e)return Ne(G);if(le)return Bg(M),M=Do(et,c),Ie(G)}return M===e&&(M=Do(et,c)),P}return sn.cancel=an,sn.flush=Or,sn}var WS=je(function(s,c){return _g(s,1,c)}),HS=je(function(s,c,u){return _g(s,yn(c)||0,u)});function VS(s){return vi(s,D)}function Pl(s,c){if(typeof s!="function"||c!=null&&typeof c!="function")throw new _n(i);var u=function(){var m=arguments,b=c?c.apply(this,m):m[0],k=u.cache;if(k.has(b))return k.get(b);var P=s.apply(this,m);return u.cache=k.set(b,P)||k,P};return u.cache=new(Pl.Cache||_i),u}Pl.Cache=_i;function Ll(s){if(typeof s!="function")throw new _n(i);return function(){var c=arguments;switch(c.length){case 0:return!s.call(this);case 1:return!s.call(this,c[0]);case 2:return!s.call(this,c[0],c[1]);case 3:return!s.call(this,c[0],c[1],c[2])}return!s.apply(this,c)}}function zS(s){return T1(2,s)}var GS=IT(function(s,c){c=c.length==1&&Ue(c[0])?kt(c[0],tn(Re())):kt(cr(c,1),tn(Re()));var u=c.length;return je(function(m){for(var b=-1,k=gr(m.length,u);++b<k;)m[b]=c[b].call(this,m[b]);return en(s,this,m)})}),G0=je(function(s,c){var u=Wi(c,xs(G0));return vi(s,T,e,c,u)}),F1=je(function(s,c){var u=Wi(c,xs(F1));return vi(s,z,e,c,u)}),XS=bi(function(s,c){return vi(s,U,e,e,e,c)});function $S(s,c){if(typeof s!="function")throw new _n(i);return c=c===e?c:Ge(c),je(s,c)}function jS(s,c){if(typeof s!="function")throw new _n(i);return c=c==null?0:jt(Ge(c),0),je(function(u){var m=u[c],b=$i(u,0,c);return m&&Ui(b,m),en(s,this,b)})}function KS(s,c,u){var m=!0,b=!0;if(typeof s!="function")throw new _n(i);return It(u)&&(m="leading"in u?!!u.leading:m,b="trailing"in u?!!u.trailing:b),C1(s,c,{leading:m,maxWait:c,trailing:b})}function YS(s){return E1(s,1)}function qS(s,c){return G0(C0(c),s)}function QS(){if(!arguments.length)return[];var s=arguments[0];return Ue(s)?s:[s]}function JS(s){return vn(s,p)}function ZS(s,c){return c=typeof c=="function"?c:e,vn(s,p,c)}function eA(s){return vn(s,d|p)}function tA(s,c){return c=typeof c=="function"?c:e,vn(s,d|p,c)}function rA(s,c){return c==null||gg(s,c,er(c))}function Pn(s,c){return s===c||s!==s&&c!==c}var nA=Cl(g0),iA=Cl(function(s,c){return s>=c}),Ra=yg(function(){return arguments}())?yg:function(s){return Nt(s)&&mt.call(s,"callee")&&!cg.call(s,"callee")},Ue=ee.isArray,aA=zp?tn(zp):hT;function jr(s){return s!=null&&Ml(s.length)&&!yi(s)}function Lt(s){return Nt(s)&&jr(s)}function sA(s){return s===!0||s===!1||Nt(s)&&Nr(s)==ae}var ji=bE||td,oA=Gp?tn(Gp):mT;function cA(s){return Nt(s)&&s.nodeType===1&&!Oo(s)}function lA(s){if(s==null)return!0;if(jr(s)&&(Ue(s)||typeof s=="string"||typeof s.splice=="function"||ji(s)||vs(s)||Ra(s)))return!s.length;var c=_r(s);if(c==O||c==Tt)return!s.size;if(No(s))return!v0(s).length;for(var u in s)if(mt.call(s,u))return!1;return!0}function fA(s,c){return Fo(s,c)}function uA(s,c,u){u=typeof u=="function"?u:e;var m=u?u(s,c):e;return m===e?Fo(s,c,e,u):!!m}function X0(s){if(!Nt(s))return!1;var c=Nr(s);return c==be||c==ve||typeof s.message=="string"&&typeof s.name=="string"&&!Oo(s)}function dA(s){return typeof s=="number"&&fg(s)}function yi(s){if(!It(s))return!1;var c=Nr(s);return c==fe||c==Je||c==B||c==we}function I1(s){return typeof s=="number"&&s==Ge(s)}function Ml(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=Ae}function It(s){var c=typeof s;return s!=null&&(c=="object"||c=="function")}function Nt(s){return s!=null&&typeof s=="object"}var R1=Xp?tn(Xp):gT;function hA(s,c){return s===c||x0(s,c,P0(c))}function mA(s,c,u){return u=typeof u=="function"?u:e,x0(s,c,P0(c),u)}function pA(s){return N1(s)&&s!=+s}function gA(s){if(ZT(s))throw new Me(n);return Eg(s)}function _A(s){return s===null}function xA(s){return s==null}function N1(s){return typeof s=="number"||Nt(s)&&Nr(s)==ht}function Oo(s){if(!Nt(s)||Nr(s)!=Ze)return!1;var c=fl(s);if(c===null)return!0;var u=mt.call(c,"constructor")&&c.constructor;return typeof u=="function"&&u instanceof u&&sl.call(u)==mE}var $0=$p?tn($p):_T;function vA(s){return I1(s)&&s>=-Ae&&s<=Ae}var D1=jp?tn(jp):xT;function Bl(s){return typeof s=="string"||!Ue(s)&&Nt(s)&&Nr(s)==mr}function nn(s){return typeof s=="symbol"||Nt(s)&&Nr(s)==zr}var vs=Kp?tn(Kp):vT;function bA(s){return s===e}function wA(s){return Nt(s)&&_r(s)==Gr}function yA(s){return Nt(s)&&Nr(s)==Cr}var EA=Cl(b0),TA=Cl(function(s,c){return s<=c});function O1(s){if(!s)return[];if(jr(s))return Bl(s)?Dn(s):$r(s);if(wo&&s[wo])return rE(s[wo]());var c=_r(s),u=c==O?o0:c==Tt?nl:bs;return u(s)}function Ei(s){if(!s)return s===0?s:0;if(s=yn(s),s===he||s===-he){var c=s<0?-1:1;return c*Se}return s===s?s:0}function Ge(s){var c=Ei(s),u=c%1;return c===c?u?c-u:c:0}function P1(s){return s?Aa(Ge(s),0,pe):0}function yn(s){if(typeof s=="number")return s;if(nn(s))return qe;if(It(s)){var c=typeof s.valueOf=="function"?s.valueOf():s;s=It(c)?c+"":c}if(typeof s!="string")return s===0?s:+s;s=eg(s);var u=Y.test(s);return u||Q.test(s)?Uy(s.slice(2),u?2:8):I.test(s)?qe:+s}function L1(s){return qn(s,Kr(s))}function kA(s){return s?Aa(Ge(s),-Ae,Ae):s===0?s:0}function ut(s){return s==null?"":rn(s)}var SA=gs(function(s,c){if(No(c)||jr(c)){qn(c,er(c),s);return}for(var u in c)mt.call(c,u)&&So(s,u,c[u])}),M1=gs(function(s,c){qn(c,Kr(c),s)}),Ul=gs(function(s,c,u,m){qn(c,Kr(c),s,m)}),AA=gs(function(s,c,u,m){qn(c,er(c),s,m)}),CA=bi(h0);function FA(s,c){var u=ps(s);return c==null?u:pg(u,c)}var IA=je(function(s,c){s=_t(s);var u=-1,m=c.length,b=m>2?c[2]:e;for(b&&Dr(c[0],c[1],b)&&(m=1);++u<m;)for(var k=c[u],P=Kr(k),M=-1,G=P.length;++M<G;){var se=P[M],ce=s[se];(ce===e||Pn(ce,ds[se])&&!mt.call(s,se))&&(s[se]=k[se])}return s}),RA=je(function(s){return s.push(e,e1),en(B1,e,s)});function NA(s,c){return qp(s,Re(c,3),Yn)}function DA(s,c){return qp(s,Re(c,3),p0)}function OA(s,c){return s==null?s:m0(s,Re(c,3),Kr)}function PA(s,c){return s==null?s:bg(s,Re(c,3),Kr)}function LA(s,c){return s&&Yn(s,Re(c,3))}function MA(s,c){return s&&p0(s,Re(c,3))}function BA(s){return s==null?[]:bl(s,er(s))}function UA(s){return s==null?[]:bl(s,Kr(s))}function j0(s,c,u){var m=s==null?e:Ca(s,c);return m===e?u:m}function WA(s,c){return s!=null&&n1(s,c,lT)}function K0(s,c){return s!=null&&n1(s,c,fT)}var HA=Yg(function(s,c,u){c!=null&&typeof c.toString!="function"&&(c=ol.call(c)),s[c]=u},q0(Yr)),VA=Yg(function(s,c,u){c!=null&&typeof c.toString!="function"&&(c=ol.call(c)),mt.call(s,c)?s[c].push(u):s[c]=[u]},Re),zA=je(Co);function er(s){return jr(s)?hg(s):v0(s)}function Kr(s){return jr(s)?hg(s,!0):bT(s)}function GA(s,c){var u={};return c=Re(c,3),Yn(s,function(m,b,k){xi(u,c(m,b,k),m)}),u}function XA(s,c){var u={};return c=Re(c,3),Yn(s,function(m,b,k){xi(u,b,c(m,b,k))}),u}var $A=gs(function(s,c,u){wl(s,c,u)}),B1=gs(function(s,c,u,m){wl(s,c,u,m)}),jA=bi(function(s,c){var u={};if(s==null)return u;var m=!1;c=kt(c,function(k){return k=Xi(k,s),m||(m=k.length>1),k}),qn(s,D0(s),u),m&&(u=vn(u,d|h|p,HT));for(var b=c.length;b--;)k0(u,c[b]);return u});function KA(s,c){return U1(s,Ll(Re(c)))}var YA=bi(function(s,c){return s==null?{}:yT(s,c)});function U1(s,c){if(s==null)return{};var u=kt(D0(s),function(m){return[m]});return c=Re(c),Ig(s,u,function(m,b){return c(m,b[0])})}function qA(s,c,u){c=Xi(c,s);var m=-1,b=c.length;for(b||(b=1,s=e);++m<b;){var k=s==null?e:s[Qn(c[m])];k===e&&(m=b,k=u),s=yi(k)?k.call(s):k}return s}function QA(s,c,u){return s==null?s:Io(s,c,u)}function JA(s,c,u,m){return m=typeof m=="function"?m:e,s==null?s:Io(s,c,u,m)}var W1=Jg(er),H1=Jg(Kr);function ZA(s,c,u){var m=Ue(s),b=m||ji(s)||vs(s);if(c=Re(c,4),u==null){var k=s&&s.constructor;b?u=m?new k:[]:It(s)?u=yi(k)?ps(fl(s)):{}:u={}}return(b?gn:Yn)(s,function(P,M,G){return c(u,P,M,G)}),u}function eC(s,c){return s==null?!0:k0(s,c)}function tC(s,c,u){return s==null?s:Pg(s,c,C0(u))}function rC(s,c,u,m){return m=typeof m=="function"?m:e,s==null?s:Pg(s,c,C0(u),m)}function bs(s){return s==null?[]:s0(s,er(s))}function nC(s){return s==null?[]:s0(s,Kr(s))}function iC(s,c,u){return u===e&&(u=c,c=e),u!==e&&(u=yn(u),u=u===u?u:0),c!==e&&(c=yn(c),c=c===c?c:0),Aa(yn(s),c,u)}function aC(s,c,u){return c=Ei(c),u===e?(u=c,c=0):u=Ei(u),s=yn(s),uT(s,c,u)}function sC(s,c,u){if(u&&typeof u!="boolean"&&Dr(s,c,u)&&(c=u=e),u===e&&(typeof c=="boolean"?(u=c,c=e):typeof s=="boolean"&&(u=s,s=e)),s===e&&c===e?(s=0,c=1):(s=Ei(s),c===e?(c=s,s=0):c=Ei(c)),s>c){var m=s;s=c,c=m}if(u||s%1||c%1){var b=ug();return gr(s+b*(c-s+By("1e-"+((b+"").length-1))),c)}return y0(s,c)}var oC=_s(function(s,c,u){return c=c.toLowerCase(),s+(u?V1(c):c)});function V1(s){return Y0(ut(s).toLowerCase())}function z1(s){return s=ut(s),s&&s.replace(Z,Qy).replace(Cy,"")}function cC(s,c,u){s=ut(s),c=rn(c);var m=s.length;u=u===e?m:Aa(Ge(u),0,m);var b=u;return u-=c.length,u>=0&&s.slice(u,b)==c}function lC(s){return s=ut(s),s&&Mu.test(s)?s.replace(go,Jy):s}function fC(s){return s=ut(s),s&&Vu.test(s)?s.replace(_o,"\\$&"):s}var uC=_s(function(s,c,u){return s+(u?"-":"")+c.toLowerCase()}),dC=_s(function(s,c,u){return s+(u?" ":"")+c.toLowerCase()}),hC=$g("toLowerCase");function mC(s,c,u){s=ut(s),c=Ge(c);var m=c?us(s):0;if(!c||m>=c)return s;var b=(c-m)/2;return Al(ml(b),u)+s+Al(hl(b),u)}function pC(s,c,u){s=ut(s),c=Ge(c);var m=c?us(s):0;return c&&m<c?s+Al(c-m,u):s}function gC(s,c,u){s=ut(s),c=Ge(c);var m=c?us(s):0;return c&&m<c?Al(c-m,u)+s:s}function _C(s,c,u){return u||c==null?c=0:c&&(c=+c),TE(ut(s).replace(xo,""),c||0)}function xC(s,c,u){return(u?Dr(s,c,u):c===e)?c=1:c=Ge(c),E0(ut(s),c)}function vC(){var s=arguments,c=ut(s[0]);return s.length<3?c:c.replace(s[1],s[2])}var bC=_s(function(s,c,u){return s+(u?"_":"")+c.toLowerCase()});function wC(s,c,u){return u&&typeof u!="number"&&Dr(s,c,u)&&(c=u=e),u=u===e?pe:u>>>0,u?(s=ut(s),s&&(typeof c=="string"||c!=null&&!$0(c))&&(c=rn(c),!c&&fs(s))?$i(Dn(s),0,u):s.split(c,u)):[]}var yC=_s(function(s,c,u){return s+(u?" ":"")+Y0(c)});function EC(s,c,u){return s=ut(s),u=u==null?0:Aa(Ge(u),0,s.length),c=rn(c),s.slice(u,u+c.length)==c}function TC(s,c,u){var m=E.templateSettings;u&&Dr(s,c,u)&&(c=e),s=ut(s),c=Ul({},c,m,Zg);var b=Ul({},c.imports,m.imports,Zg),k=er(b),P=s0(b,k),M,G,se=0,ce=c.interpolate||ue,le="__p += '",ye=c0((c.escape||ue).source+"|"+ce.source+"|"+(ce===Zc?A:ue).source+"|"+(c.evaluate||ue).source+"|$","g"),Ie="//# sourceURL="+(mt.call(c,"sourceURL")?(c.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Dy+"]")+`
`;s.replace(ye,function(De,et,nt,an,Or,sn){return nt||(nt=an),le+=s.slice(se,sn).replace(ge,Zy),et&&(M=!0,le+=`' +
__e(`+et+`) +
'`),Or&&(G=!0,le+=`';
`+Or+`;
__p += '`),nt&&(le+=`' +
((__t = (`+nt+`)) == null ? '' : __t) +
'`),se=sn+De.length,De}),le+=`';
`;var Ne=mt.call(c,"variable")&&c.variable;if(!Ne)le=`with (obj) {
`+le+`
}
`;else if(C.test(Ne))throw new Me(a);le=(G?le.replace(Ou,""):le).replace(Pu,"$1").replace(Jc,"$1;"),le="function("+(Ne||"obj")+`) {
`+(Ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(M?", __e = _.escape":"")+(G?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+le+`return __p
}`;var $e=X1(function(){return ft(k,Ie+"return "+le).apply(e,P)});if($e.source=le,X0($e))throw $e;return $e}function kC(s){return ut(s).toLowerCase()}function SC(s){return ut(s).toUpperCase()}function AC(s,c,u){if(s=ut(s),s&&(u||c===e))return eg(s);if(!s||!(c=rn(c)))return s;var m=Dn(s),b=Dn(c),k=tg(m,b),P=rg(m,b)+1;return $i(m,k,P).join("")}function CC(s,c,u){if(s=ut(s),s&&(u||c===e))return s.slice(0,ig(s)+1);if(!s||!(c=rn(c)))return s;var m=Dn(s),b=rg(m,Dn(c))+1;return $i(m,0,b).join("")}function FC(s,c,u){if(s=ut(s),s&&(u||c===e))return s.replace(xo,"");if(!s||!(c=rn(c)))return s;var m=Dn(s),b=tg(m,Dn(c));return $i(m,b).join("")}function IC(s,c){var u=j,m=V;if(It(c)){var b="separator"in c?c.separator:b;u="length"in c?Ge(c.length):u,m="omission"in c?rn(c.omission):m}s=ut(s);var k=s.length;if(fs(s)){var P=Dn(s);k=P.length}if(u>=k)return s;var M=u-us(m);if(M<1)return m;var G=P?$i(P,0,M).join(""):s.slice(0,M);if(b===e)return G+m;if(P&&(M+=G.length-M),$0(b)){if(s.slice(M).search(b)){var se,ce=G;for(b.global||(b=c0(b.source,ut(F.exec(b))+"g")),b.lastIndex=0;se=b.exec(ce);)var le=se.index;G=G.slice(0,le===e?M:le)}}else if(s.indexOf(rn(b),M)!=M){var ye=G.lastIndexOf(b);ye>-1&&(G=G.slice(0,ye))}return G+m}function RC(s){return s=ut(s),s&&Lu.test(s)?s.replace(po,sE):s}var NC=_s(function(s,c,u){return s+(u?" ":"")+c.toUpperCase()}),Y0=$g("toUpperCase");function G1(s,c,u){return s=ut(s),c=u?e:c,c===e?tE(s)?lE(s):$y(s):s.match(c)||[]}var X1=je(function(s,c){try{return en(s,e,c)}catch(u){return X0(u)?u:new Me(u)}}),DC=bi(function(s,c){return gn(c,function(u){u=Qn(u),xi(s,u,z0(s[u],s))}),s});function OC(s){var c=s==null?0:s.length,u=Re();return s=c?kt(s,function(m){if(typeof m[1]!="function")throw new _n(i);return[u(m[0]),m[1]]}):[],je(function(m){for(var b=-1;++b<c;){var k=s[b];if(en(k[0],this,m))return en(k[1],this,m)}})}function PC(s){return sT(vn(s,d))}function q0(s){return function(){return s}}function LC(s,c){return s==null||s!==s?c:s}var MC=Kg(),BC=Kg(!0);function Yr(s){return s}function Q0(s){return Tg(typeof s=="function"?s:vn(s,d))}function UC(s){return Sg(vn(s,d))}function WC(s,c){return Ag(s,vn(c,d))}var HC=je(function(s,c){return function(u){return Co(u,s,c)}}),VC=je(function(s,c){return function(u){return Co(s,u,c)}});function J0(s,c,u){var m=er(c),b=bl(c,m);u==null&&!(It(c)&&(b.length||!m.length))&&(u=c,c=s,s=this,b=bl(c,er(c)));var k=!(It(u)&&"chain"in u)||!!u.chain,P=yi(s);return gn(b,function(M){var G=c[M];s[M]=G,P&&(s.prototype[M]=function(){var se=this.__chain__;if(k||se){var ce=s(this.__wrapped__),le=ce.__actions__=$r(this.__actions__);return le.push({func:G,args:arguments,thisArg:s}),ce.__chain__=se,ce}return G.apply(s,Ui([this.value()],arguments))})}),s}function zC(){return Zt._===this&&(Zt._=pE),this}function Z0(){}function GC(s){return s=Ge(s),je(function(c){return Cg(c,s)})}var XC=I0(kt),$C=I0(Yp),jC=I0(t0);function $1(s){return M0(s)?r0(Qn(s)):ET(s)}function KC(s){return function(c){return s==null?e:Ca(s,c)}}var YC=qg(),qC=qg(!0);function ed(){return[]}function td(){return!1}function QC(){return{}}function JC(){return""}function ZC(){return!0}function e4(s,c){if(s=Ge(s),s<1||s>Ae)return[];var u=pe,m=gr(s,pe);c=Re(c),s-=pe;for(var b=a0(m,c);++u<s;)c(u);return b}function t4(s){return Ue(s)?kt(s,Qn):nn(s)?[s]:$r(d1(ut(s)))}function r4(s){var c=++hE;return ut(s)+c}var n4=Sl(function(s,c){return s+c},0),i4=R0("ceil"),a4=Sl(function(s,c){return s/c},1),s4=R0("floor");function o4(s){return s&&s.length?vl(s,Yr,g0):e}function c4(s,c){return s&&s.length?vl(s,Re(c,2),g0):e}function l4(s){return Jp(s,Yr)}function f4(s,c){return Jp(s,Re(c,2))}function u4(s){return s&&s.length?vl(s,Yr,b0):e}function d4(s,c){return s&&s.length?vl(s,Re(c,2),b0):e}var h4=Sl(function(s,c){return s*c},1),m4=R0("round"),p4=Sl(function(s,c){return s-c},0);function g4(s){return s&&s.length?i0(s,Yr):0}function _4(s,c){return s&&s.length?i0(s,Re(c,2)):0}return E.after=US,E.ary=E1,E.assign=SA,E.assignIn=M1,E.assignInWith=Ul,E.assignWith=AA,E.at=CA,E.before=T1,E.bind=z0,E.bindAll=DC,E.bindKey=k1,E.castArray=QS,E.chain=b1,E.chunk=sk,E.compact=ok,E.concat=ck,E.cond=OC,E.conforms=PC,E.constant=q0,E.countBy=gS,E.create=FA,E.curry=S1,E.curryRight=A1,E.debounce=C1,E.defaults=IA,E.defaultsDeep=RA,E.defer=WS,E.delay=HS,E.difference=lk,E.differenceBy=fk,E.differenceWith=uk,E.drop=dk,E.dropRight=hk,E.dropRightWhile=mk,E.dropWhile=pk,E.fill=gk,E.filter=xS,E.flatMap=wS,E.flatMapDeep=yS,E.flatMapDepth=ES,E.flatten=g1,E.flattenDeep=_k,E.flattenDepth=xk,E.flip=VS,E.flow=MC,E.flowRight=BC,E.fromPairs=vk,E.functions=BA,E.functionsIn=UA,E.groupBy=TS,E.initial=wk,E.intersection=yk,E.intersectionBy=Ek,E.intersectionWith=Tk,E.invert=HA,E.invertBy=VA,E.invokeMap=SS,E.iteratee=Q0,E.keyBy=AS,E.keys=er,E.keysIn=Kr,E.map=Dl,E.mapKeys=GA,E.mapValues=XA,E.matches=UC,E.matchesProperty=WC,E.memoize=Pl,E.merge=$A,E.mergeWith=B1,E.method=HC,E.methodOf=VC,E.mixin=J0,E.negate=Ll,E.nthArg=GC,E.omit=jA,E.omitBy=KA,E.once=zS,E.orderBy=CS,E.over=XC,E.overArgs=GS,E.overEvery=$C,E.overSome=jC,E.partial=G0,E.partialRight=F1,E.partition=FS,E.pick=YA,E.pickBy=U1,E.property=$1,E.propertyOf=KC,E.pull=Ck,E.pullAll=x1,E.pullAllBy=Fk,E.pullAllWith=Ik,E.pullAt=Rk,E.range=YC,E.rangeRight=qC,E.rearg=XS,E.reject=NS,E.remove=Nk,E.rest=$S,E.reverse=H0,E.sampleSize=OS,E.set=QA,E.setWith=JA,E.shuffle=PS,E.slice=Dk,E.sortBy=BS,E.sortedUniq=Wk,E.sortedUniqBy=Hk,E.split=wC,E.spread=jS,E.tail=Vk,E.take=zk,E.takeRight=Gk,E.takeRightWhile=Xk,E.takeWhile=$k,E.tap=oS,E.throttle=KS,E.thru=Nl,E.toArray=O1,E.toPairs=W1,E.toPairsIn=H1,E.toPath=t4,E.toPlainObject=L1,E.transform=ZA,E.unary=YS,E.union=jk,E.unionBy=Kk,E.unionWith=Yk,E.uniq=qk,E.uniqBy=Qk,E.uniqWith=Jk,E.unset=eC,E.unzip=V0,E.unzipWith=v1,E.update=tC,E.updateWith=rC,E.values=bs,E.valuesIn=nC,E.without=Zk,E.words=G1,E.wrap=qS,E.xor=eS,E.xorBy=tS,E.xorWith=rS,E.zip=nS,E.zipObject=iS,E.zipObjectDeep=aS,E.zipWith=sS,E.entries=W1,E.entriesIn=H1,E.extend=M1,E.extendWith=Ul,J0(E,E),E.add=n4,E.attempt=X1,E.camelCase=oC,E.capitalize=V1,E.ceil=i4,E.clamp=iC,E.clone=JS,E.cloneDeep=eA,E.cloneDeepWith=tA,E.cloneWith=ZS,E.conformsTo=rA,E.deburr=z1,E.defaultTo=LC,E.divide=a4,E.endsWith=cC,E.eq=Pn,E.escape=lC,E.escapeRegExp=fC,E.every=_S,E.find=vS,E.findIndex=m1,E.findKey=NA,E.findLast=bS,E.findLastIndex=p1,E.findLastKey=DA,E.floor=s4,E.forEach=w1,E.forEachRight=y1,E.forIn=OA,E.forInRight=PA,E.forOwn=LA,E.forOwnRight=MA,E.get=j0,E.gt=nA,E.gte=iA,E.has=WA,E.hasIn=K0,E.head=_1,E.identity=Yr,E.includes=kS,E.indexOf=bk,E.inRange=aC,E.invoke=zA,E.isArguments=Ra,E.isArray=Ue,E.isArrayBuffer=aA,E.isArrayLike=jr,E.isArrayLikeObject=Lt,E.isBoolean=sA,E.isBuffer=ji,E.isDate=oA,E.isElement=cA,E.isEmpty=lA,E.isEqual=fA,E.isEqualWith=uA,E.isError=X0,E.isFinite=dA,E.isFunction=yi,E.isInteger=I1,E.isLength=Ml,E.isMap=R1,E.isMatch=hA,E.isMatchWith=mA,E.isNaN=pA,E.isNative=gA,E.isNil=xA,E.isNull=_A,E.isNumber=N1,E.isObject=It,E.isObjectLike=Nt,E.isPlainObject=Oo,E.isRegExp=$0,E.isSafeInteger=vA,E.isSet=D1,E.isString=Bl,E.isSymbol=nn,E.isTypedArray=vs,E.isUndefined=bA,E.isWeakMap=wA,E.isWeakSet=yA,E.join=kk,E.kebabCase=uC,E.last=wn,E.lastIndexOf=Sk,E.lowerCase=dC,E.lowerFirst=hC,E.lt=EA,E.lte=TA,E.max=o4,E.maxBy=c4,E.mean=l4,E.meanBy=f4,E.min=u4,E.minBy=d4,E.stubArray=ed,E.stubFalse=td,E.stubObject=QC,E.stubString=JC,E.stubTrue=ZC,E.multiply=h4,E.nth=Ak,E.noConflict=zC,E.noop=Z0,E.now=Ol,E.pad=mC,E.padEnd=pC,E.padStart=gC,E.parseInt=_C,E.random=sC,E.reduce=IS,E.reduceRight=RS,E.repeat=xC,E.replace=vC,E.result=qA,E.round=m4,E.runInContext=H,E.sample=DS,E.size=LS,E.snakeCase=bC,E.some=MS,E.sortedIndex=Ok,E.sortedIndexBy=Pk,E.sortedIndexOf=Lk,E.sortedLastIndex=Mk,E.sortedLastIndexBy=Bk,E.sortedLastIndexOf=Uk,E.startCase=yC,E.startsWith=EC,E.subtract=p4,E.sum=g4,E.sumBy=_4,E.template=TC,E.times=e4,E.toFinite=Ei,E.toInteger=Ge,E.toLength=P1,E.toLower=kC,E.toNumber=yn,E.toSafeInteger=kA,E.toString=ut,E.toUpper=SC,E.trim=AC,E.trimEnd=CC,E.trimStart=FC,E.truncate=IC,E.unescape=RC,E.uniqueId=r4,E.upperCase=NC,E.upperFirst=Y0,E.each=w1,E.eachRight=y1,E.first=_1,J0(E,function(){var s={};return Yn(E,function(c,u){mt.call(E.prototype,u)||(s[u]=c)}),s}(),{chain:!1}),E.VERSION=r,gn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){E[s].placeholder=E}),gn(["drop","take"],function(s,c){tt.prototype[s]=function(u){u=u===e?1:jt(Ge(u),0);var m=this.__filtered__&&!c?new tt(this):this.clone();return m.__filtered__?m.__takeCount__=gr(u,m.__takeCount__):m.__views__.push({size:gr(u,pe),type:s+(m.__dir__<0?"Right":"")}),m},tt.prototype[s+"Right"]=function(u){return this.reverse()[s](u).reverse()}}),gn(["filter","map","takeWhile"],function(s,c){var u=c+1,m=u==X||u==Ce;tt.prototype[s]=function(b){var k=this.clone();return k.__iteratees__.push({iteratee:Re(b,3),type:u}),k.__filtered__=k.__filtered__||m,k}}),gn(["head","last"],function(s,c){var u="take"+(c?"Right":"");tt.prototype[s]=function(){return this[u](1).value()[0]}}),gn(["initial","tail"],function(s,c){var u="drop"+(c?"":"Right");tt.prototype[s]=function(){return this.__filtered__?new tt(this):this[u](1)}}),tt.prototype.compact=function(){return this.filter(Yr)},tt.prototype.find=function(s){return this.filter(s).head()},tt.prototype.findLast=function(s){return this.reverse().find(s)},tt.prototype.invokeMap=je(function(s,c){return typeof s=="function"?new tt(this):this.map(function(u){return Co(u,s,c)})}),tt.prototype.reject=function(s){return this.filter(Ll(Re(s)))},tt.prototype.slice=function(s,c){s=Ge(s);var u=this;return u.__filtered__&&(s>0||c<0)?new tt(u):(s<0?u=u.takeRight(-s):s&&(u=u.drop(s)),c!==e&&(c=Ge(c),u=c<0?u.dropRight(-c):u.take(c-s)),u)},tt.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},tt.prototype.toArray=function(){return this.take(pe)},Yn(tt.prototype,function(s,c){var u=/^(?:filter|find|map|reject)|While$/.test(c),m=/^(?:head|last)$/.test(c),b=E[m?"take"+(c=="last"?"Right":""):c],k=m||/^find/.test(c);b&&(E.prototype[c]=function(){var P=this.__wrapped__,M=m?[1]:arguments,G=P instanceof tt,se=M[0],ce=G||Ue(P),le=function(et){var nt=b.apply(E,Ui([et],M));return m&&ye?nt[0]:nt};ce&&u&&typeof se=="function"&&se.length!=1&&(G=ce=!1);var ye=this.__chain__,Ie=!!this.__actions__.length,Ne=k&&!ye,$e=G&&!Ie;if(!k&&ce){P=$e?P:new tt(this);var De=s.apply(P,M);return De.__actions__.push({func:Nl,args:[le],thisArg:e}),new xn(De,ye)}return Ne&&$e?s.apply(this,M):(De=this.thru(le),Ne?m?De.value()[0]:De.value():De)})}),gn(["pop","push","shift","sort","splice","unshift"],function(s){var c=il[s],u=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",m=/^(?:pop|shift)$/.test(s);E.prototype[s]=function(){var b=arguments;if(m&&!this.__chain__){var k=this.value();return c.apply(Ue(k)?k:[],b)}return this[u](function(P){return c.apply(Ue(P)?P:[],b)})}}),Yn(tt.prototype,function(s,c){var u=E[c];if(u){var m=u.name+"";mt.call(ms,m)||(ms[m]=[]),ms[m].push({name:c,func:u})}}),ms[kl(e,_).name]=[{name:"wrapper",func:e}],tt.prototype.clone=RE,tt.prototype.reverse=NE,tt.prototype.value=DE,E.prototype.at=cS,E.prototype.chain=lS,E.prototype.commit=fS,E.prototype.next=uS,E.prototype.plant=hS,E.prototype.reverse=mS,E.prototype.toJSON=E.prototype.valueOf=E.prototype.value=pS,E.prototype.first=E.prototype.head,wo&&(E.prototype[wo]=dS),E},Hi=fE();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Zt._=Hi,define(function(){return Hi})):Ea?((Ea.exports=Hi)._=Hi,Qu._=Hi):Zt._=Hi}).call(to)});var b4=["mat-button",""],U_=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],W_=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var w4=".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}";var y4=["mat-mini-fab",""],E4='.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-fab{position:relative;display:inline-flex;position:relative;align-items:center;justify-content:center;box-sizing:border-box;width:56px;height:56px;padding:0;border:none;fill:currentColor;text-decoration:none;cursor:pointer;user-select:none;-moz-appearance:none;-webkit-appearance:none;overflow:visible;transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1),opacity 15ms linear 30ms,transform 270ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-fab .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-fab[hidden]{display:none}.mdc-fab::-moz-focus-inner{padding:0;border:0}.mdc-fab .mdc-fab__focus-ring{position:absolute}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{border-color:CanvasText}}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{border-color:CanvasText}}.mdc-fab:active,.mdc-fab:focus{outline:none}.mdc-fab:hover{cursor:pointer}.mdc-fab>svg{width:100%}.mdc-fab--mini{width:40px;height:40px}.mdc-fab--extended{border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;height:48px;line-height:normal}.mdc-fab--extended .mdc-fab__ripple{border-radius:24px}.mdc-fab--extended .mdc-fab__icon{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mdc-fab--extended .mdc-fab__icon,.mdc-fab--extended .mdc-fab__icon[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon,.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}.mdc-fab--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-fab--touch .mdc-fab__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-fab::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-fab::before{border-color:CanvasText}}.mdc-fab__label{justify-content:flex-start;text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden;overflow-y:visible}.mdc-fab__icon{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mdc-fab .mdc-fab__icon{display:inline-flex;align-items:center;justify-content:center}.mdc-fab--exited{transform:scale(0);opacity:0;transition:opacity 15ms linear 150ms,transform 180ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-fab--exited .mdc-fab__icon{transform:scale(0);transition:transform 135ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-fab{background-color:var(--mdc-fab-container-color)}.mat-mdc-fab .mdc-fab__icon{width:var(--mdc-fab-icon-size);height:var(--mdc-fab-icon-size);font-size:var(--mdc-fab-icon-size)}.mat-mdc-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-container-shape)}.mat-mdc-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-container-shape)}.mat-mdc-mini-fab{background-color:var(--mdc-fab-small-container-color)}.mat-mdc-mini-fab .mdc-fab__icon{width:var(--mdc-fab-small-icon-size);height:var(--mdc-fab-small-icon-size);font-size:var(--mdc-fab-small-icon-size)}.mat-mdc-mini-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-small-container-shape)}.mat-mdc-mini-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-small-container-shape)}.mat-mdc-extended-fab{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mdc-extended-fab-container-height);border-radius:var(--mdc-extended-fab-container-shape);font-family:var(--mdc-extended-fab-label-text-font);font-size:var(--mdc-extended-fab-label-text-size);font-weight:var(--mdc-extended-fab-label-text-weight);letter-spacing:var(--mdc-extended-fab-label-text-tracking)}.mat-mdc-extended-fab .mdc-fab__ripple{border-radius:var(--mdc-extended-fab-container-shape)}.mat-mdc-fab,.mat-mdc-mini-fab{-webkit-tap-highlight-color:rgba(0,0,0,0);flex-shrink:0}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-fab .mdc-button__label,.mat-mdc-mini-fab .mdc-button__label{z-index:1}.mat-mdc-fab .mat-mdc-focus-indicator,.mat-mdc-mini-fab .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-fab:focus .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-fab._mat-animation-noopable,.mat-mdc-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-fab:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-mini-fab:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}.mat-mdc-fab .mat-icon,.mat-mdc-fab .material-icons,.mat-mdc-mini-fab .mat-icon,.mat-mdc-mini-fab .material-icons{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mat-mdc-fab .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled,.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-fab[disabled],.mat-mdc-fab[disabled]:focus,.mat-mdc-fab.mat-mdc-button-disabled,.mat-mdc-fab.mat-mdc-button-disabled:focus,.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab[disabled]:focus,.mat-mdc-mini-fab.mat-mdc-button-disabled,.mat-mdc-mini-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-fab.mat-mdc-button-disabled-interactive,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-fab{color:var(--mat-fab-foreground-color, inherit);box-shadow:var(--mdc-fab-container-elevation-shadow)}.mat-mdc-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-touch-target-display)}.mat-mdc-fab .mat-ripple-element{background-color:var(--mat-fab-ripple-color)}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-state-layer-color)}.mat-mdc-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-disabled-state-layer-color)}.mat-mdc-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-hover-state-layer-opacity)}.mat-mdc-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-focus-state-layer-opacity)}.mat-mdc-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-pressed-state-layer-opacity)}.mat-mdc-fab:hover{box-shadow:var(--mdc-fab-hover-container-elevation-shadow)}.mat-mdc-fab:focus{box-shadow:var(--mdc-fab-focus-container-elevation-shadow)}.mat-mdc-fab:active,.mat-mdc-fab:focus:active{box-shadow:var(--mdc-fab-pressed-container-elevation-shadow)}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-disabled-state-foreground-color);background-color:var(--mat-fab-disabled-state-container-color)}.mat-mdc-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-mini-fab{color:var(--mat-fab-small-foreground-color, inherit);box-shadow:var(--mdc-fab-small-container-elevation-shadow)}.mat-mdc-mini-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-small-touch-target-display)}.mat-mdc-mini-fab .mat-ripple-element{background-color:var(--mat-fab-small-ripple-color)}.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-state-layer-color)}.mat-mdc-mini-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-disabled-state-layer-color)}.mat-mdc-mini-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-hover-state-layer-opacity)}.mat-mdc-mini-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-focus-state-layer-opacity)}.mat-mdc-mini-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-pressed-state-layer-opacity)}.mat-mdc-mini-fab:hover{box-shadow:var(--mdc-fab-small-hover-container-elevation-shadow)}.mat-mdc-mini-fab:focus{box-shadow:var(--mdc-fab-small-focus-container-elevation-shadow)}.mat-mdc-mini-fab:active,.mat-mdc-mini-fab:focus:active{box-shadow:var(--mdc-fab-small-pressed-container-elevation-shadow)}.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-small-disabled-state-foreground-color);background-color:var(--mat-fab-small-disabled-state-container-color)}.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-extended-fab{box-shadow:var(--mdc-extended-fab-container-elevation-shadow)}.mat-mdc-extended-fab:hover{box-shadow:var(--mdc-extended-fab-hover-container-elevation-shadow)}.mat-mdc-extended-fab:focus{box-shadow:var(--mdc-extended-fab-focus-container-elevation-shadow)}.mat-mdc-extended-fab:active,.mat-mdc-extended-fab:focus:active{box-shadow:var(--mdc-extended-fab-pressed-container-elevation-shadow)}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab[disabled]:focus,.mat-mdc-extended-fab.mat-mdc-button-disabled,.mat-mdc-extended-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-extended-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-extended-fab>.mat-icon,.mat-mdc-extended-fab>.material-icons{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mat-mdc-extended-fab>.mat-icon,[dir=rtl] .mat-mdc-extended-fab>.material-icons,.mat-mdc-extended-fab>.mat-icon[dir=rtl],.mat-mdc-extended-fab>.material-icons[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mat-mdc-extended-fab .mat-mdc-button-touch-target{width:100%}.mat-mdc-extended-fab .mdc-button__label+.mat-icon,.mat-mdc-extended-fab .mdc-button__label+.material-icons{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.material-icons,.mat-mdc-extended-fab .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-extended-fab .mdc-button__label+.material-icons[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}',T4=["mat-icon-button",""],k4=["*"];var S4=new Yt("MAT_BUTTON_CONFIG");var A4=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],_d=(()=>{let r=class r{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(n){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,n)}get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=n,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(n){this._disabled=n,this._updateRippleDisabled()}constructor(n,i,a,o){this._elementRef=n,this._platform=i,this._ngZone=a,this._animationMode=o,this._focusMonitor=Ts(__),this._rippleLoader=Ts(v_),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;let l=Ts(S4,{optional:!0}),f=n.nativeElement,d=f.classList;this.disabledInteractive=l?.disabledInteractive??!1,this._rippleLoader?.configureRipple(f,{className:"mat-mdc-button-ripple"});for(let{attribute:h,mdcClasses:p}of A4)f.hasAttribute(h)&&d.add(...p)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(n="program",i){n?this._focusMonitor.focusVia(this._elementRef.nativeElement,n,i):this._elementRef.nativeElement.focus(i)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}};r.\u0275fac=function(i){c_()},r.\u0275dir=s_({type:r,inputs:{color:"color",disableRipple:[Da.HasDecoratorInputTransform,"disableRipple","disableRipple",Pa],disabled:[Da.HasDecoratorInputTransform,"disabled","disabled",Pa],ariaDisabled:[Da.HasDecoratorInputTransform,"aria-disabled","ariaDisabled",Pa],disabledInteractive:[Da.HasDecoratorInputTransform,"disabledInteractive","disabledInteractive",Pa]},features:[Kl]});let e=r;return e})();var H_=(()=>{let r=class r extends _d{constructor(n,i,a,o){super(n,i,a,o)}};r.\u0275fac=function(i){return new(i||r)(Dt(ks),Dt(Jl),Dt(En),Dt($l,8))},r.\u0275cmp=qi({type:r,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(i,a){i&2&&(Cs("disabled",a._getDisabledAttribute())("aria-disabled",a._getAriaDisabled()),Fs(a.color?"mat-"+a.color:""),Ji("mat-mdc-button-disabled",a.disabled)("mat-mdc-button-disabled-interactive",a.disabledInteractive)("_mat-animation-noopable",a._animationMode==="NoopAnimations")("mat-unthemed",!a.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[jl,Rs],attrs:b4,ngContentSelectors:W_,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,a){i&1&&(Is(U_),Oa(0,"span",0),ei(1),Un(2,"span",1),ei(3,1),Jn(),ei(4,2),Oa(5,"span",2)(6,"span",3)),i&2&&Ji("mdc-button__ripple",!a._isFab)("mdc-fab__ripple",a._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px);display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);font-weight:var(--mdc-text-button-label-text-weight);text-transform:var(--mdc-text-button-label-text-transform);height:var(--mdc-text-button-container-height);border-radius:var(--mdc-text-button-container-shape);padding:0 var(--mat-text-button-horizontal-padding, 8px)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);font-weight:var(--mdc-filled-button-label-text-weight);text-transform:var(--mdc-filled-button-label-text-transform);height:var(--mdc-filled-button-container-height);border-radius:var(--mdc-filled-button-container-shape);padding:0 var(--mat-filled-button-horizontal-padding, 16px)}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color)}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);font-weight:var(--mdc-protected-button-label-text-weight);text-transform:var(--mdc-protected-button-label-text-transform);height:var(--mdc-protected-button-container-height);border-radius:var(--mdc-protected-button-container-shape);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow)}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color)}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);font-weight:var(--mdc-outlined-button-label-text-weight);text-transform:var(--mdc-outlined-button-label-text-transform);height:var(--mdc-outlined-button-container-height);border-radius:var(--mdc-outlined-button-container-shape);padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width);padding:0 var(--mat-outlined-button-horizontal-padding, 15px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color)}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape)}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width))}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button-base{text-decoration:none}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0});let e=r;return e})();var C4=new Yt("mat-mdc-fab-default-options",{providedIn:"root",factory:V_});function V_(){return{color:"accent"}}var B_=V_();var z_=(()=>{let r=class r extends _d{constructor(n,i,a,o,l){super(n,i,a,o),this._options=l,this._isFab=!0,this._options=this._options||B_,this.color=this._options.color||B_.color}};r.\u0275fac=function(i){return new(i||r)(Dt(ks),Dt(Jl),Dt(En),Dt($l,8),Dt(C4,8))},r.\u0275cmp=qi({type:r,selectors:[["button","mat-mini-fab",""]],hostVars:14,hostBindings:function(i,a){i&2&&(Cs("disabled",a._getDisabledAttribute())("aria-disabled",a._getAriaDisabled()),Fs(a.color?"mat-"+a.color:""),Ji("mat-mdc-button-disabled",a.disabled)("mat-mdc-button-disabled-interactive",a.disabledInteractive)("_mat-animation-noopable",a._animationMode==="NoopAnimations")("mat-unthemed",!a.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[jl,Rs],attrs:y4,ngContentSelectors:W_,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,a){i&1&&(Is(U_),Oa(0,"span",0),ei(1),Un(2,"span",1),ei(3,1),Jn(),ei(4,2),Oa(5,"span",2)(6,"span",3)),i&2&&Ji("mdc-button__ripple",!a._isFab)("mdc-fab__ripple",a._isFab)},styles:[E4],encapsulation:2,changeDetection:0});let e=r;return e})();var G_=(()=>{let r=class r extends _d{constructor(n,i,a,o){super(n,i,a,o),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}};r.\u0275fac=function(i){return new(i||r)(Dt(ks),Dt(Jl),Dt(En),Dt($l,8))},r.\u0275cmp=qi({type:r,selectors:[["button","mat-icon-button",""]],hostVars:14,hostBindings:function(i,a){i&2&&(Cs("disabled",a._getDisabledAttribute())("aria-disabled",a._getAriaDisabled()),Fs(a.color?"mat-"+a.color:""),Ji("mat-mdc-button-disabled",a.disabled)("mat-mdc-button-disabled-interactive",a.disabledInteractive)("_mat-animation-noopable",a._animationMode==="NoopAnimations")("mat-unthemed",!a.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[jl,Rs],attrs:T4,ngContentSelectors:k4,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,a){i&1&&(Is(),Oa(0,"span",0),ei(1),Oa(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{color:var(--mdc-icon-button-icon-color)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{border-radius:50%;flex-shrink:0;text-align:center;width:var(--mdc-icon-button-state-layer-size, 48px);height:var(--mdc-icon-button-state-layer-size, 48px);padding:calc(calc(var(--mdc-icon-button-state-layer-size, 48px) - var(--mdc-icon-button-icon-size, 24px)) / 2);font-size:var(--mdc-icon-button-icon-size);-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled],.mat-mdc-icon-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-icon-button-ripple-color)}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-state-layer-color)}.mat-mdc-icon-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-disabled-state-layer-color)}.mat-mdc-icon-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-hover-state-layer-opacity)}.mat-mdc-icon-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-focus-state-layer-opacity)}.mat-mdc-icon-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-pressed-state-layer-opacity)}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-icon-button-touch-target-display)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',w4],encapsulation:2,changeDetection:0});let e=r;return e})();var X_=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=Bn({type:r}),r.\u0275inj=Mn({imports:[Ns,x_,Ns]});let e=r;return e})();var I4=["*"],nf;function R4(){if(nf===void 0&&(nf=null,typeof window<"u")){let e=window;e.trustedTypes!==void 0&&(nf=e.trustedTypes.createPolicy("angular#components",{createHTML:r=>r}))}return nf}function Ho(e){return R4()?.createHTML(e)||e}function $_(e){return Error(`Unable to find icon with the name "${e}"`)}function N4(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}function j_(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function K_(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}var Ci=class{constructor(r,t,n){this.url=r,this.svgText=t,this.options=n}},D4=(()=>{let r=class r{constructor(n,i,a,o){this._httpClient=n,this._sanitizer=i,this._errorHandler=o,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=a}addSvgIcon(n,i,a){return this.addSvgIconInNamespace("",n,i,a)}addSvgIconLiteral(n,i,a){return this.addSvgIconLiteralInNamespace("",n,i,a)}addSvgIconInNamespace(n,i,a,o){return this._addSvgIconConfig(n,i,new Ci(a,null,o))}addSvgIconResolver(n){return this._resolvers.push(n),this}addSvgIconLiteralInNamespace(n,i,a,o){let l=this._sanitizer.sanitize(As.HTML,a);if(!l)throw K_(a);let f=Ho(l);return this._addSvgIconConfig(n,i,new Ci("",f,o))}addSvgIconSet(n,i){return this.addSvgIconSetInNamespace("",n,i)}addSvgIconSetLiteral(n,i){return this.addSvgIconSetLiteralInNamespace("",n,i)}addSvgIconSetInNamespace(n,i,a){return this._addSvgIconSetConfig(n,new Ci(i,null,a))}addSvgIconSetLiteralInNamespace(n,i,a){let o=this._sanitizer.sanitize(As.HTML,i);if(!o)throw K_(i);let l=Ho(o);return this._addSvgIconSetConfig(n,new Ci("",l,a))}registerFontClassAlias(n,i=n){return this._fontCssClassesByAlias.set(n,i),this}classNameForFontAlias(n){return this._fontCssClassesByAlias.get(n)||n}setDefaultFontSetClass(...n){return this._defaultFontSetClass=n,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(n){let i=this._sanitizer.sanitize(As.RESOURCE_URL,n);if(!i)throw j_(n);let a=this._cachedIconsByUrl.get(i);return a?on(af(a)):this._loadSvgIconFromConfig(new Ci(n,null)).pipe(Es(o=>this._cachedIconsByUrl.set(i,o)),Kt(o=>af(o)))}getNamedSvgIcon(n,i=""){let a=Y_(i,n),o=this._svgIconConfigs.get(a);if(o)return this._getSvgFromConfig(o);if(o=this._getIconConfigFromResolvers(i,n),o)return this._svgIconConfigs.set(a,o),this._getSvgFromConfig(o);let l=this._iconSetConfigs.get(i);return l?this._getSvgFromIconSetConfigs(n,l):Q1($_(a))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(n){return n.svgText?on(af(this._svgElementFromConfig(n))):this._loadSvgIconFromConfig(n).pipe(Kt(i=>af(i)))}_getSvgFromIconSetConfigs(n,i){let a=this._extractIconWithNameFromAnySet(n,i);if(a)return on(a);let o=i.filter(l=>!l.svgText).map(l=>this._loadSvgIconSetFromConfig(l).pipe(e_(f=>{let h=`Loading icon set URL: ${this._sanitizer.sanitize(As.RESOURCE_URL,l.url)} failed: ${f.message}`;return this._errorHandler.handleError(new Error(h)),on(null)})));return J1(o).pipe(Kt(()=>{let l=this._extractIconWithNameFromAnySet(n,i);if(!l)throw $_(n);return l}))}_extractIconWithNameFromAnySet(n,i){for(let a=i.length-1;a>=0;a--){let o=i[a];if(o.svgText&&o.svgText.toString().indexOf(n)>-1){let l=this._svgElementFromConfig(o),f=this._extractSvgIconFromSet(l,n,o.options);if(f)return f}}return null}_loadSvgIconFromConfig(n){return this._fetchIcon(n).pipe(Es(i=>n.svgText=i),Kt(()=>this._svgElementFromConfig(n)))}_loadSvgIconSetFromConfig(n){return n.svgText?on(null):this._fetchIcon(n).pipe(Es(i=>n.svgText=i))}_extractSvgIconFromSet(n,i,a){let o=n.querySelector(`[id="${i}"]`);if(!o)return null;let l=o.cloneNode(!0);if(l.removeAttribute("id"),l.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(l,a);if(l.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(l),a);let f=this._svgElementFromString(Ho("<svg></svg>"));return f.appendChild(l),this._setSvgAttributes(f,a)}_svgElementFromString(n){let i=this._document.createElement("DIV");i.innerHTML=n;let a=i.querySelector("svg");if(!a)throw Error("<svg> tag not found");return a}_toSvgElement(n){let i=this._svgElementFromString(Ho("<svg></svg>")),a=n.attributes;for(let o=0;o<a.length;o++){let{name:l,value:f}=a[o];l!=="id"&&i.setAttribute(l,f)}for(let o=0;o<n.childNodes.length;o++)n.childNodes[o].nodeType===this._document.ELEMENT_NODE&&i.appendChild(n.childNodes[o].cloneNode(!0));return i}_setSvgAttributes(n,i){return n.setAttribute("fit",""),n.setAttribute("height","100%"),n.setAttribute("width","100%"),n.setAttribute("preserveAspectRatio","xMidYMid meet"),n.setAttribute("focusable","false"),i&&i.viewBox&&n.setAttribute("viewBox",i.viewBox),n}_fetchIcon(n){let{url:i,options:a}=n,o=a?.withCredentials??!1;if(!this._httpClient)throw N4();if(i==null)throw Error(`Cannot fetch icon from URL "${i}".`);let l=this._sanitizer.sanitize(As.RESOURCE_URL,i);if(!l)throw j_(i);let f=this._inProgressUrlFetches.get(l);if(f)return f;let d=this._httpClient.get(l,{responseType:"text",withCredentials:o}).pipe(Kt(h=>Ho(h)),r_(()=>this._inProgressUrlFetches.delete(l)),Vl());return this._inProgressUrlFetches.set(l,d),d}_addSvgIconConfig(n,i,a){return this._svgIconConfigs.set(Y_(n,i),a),this}_addSvgIconSetConfig(n,i){let a=this._iconSetConfigs.get(n);return a?a.push(i):this._iconSetConfigs.set(n,[i]),this}_svgElementFromConfig(n){if(!n.svgElement){let i=this._svgElementFromString(n.svgText);this._setSvgAttributes(i,n.options),n.svgElement=i}return n.svgElement}_getIconConfigFromResolvers(n,i){for(let a=0;a<this._resolvers.length;a++){let o=this._resolvers[a](i,n);if(o)return O4(o)?new Ci(o.url,null,o.options):new Ci(o,null)}}};r.\u0275fac=function(i){return new(i||r)(Ve(p_,8),Ve(g_),Ve(ud,8),Ve(Xl))},r.\u0275prov=qr({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();function af(e){return e.cloneNode(!0)}function Y_(e,r){return e+":"+r}function O4(e){return!!(e.url&&e.options)}var P4=new Yt("MAT_ICON_DEFAULT_OPTIONS"),L4=new Yt("mat-icon-location",{providedIn:"root",factory:M4});function M4(){let e=Ts(ud),r=e?e.location:null;return{getPathname:()=>r?r.pathname+r.search:""}}var q_=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],B4=q_.map(e=>`[${e}]`).join(", "),U4=/^url\(['"]?#(.*?)['"]?\)$/,Q_=(()=>{let r=class r{get color(){return this._color||this._defaultColor}set color(n){this._color=n}get svgIcon(){return this._svgIcon}set svgIcon(n){n!==this._svgIcon&&(n?this._updateSvgIcon(n):this._svgIcon&&this._clearSvgElement(),this._svgIcon=n)}get fontSet(){return this._fontSet}set fontSet(n){let i=this._cleanupFontValue(n);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(n){let i=this._cleanupFontValue(n);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(n,i,a,o,l,f){this._elementRef=n,this._iconRegistry=i,this._location=o,this._errorHandler=l,this.inline=!1,this._previousFontSetClass=[],this._currentIconFetch=K1.EMPTY,f&&(f.color&&(this.color=this._defaultColor=f.color),f.fontSet&&(this.fontSet=f.fontSet)),a||n.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(n){if(!n)return["",""];let i=n.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${n}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let n=this._elementsWithExternalReferences;if(n&&n.size){let i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(n){this._clearSvgElement();let i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(n),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(n)}_clearSvgElement(){let n=this._elementRef.nativeElement,i=n.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){let a=n.childNodes[i];(a.nodeType!==1||a.nodeName.toLowerCase()==="svg")&&a.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let n=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(a=>a.length>0);this._previousFontSetClass.forEach(a=>n.classList.remove(a)),i.forEach(a=>n.classList.add(a)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&n.classList.remove(this._previousFontIconClass),this.fontIcon&&n.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(n){return typeof n=="string"?n.trim().split(" ")[0]:n}_prependPathToReferences(n){let i=this._elementsWithExternalReferences;i&&i.forEach((a,o)=>{a.forEach(l=>{o.setAttribute(l.name,`url('${n}#${l.value}')`)})})}_cacheChildrenWithExternalReferences(n){let i=n.querySelectorAll(B4),a=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let o=0;o<i.length;o++)q_.forEach(l=>{let f=i[o],d=f.getAttribute(l),h=d?d.match(U4):null;if(h){let p=a.get(f);p||(p=[],a.set(f,p)),p.push({name:l,value:h[1]})}})}_updateSvgIcon(n){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),n){let[i,a]=this._splitIconName(n);i&&(this._svgNamespace=i),a&&(this._svgName=a),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(a,i).pipe(Lo(1)).subscribe(o=>this._setSvgElement(o),o=>{let l=`Error retrieving icon ${i}:${a}! ${o.message}`;this._errorHandler.handleError(new Error(l))})}}};r.\u0275fac=function(i){return new(i||r)(Dt(ks),Dt(D4),o_("aria-hidden"),Dt(L4),Dt(Xl),Dt(P4,8))},r.\u0275cmp=qi({type:r,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(i,a){i&2&&(Cs("data-mat-icon-type",a._usingFontIcon()?"font":"svg")("data-mat-icon-name",a._svgName||a.fontIcon)("data-mat-icon-namespace",a._svgNamespace||a.fontSet)("fontIcon",a._usingFontIcon()?a.fontIcon:null),Fs(a.color?"mat-"+a.color:""),Ji("mat-icon-inline",a.inline)("mat-icon-no-color",a.color!=="primary"&&a.color!=="accent"&&a.color!=="warn"))},inputs:{color:"color",inline:[Da.HasDecoratorInputTransform,"inline","inline",Pa],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],standalone:!0,features:[Kl,Rs],ngContentSelectors:I4,decls:1,vars:0,template:function(i,a){i&1&&(Is(),ei(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0});let e=r;return e})(),J_=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=Bn({type:r}),r.\u0275inj=Mn({imports:[Ns,Ns]});let e=r;return e})();function H4(e,r){if(e&1){let t=ql();Un(0,"button",5),Ql("click",function(){zl(t);let i=Zn().$implicit,a=Zn();return Gl(a.onButtonClick(i))}),Mo(1),Jn()}if(e&2){let t=Zn().$implicit;Yl("background-color",t.buttonBackgroundColor)("color",t.buttonTextColor),Qi("matTooltip",t==null?null:t.buttonText),Si(),ld(" ",t.buttonText," ")}}function V4(e,r){if(e&1){let t=ql();Un(0,"button",5),Ql("click",function(){zl(t);let i=Zn().$implicit,a=Zn();return Gl(a.onButtonClick(i))}),Un(1,"mat-icon"),Mo(2),Jn(),Mo(3),Jn()}if(e&2){let t=Zn().$implicit;Yl("background-color",t.buttonBackgroundColor)("color",t.buttonTextColor),Qi("matTooltip",t==null?null:t.buttonText),Si(2),cd(t.buttonIcon),Si(),ld("",t.buttonText," ")}}function z4(e,r){if(e&1){let t=ql();Un(0,"button",6),Ql("click",function(){zl(t);let i=Zn().$implicit,a=Zn();return Gl(a.onButtonClick(i))}),Un(1,"mat-icon"),Mo(2),Jn()()}if(e&2){let t=Zn().$implicit;Yl("background-color",t.buttonBackgroundColor)("color",t.buttonIconColor),Qi("matTooltip",t==null?null:t.buttonText),Si(2),cd(t.buttonIcon)}}function G4(e,r){if(e&1&&(Un(0,"div",2),od(1,H4,2,6,"button",3)(2,V4,4,7,"button",3)(3,z4,3,6,"button",4),Jn()),e&2){let t=r.$implicit;Si(),Qi("ngIf",t.buttonType==="TEXT-ONLY"),Si(),Qi("ngIf",t.buttonType==="TEXT+ICON"),Si(),Qi("ngIf",t.buttonType==="ICON-ONLY")}}var _B=(()=>{let r=class r{constructor(n){this.appUtils=n}onButtonClick(n){n.buttonAction==="SAVE"?this.parentContext.save():n.buttonAction==="ADD"||n.buttonAction==="LIST"?this.appUtils.routerNavigation({},n.redirectTo):n.buttonAction==="VIEW"||n.buttonAction==="EDIT"&&this.dataContext?this.appUtils.routerNavigation({data:JSON.stringify({id:this.dataContext.id,redirectFrom:n.redirectFrom})},n.redirectTo):n.buttonAction==="EDIT"&&this.dataContext===void 0&&this.parentContext&&this.parentContext.recordId&&this.appUtils.routerNavigation({data:JSON.stringify({id:this.parentContext.recordId,redirectFrom:n.redirectFrom})},n.redirectTo)}};r.\u0275fac=function(i){return new(i||r)(Dt(b_))},r.\u0275cmp=qi({type:r,selectors:[["app-layout-action-buttons"]],inputs:{buttonData:"buttonData",parentContext:"parentContext",dataContext:"dataContext"},decls:2,vars:1,consts:[[1,"action-buttons"],["class","button",4,"ngFor","ngForOf"],[1,"button"],["mat-raised-button","","color","primary","matTooltipPosition","above",3,"background-color","color","matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary","matTooltipPosition","above",3,"background-color","color","matTooltip","click",4,"ngIf"],["mat-raised-button","","color","primary","matTooltipPosition","above",3,"click","matTooltip"],["mat-mini-fab","","color","primary","matTooltipPosition","above",3,"click","matTooltip"]],template:function(i,a){i&1&&(Un(0,"div",0),od(1,G4,4,3,"div",1),Jn()),i&2&&(Si(),Qi("ngForOf",a.buttonData))},dependencies:[u_,d_,H_,z_,Q_,w_],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;gap:5vh;align-items:center}"]});let e=r;return e})();var SB=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=Bn({type:r}),r.\u0275inj=Mn({imports:[h_,X_,J_,G_,y_]});let e=r;return e})();var X4="firebase",$4="10.14.1";ea(X4,$4,"app");var Ps=new l_("ANGULARFIRE2_VERSION");var j4=(e,r)=>{let t=r?[r]:M_(),n=[];return t.forEach(i=>{i.container.getProvider(e).instances.forEach(o=>{n.includes(o)||n.push(o)})}),n},La=class{constructor(){return j4(K4)}},K4="app-check";function xd(){}var sf=class{zone;delegate;constructor(r,t=q1){this.zone=r,this.delegate=t}now(){return this.delegate.now()}schedule(r,t,n){let i=this.zone,a=function(o){i.runGuarded(()=>{r.apply(this,[o])})};return this.delegate.schedule(a,t,n)}},vd=class{zone;task=null;constructor(r){this.zone=r}call(r,t){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",xd,{},xd,xd)),t.pipe(Es({next:n,complete:n,error:n})).subscribe(r).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},of=(()=>{class e{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new sf(Zone.current)),this.insideAngular=t.run(()=>new sf(Zone.current,Wl)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||e)(Ve(En))};static \u0275prov=qr({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Y4(){let e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return e}function Fi(e){return q4(Y4())(e)}function q4(e){return function(t){return t=t.lift(new vd(e.ngZone)),t.pipe(ys(e.outsideAngular),Na(e.insideAngular))}}var Q4="firebase",J4="10.14.1";xr.registerVersion(Q4,J4,"app-compat");var Z4=["ngOnDestroy"],tx=(e,r,t,n={})=>new Proxy(e,{get:(i,a)=>t.runOutsideAngular(()=>{if(e[a])return n?.spy?.get&&n.spy.get(a,e[a]),e[a];if(Z4.indexOf(a)>-1)return()=>{};let o=r.toPromise().then(l=>{let f=l?.[a];return typeof f=="function"?f.bind(l):f?.then?f.then(d=>t.run(()=>d)):t.run(()=>f)});return new Proxy(()=>{},{get:(l,f)=>o[f],apply:(l,f,d)=>o.then(h=>{let p=h?.(...d);return n?.spy?.apply&&n.spy.apply(a,d,p),p})})})});var cf=class{constructor(r){return r}},Ls=new Yt("angularfire2.app.options"),Ms=new Yt("angularfire2.app.name");function Vo(e,r,t){let n=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||n;let o=xr.apps.filter(l=>l&&l.name===i.name)[0]||r.runOutsideAngular(()=>xr.initializeApp(e,i));try{if(JSON.stringify(e)!==JSON.stringify(o.options)){let l=!!module.hot;eF("error",`${o.name} Firebase App already initialized with different options${l?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new cf(o)}var eF=(e,...r)=>{fd()&&typeof console<"u"&&console[e](...r)},tF={provide:cf,useFactory:Vo,deps:[Ls,En,[new sd,Ms]]},GB=(()=>{class e{static initializeApp(t,n){return{ngModule:e,providers:[{provide:Ls,useValue:t},{provide:Ms,useValue:n}]}}constructor(t){xr.registerVersion("angularfire",Ps.full,"core"),xr.registerVersion("angularfire",Ps.full,"app-compat"),xr.registerVersion("angular",f_.full,t.toString())}static \u0275fac=function(n){return new(n||e)(Ve(Ss))};static \u0275mod=Bn({type:e});static \u0275inj=Mn({providers:[tF]})}return e})();function lf(e,r,t,n,i){let[,a,o]=globalThis.\u0275AngularfireInstanceCache.find(l=>l[0]===e)||[];if(a)return rF(i,o)||(ex("error",`${r} was already initialized on the ${t} Firebase App with different settings.${nF?" You may need to reload as Firebase is not HMR aware.":""}`),ex("warn",{is:i,was:o})),a;{let l=n();return globalThis.\u0275AngularfireInstanceCache.push([e,l,i]),l}}function rF(e,r){try{return e.toString()===r.toString()}catch{return e===r}}var nF=typeof module<"u"&&!!module.hot,ex=(e,...r)=>{fd()&&typeof console<"u"&&console[e](...r)};globalThis.\u0275AngularfireInstanceCache||=[];var iF=new Map,aF={activated:!1,tokenObservers:[]},sF={initialized:!1,enabled:!1};function Wn(e){return iF.get(e)||Object.assign({},aF)}function sx(){return sF}var oF="https://content-firebaseappcheck.googleapis.com/v1";var cF="exchangeDebugToken",rx={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},e7=24*60*60*1e3;var wd=class{constructor(r,t,n,i,a){if(this.operation=r,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(r){return lr(this,null,function*(){this.stop();try{this.pending=new tr,this.pending.promise.catch(t=>{}),yield lF(this.getNextRun(r)),this.pending.resolve(),yield this.pending.promise,this.pending=new tr,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(r){if(r)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function lF(e){return new Promise(r=>{setTimeout(r,e)})}var fF={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},ta=new F_("appCheck","AppCheck",fF);function ox(e){if(!Wn(e).activated)throw ta.create("use-before-activation",{appName:e.name})}function cx(n,i){return lr(this,arguments,function*({url:e,body:r},t){let a={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let x=yield o.getHeartbeatsHeader();x&&(a["X-Firebase-Client"]=x)}let l={method:"POST",body:JSON.stringify(r),headers:a},f;try{f=yield fetch(e,l)}catch(x){throw ta.create("fetch-network-error",{originalErrorMessage:x?.message})}if(f.status!==200)throw ta.create("fetch-status-error",{httpStatus:f.status});let d;try{d=yield f.json()}catch(x){throw ta.create("fetch-parse-error",{originalErrorMessage:x?.message})}let h=d.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw ta.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let p=Number(h[1])*1e3,g=Date.now();return{token:d.token,expireTimeMillis:g+p,issuedAtTimeMillis:g}})}function lx(e,r){let{projectId:t,appId:n,apiKey:i}=e.options;return{url:`${oF}/projects/${t}/apps/${n}:${cF}?key=${i}`,body:{debug_token:r}}}var uF="firebase-app-check-database",dF=1,yd="firebase-app-check-store";var ff=null;function hF(){return ff||(ff=new Promise((e,r)=>{try{let t=indexedDB.open(uF,dF);t.onsuccess=n=>{e(n.target.result)},t.onerror=n=>{var i;r(ta.create("storage-open",{originalErrorMessage:(i=n.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=n=>{let i=n.target.result;switch(n.oldVersion){case 0:i.createObjectStore(yd,{keyPath:"compositeKey"})}}}catch(t){r(ta.create("storage-open",{originalErrorMessage:t?.message}))}}),ff)}function mF(e,r){return pF(gF(e),r)}function pF(e,r){return lr(this,null,function*(){let n=(yield hF()).transaction(yd,"readwrite"),a=n.objectStore(yd).put({compositeKey:e,value:r});return new Promise((o,l)=>{a.onsuccess=f=>{o()},n.onerror=f=>{var d;l(ta.create("storage-set",{originalErrorMessage:(d=f.target.error)===null||d===void 0?void 0:d.message}))}})})}function gF(e){return`${e.options.appId}-${e.name}`}var Ed=new Os("@firebase/app-check");function bd(e,r){return C_()?mF(e,r).catch(t=>{Ed.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function fx(){return sx().enabled}function ux(){return lr(this,null,function*(){let e=sx();if(e.enabled&&e.token)return e.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var _F={error:"UNKNOWN_ERROR"};function xF(e){return Zl.encodeString(JSON.stringify(e),!1)}function Td(e,r=!1){return lr(this,null,function*(){let t=e.app;ox(t);let n=Wn(t),i=n.token,a;if(i&&!zo(i)&&(n.token=void 0,i=void 0),!i){let f=yield n.cachedTokenPromise;f&&(zo(f)?i=f:yield bd(t,void 0))}if(!r&&i&&zo(i))return{token:i.token};let o=!1;if(fx()){n.exchangeTokenPromise||(n.exchangeTokenPromise=cx(lx(t,yield ux()),e.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),o=!0);let f=yield n.exchangeTokenPromise;return yield bd(t,f),n.token=f,{token:f.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),o=!0),i=yield Wn(t).exchangeTokenPromise}catch(f){f.code==="appCheck/throttled"?Ed.warn(f.message):Ed.error(f),a=f}let l;return i?a?zo(i)?l={token:i.token,internalError:a}:l=ix(a):(l={token:i.token},n.token=i,yield bd(t,i)):l=ix(a),o&&yF(t,l),l})}function vF(e){return lr(this,null,function*(){let r=e.app;ox(r);let{provider:t}=Wn(r);if(fx()){let n=yield ux(),{token:i}=yield cx(lx(r,n),e.heartbeatServiceProvider);return{token:i}}else{let{token:n}=yield t.getToken();return{token:n}}})}function bF(e,r,t,n){let{app:i}=e,a=Wn(i),o={next:t,error:n,type:r};if(a.tokenObservers=[...a.tokenObservers,o],a.token&&zo(a.token)){let l=a.token;Promise.resolve().then(()=>{t({token:l.token}),nx(e)}).catch(()=>{})}a.cachedTokenPromise.then(()=>nx(e))}function dx(e,r){let t=Wn(e),n=t.tokenObservers.filter(i=>i.next!==r);n.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function nx(e){let{app:r}=e,t=Wn(r),n=t.tokenRefresher;n||(n=wF(e),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function wF(e){let{app:r}=e;return new wd(()=>lr(this,null,function*(){let t=Wn(r),n;if(t.token?n=yield Td(e,!0):n=yield Td(e),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{let t=Wn(r);if(t.token){let n=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return n=Math.min(n,i),Math.max(0,n-Date.now())}else return 0},rx.RETRIAL_MIN_WAIT,rx.RETRIAL_MAX_WAIT)}function yF(e,r){let t=Wn(e).tokenObservers;for(let n of t)try{n.type==="EXTERNAL"&&r.error!=null?n.error(r.error):n.next(r)}catch{}}function zo(e){return e.expireTimeMillis-Date.now()>0}function ix(e){return{token:xF(_F),error:e}}var kd=class{constructor(r,t){this.app=r,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:r}=Wn(this.app);for(let t of r)dx(this.app,t.next);return Promise.resolve()}};function EF(e,r){return new kd(e,r)}function TF(e){return{getToken:r=>Td(e,r),getLimitedUseToken:()=>vF(e),addTokenListener:r=>bF(e,"INTERNAL",r),removeTokenListener:r=>dx(e.app,r)}}var kF="@firebase/app-check",SF="0.8.8";var AF="app-check",ax="app-check-internal";function CF(){Wo(new Ai(AF,e=>{let r=e.getProvider("app").getImmediate(),t=e.getProvider("heartbeat");return EF(r,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,t)=>{e.getProvider(ax).initialize()})),Wo(new Ai(ax,e=>{let r=e.getProvider("app-check").getImmediate();return TF(r)},"PUBLIC").setInstantiationMode("EXPLICIT")),ea(kF,SF)}CF();var FF=["localhost","0.0.0.0","127.0.0.1"],d7=typeof window<"u"&&FF.includes(window.location.hostname);var Sd=new Yt("angularfire2.auth.use-emulator"),Ad=new Yt("angularfire2.auth.settings"),Cd=new Yt("angularfire2.auth.tenant-id"),Fd=new Yt("angularfire2.auth.langugage-code"),Id=new Yt("angularfire2.auth.use-device-language"),Rd=new Yt("angularfire.auth.persistence"),Nd=(e,r,t,n,i,a,o,l)=>lf(`${e.name}.auth`,"AngularFireAuth",e.name,()=>{let f=r.runOutsideAngular(()=>e.auth());if(t&&f.useEmulator(...t),n&&(f.tenantId=n),f.languageCode=i,a&&f.useDeviceLanguage(),o)for(let[d,h]of Object.entries(o))f.settings[d]=h;return l&&f.setPersistence(l),f},[t,n,i,a,o,l]),mx=(()=>{class e{authState;idToken;user;idTokenResult;credential;constructor(t,n,i,a,o,l,f,d,h,p,g,x){let v=new Y1,_=on(void 0).pipe(Na(o.outsideAngular),ki(()=>a.runOutsideAngular(()=>import("./chunk-ANX7M3IB.js"))),Kt(()=>Vo(t,a,n)),Kt(y=>Nd(y,a,l,d,h,p,f,g)),id({bufferSize:1,refCount:!1}));if(m_(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=on(null);else{_.pipe(n_()).subscribe();let y=_.pipe(ki(T=>T.getRedirectResult().then(z=>z,()=>null)),Fi,id({bufferSize:1,refCount:!1})),N=_.pipe(ki(T=>new ws(z=>({unsubscribe:a.runOutsideAngular(()=>T.onAuthStateChanged(J=>z.next(J),J=>z.error(J),()=>z.complete()))})))),R=_.pipe(ki(T=>new ws(z=>({unsubscribe:a.runOutsideAngular(()=>T.onIdTokenChanged(J=>z.next(J),J=>z.error(J),()=>z.complete()))}))));this.authState=y.pipe(ad(N),ys(o.outsideAngular),Na(o.insideAngular)),this.user=y.pipe(ad(R),ys(o.outsideAngular),Na(o.insideAngular)),this.idToken=this.user.pipe(ki(T=>T?rd(T.getIdToken()):on(null))),this.idTokenResult=this.user.pipe(ki(T=>T?rd(T.getIdTokenResult()):on(null))),this.credential=Po(y,v,this.authState.pipe(Z1(T=>!T))).pipe(Kt(T=>T?.user?T:null),ys(o.outsideAngular),Na(o.insideAngular))}return tx(this,_,a,{spy:{apply:(y,N,R)=>{(y.startsWith("signIn")||y.startsWith("createUser"))&&R.then(T=>v.next(T))}}})}static \u0275fac=function(n){return new(n||e)(Ve(Ls),Ve(Ms,8),Ve(Ss),Ve(En),Ve(of),Ve(Sd,8),Ve(Ad,8),Ve(Cd,8),Ve(Fd,8),Ve(Id,8),Ve(Rd,8),Ve(La,8))};static \u0275prov=qr({token:e,factory:e.\u0275fac,providedIn:"any"})}return e})();var px="@firebase/database",gx="1.0.8";var Gh="";function Xh(e){Gh=e}var Wd=class{constructor(r){this.domStorage_=r,this.prefix_="firebase:"}set(r,t){t==null?this.domStorage_.removeItem(this.prefixedName_(r)):this.domStorage_.setItem(this.prefixedName_(r),Ut(t))}get(r){let t=this.domStorage_.getItem(this.prefixedName_(r));return t==null?null:ef(t)}remove(r){this.domStorage_.removeItem(this.prefixedName_(r))}prefixedName_(r){return this.prefix_+r}toString(){return this.domStorage_.toString()}};var Hd=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(r,t){t==null?delete this.cache_[r]:this.cache_[r]=t}get(r){return Tn(this.cache_,r)?this.cache_[r]:null}remove(r){delete this.cache_[r]}};var jx=function(e){try{if(typeof window<"u"&&typeof window[e]<"u"){let r=window[e];return r.setItem("firebase:sentinel","cache"),r.removeItem("firebase:sentinel"),new Wd(r)}}catch{}return new Hd},Ba=jx("localStorage"),Vd=jx("sessionStorage");var Hs=new Os("@firebase/database"),Kx=function(){let e=1;return function(){return e++}}(),Yx=function(e){let r=O_(e),t=new D_;t.update(r);let n=t.digest();return Zl.encodeByteArray(n)},hc=function(...e){let r="";for(let t=0;t<e.length;t++){let n=e[t];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?r+=hc.apply(null,n):typeof n=="object"?r+=Ut(n):r+=n,r+=" "}return r},Ua=null,_x=!0,qx=function(e,r){de(!r||e===!0||e===!1,"Can't turn on custom loggers persistently."),e===!0?(Hs.logLevel=P_.VERBOSE,Ua=Hs.log.bind(Hs),r&&Vd.set("logging_enabled",!0)):typeof e=="function"?Ua=e:(Ua=null,Vd.remove("logging_enabled"))},rr=function(...e){if(_x===!0&&(_x=!1,Ua===null&&Vd.get("logging_enabled")===!0&&qx(!0)),Ua){let r=hc.apply(null,e);Ua(r)}},mc=function(e){return function(...r){rr(e,...r)}},zd=function(...e){let r="FIREBASE INTERNAL ERROR: "+hc(...e);Hs.error(r)},ai=function(...e){let r=`FIREBASE FATAL ERROR: ${hc(...e)}`;throw Hs.error(r),new Error(r)},vr=function(...e){let r="FIREBASE WARNING: "+hc(...e);Hs.warn(r)},RF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&vr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Bf=function(e){return typeof e=="number"&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},NF=function(e){if(ti()||document.readyState==="complete")e();else{let r=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}r||(r=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},aa="[MIN_NAME]",Ii="[MAX_NAME]",Ha=function(e,r){if(e===r)return 0;if(e===aa||r===Ii)return-1;if(r===aa||e===Ii)return 1;{let t=xx(e),n=xx(r);return t!==null?n!==null?t-n===0?e.length-r.length:t-n:-1:n!==null?1:e<r?-1:1}},DF=function(e,r){return e===r?0:e<r?-1:1},Go=function(e,r){if(r&&e in r)return r[e];throw new Error("Missing required key ("+e+") in object: "+Ut(r))},$h=function(e){if(typeof e!="object"||e===null)return Ut(e);let r=[];for(let n in e)r.push(n);r.sort();let t="{";for(let n=0;n<r.length;n++)n!==0&&(t+=","),t+=Ut(r[n]),t+=":",t+=$h(e[r[n]]);return t+="}",t},Qx=function(e,r){let t=e.length;if(t<=r)return[e];let n=[];for(let i=0;i<t;i+=r)i+r>t?n.push(e.substring(i,t)):n.push(e.substring(i,i+r));return n};function nr(e,r){for(let t in e)e.hasOwnProperty(t)&&r(t,e[t])}var Jx=function(e){de(!Bf(e),"Invalid JSON number");let r=11,t=52,n=(1<<r-1)-1,i,a,o,l,f;e===0?(a=0,o=0,i=1/e===-1/0?1:0):(i=e<0,e=Math.abs(e),e>=Math.pow(2,1-n)?(l=Math.min(Math.floor(Math.log(e)/Math.LN2),n),a=l+n,o=Math.round(e*Math.pow(2,t-l)-Math.pow(2,t))):(a=0,o=Math.round(e/Math.pow(2,1-n-t))));let d=[];for(f=t;f;f-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(f=r;f;f-=1)d.push(a%2?1:0),a=Math.floor(a/2);d.push(i?1:0),d.reverse();let h=d.join(""),p="";for(f=0;f<64;f+=8){let g=parseInt(h.substr(f,8),2).toString(16);g.length===1&&(g="0"+g),p=p+g}return p.toLowerCase()},OF=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},PF=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function LF(e,r){let t="Unknown Error";e==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":e==="permission_denied"?t="Client doesn't have permission to access the desired data.":e==="unavailable"&&(t="The service is unavailable");let n=new Error(e+" at "+r._path.toString()+": "+t);return n.code=e.toUpperCase(),n}var MF=new RegExp("^-?(0*)\\d{1,10}$"),BF=-2147483648,UF=2147483647,xx=function(e){if(MF.test(e)){let r=Number(e);if(r>=BF&&r<=UF)return r}return null},qs=function(e){try{e()}catch(r){setTimeout(()=>{let t=r.stack||"";throw vr("Exception was thrown by user callback.",t),r},Math.floor(0))}},WF=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ko=function(e,r){let t=setTimeout(e,r);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var Gd=class{constructor(r,t){this.appName_=r,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(n=>this.appCheck=n)}getToken(r){return this.appCheck?this.appCheck.getToken(r):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(r).then(t,n):t(null)},0)})}addTokenChangeListener(r){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(n=>n.addTokenListener(r))}notifyForInvalidToken(){vr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Xd=class{constructor(r,t,n){this.appName_=r,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(i=>this.auth_=i)}getToken(r){return this.auth_?this.auth_.getToken(r).catch(t=>t&&t.code==="auth/token-not-initialized"?(rr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(r).then(t,n):t(null)},0)})}addTokenChangeListener(r){this.auth_?this.auth_.addAuthTokenListener(r):this.authProvider_.get().then(t=>t.addAuthTokenListener(r))}removeTokenChangeListener(r){this.authProvider_.get().then(t=>t.removeAuthTokenListener(r))}notifyForInvalidToken(){let r='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?r+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?r+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':r+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',vr(r)}},Yo=(()=>{class e{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}e.OWNER="owner";return e})(),df="5",Zx="v",ev="s",tv="r",rv="f",nv=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,iv="ls",av="p",$d="ac",sv="websocket",ov="long_polling";var hf=class{constructor(r,t,n,i,a=!1,o="",l=!1,f=!1){this.secure=t,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=f,this._host=r.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ba.get("host:"+r)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(r){r!==this.internalHost&&(this.internalHost=r,this.isCacheableHost()&&Ba.set("host:"+this._host,this.internalHost))}toString(){let r=this.toURLString();return this.persistenceKey&&(r+="<"+this.persistenceKey+">"),r}toURLString(){let r=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${r}${this.host}/${t}`}};function HF(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function cv(e,r,t){de(typeof r=="string","typeof type must == string"),de(typeof t=="object","typeof params must == object");let n;if(r===sv)n=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(r===ov)n=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+r);HF(e)&&(t.ns=e.namespace);let i=[];return nr(t,(a,o)=>{i.push(a+"="+o)}),n+i.join("&")}var jd=class{constructor(){this.counters_={}}incrementCounter(r,t=1){Tn(this.counters_,r)||(this.counters_[r]=0),this.counters_[r]+=t}get(){return T_(this.counters_)}};var Dd={},Od={};function jh(e){let r=e.toString();return Dd[r]||(Dd[r]=new jd),Dd[r]}function VF(e,r){let t=e.toString();return Od[t]||(Od[t]=r()),Od[t]}var Kd=class{constructor(r){this.onMessage_=r,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(r,t){this.closeAfterResponse=r,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(r,t){for(this.pendingResponses[r]=t;this.pendingResponses[this.currentResponseNum];){let n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<n.length;++i)n[i]&&qs(()=>{this.onMessage_(n[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var vx="start",zF="close",GF="pLPCommand",XF="pRTLPCB",lv="id",fv="pw",uv="ser",$F="cb",jF="seg",KF="ts",YF="d",qF="dframe",dv=1870,hv=30,QF=dv-hv,JF=25e3,ZF=3e4,Zo=class e{constructor(r,t,n,i,a,o,l){this.connId=r,this.repoInfo=t,this.applicationId=n,this.appCheckToken=i,this.authToken=a,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=mc(r),this.stats_=jh(t),this.urlFn=f=>(this.appCheckToken&&(f[$d]=this.appCheckToken),cv(t,ov,f))}open(r,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Kd(r),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(ZF)),NF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Yd((...a)=>{let[o,l,f,d,h]=a;if(this.incrementIncomingBytes_(a),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===vx)this.id=l,this.password=f;else if(o===zF)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...a)=>{let[o,l]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);let n={};n[vx]="t",n[uv]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[$F]=this.scriptTagHolder.uniqueCallbackIdentifier),n[Zx]=df,this.transportSessionId&&(n[ev]=this.transportSessionId),this.lastSessionId&&(n[iv]=this.lastSessionId),this.applicationId&&(n[av]=this.applicationId),this.appCheckToken&&(n[$d]=this.appCheckToken),typeof location<"u"&&location.hostname&&nv.test(location.hostname)&&(n[tv]=rv);let i=this.urlFn(n);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){e.forceAllow_=!0}static forceDisallow(){e.forceDisallow_=!0}static isAvailable(){return ti()?!1:e.forceAllow_?!0:!e.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!OF()&&!PF()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(r){let t=Ut(r);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let n=E_(t),i=Qx(n,QF);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(r,t){if(ti())return;this.myDisconnFrame=document.createElement("iframe");let n={};n[qF]="t",n[lv]=r,n[fv]=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(r){let t=Ut(r).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},Yd=class e{constructor(r,t,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ti())this.commandCB=r,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Kx(),window[GF+this.uniqueCallbackIdentifier]=r,window[XF+this.uniqueCallbackIdentifier]=t,this.myIFrame=e.createIFrame_();let a="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(a='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){rr("frame writing exception"),l.stack&&rr(l.stack),rr(l)}}}static createIFrame_(){let r=document.createElement("iframe");if(r.style.display="none",document.body){document.body.appendChild(r);try{r.contentWindow.document||rr("No IE domain setting required")}catch{let n=document.domain;r.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return r.contentDocument?r.doc=r.contentDocument:r.contentWindow?r.doc=r.contentWindow.document:r.document&&(r.doc=r.document),r}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let r=this.onDisconnect;r&&(this.onDisconnect=null,r())}startLongPoll(r,t){for(this.myID=r,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let r={};r[lv]=this.myID,r[fv]=this.myPW,r[uv]=this.currentSerial;let t=this.urlFn(r),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+hv+n.length<=dv;){let o=this.pendingSegs.shift();n=n+"&"+jF+i+"="+o.seg+"&"+KF+i+"="+o.ts+"&"+YF+i+"="+o.d,i++}return t=t+n,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(r,t,n){this.pendingSegs.push({seg:r,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(r,t){this.outstandingRequests.add(t);let n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(n,Math.floor(JF)),a=()=>{clearTimeout(i),n()};this.addTag(r,a)}addTag(r,t){ti()?this.doNodeLongPoll(r,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=r,n.onload=n.onreadystatechange=function(){let i=n.readyState;(!i||i==="loaded"||i==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{rr("Long-poll script failed to load: "+r),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}};var eI=16384,tI=45e3,mf=null;typeof MozWebSocket<"u"?mf=MozWebSocket:typeof WebSocket<"u"&&(mf=WebSocket);var Us=(()=>{class e{constructor(t,n,i,a,o,l,f){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=mc(this.connId),this.stats_=jh(n),this.connURL=e.connectionURL_(n,l,f,a,i),this.nodeAdmin=n.nodeAdmin}static connectionURL_(t,n,i,a,o){let l={};return l[Zx]=df,!ti()&&typeof location<"u"&&location.hostname&&nv.test(location.hostname)&&(l[tv]=rv),n&&(l[ev]=n),i&&(l[iv]=i),a&&(l[$d]=a),o&&(l[av]=o),cv(t,sv,l)}open(t,n){this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ba.set("previous_websocket_failure",!0);try{let i;if(ti()){let a=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${df}/${Gh}/${process.platform}/${a}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,l=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;l&&(i.proxy={origin:l})}this.mySock=new mf(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let a=i.message||i.data;a&&this.log_(a),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){e.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let n=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(n);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&mf!==null&&!e.forceDisallow_}static previouslyFailed(){return Ba.isInMemoryStorage||Ba.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ba.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let n=this.frames.join("");this.frames=null;let i=ef(n);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(de(this.frames===null,"We already have a frame buffer"),t.length<=6){let n=Number(t);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let n=t.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{let i=this.extractFrameCount_(n);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let n=Ut(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=Qx(n,eI);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(tI))}sendString_(t){try{this.mySock.send(t)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4;return e})(),mv=(()=>{class e{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Zo,Us]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let n=Us&&Us.isAvailable(),i=n&&!Us.previouslyFailed();if(t.webSocketOnly&&(n||vr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Us];else{let a=this.transports_=[];for(let o of e.ALL_TRANSPORTS)o&&o.isAvailable()&&a.push(o);e.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}e.globalTransportInitialized_=!1;return e})(),rI=6e4,nI=5e3,iI=10*1024,aI=100*1024,Pd="t",bx="d",sI="s",wx="r",oI="e",yx="o",Ex="a",Tx="n",kx="p",cI="h",qd=class{constructor(r,t,n,i,a,o,l,f,d,h){this.id=r,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=f,this.onKill_=d,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=mc("c:"+this.id+":"),this.transportManager_=new mv(t),this.log_("Connection created"),this.start_()}start_(){let r=this.transportManager_.initialTransport();this.conn_=new r(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=r.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));let i=r.healthyTimeout||0;i>0&&(this.healthyTimeout_=Ko(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>aI?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>iI?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(r){return t=>{r===this.conn_?this.onConnectionLost_(t):r===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(r){return t=>{this.state_!==2&&(r===this.rx_?this.onPrimaryMessageReceived_(t):r===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(r){let t={t:"d",d:r};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(r){if(Pd in r){let t=r[Pd];t===Ex?this.upgradeIfSecondaryHealthy_():t===wx?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===yx&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(r){let t=Go("t",r),n=Go("d",r);if(t==="c")this.onSecondaryControl_(n);else if(t==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:kx,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Ex,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Tx,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(r){let t=Go("t",r),n=Go("d",r);t==="c"?this.onControl_(n):t==="d"&&this.onDataMessage_(n)}onDataMessage_(r){this.onPrimaryResponse_(),this.onMessage_(r)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(r){let t=Go(Pd,r);if(bx in r){let n=r[bx];if(t===cI){let i=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===Tx){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===sI?this.onConnectionShutdown_(n):t===wx?this.onReset_(n):t===oI?zd("Server Error: "+n):t===yx?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):zd("Unknown control packet command: "+t)}}onHandshake_(r){let t=r.ts,n=r.v,i=r.h;this.sessionId=r.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),df!==n&&vr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let r=this.transportManager_.upgradeTransport();r&&this.startUpgrade_(r)}startUpgrade_(r){this.secondaryConn_=new r(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=r.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Ko(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(rI))}onReset_(r){this.log_("Reset packet received.  New host: "+r),this.repoInfo_.host=r,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(r,t){this.log_("Realtime connection established."),this.conn_=r,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ko(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(nI))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:kx,d:{}}}))}onSecondaryConnectionLost_(){let r=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===r||this.rx_===r)&&this.close()}onConnectionLost_(r){this.conn_=null,!r&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ba.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(r){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(r),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(r){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(r)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var pf=class{put(r,t,n,i){}merge(r,t,n,i){}refreshAuthToken(r){}refreshAppCheckToken(r){}onDisconnectPut(r,t,n){}onDisconnectMerge(r,t,n){}onDisconnectCancel(r,t){}reportStats(r){}};var gf=class{constructor(r){this.allowedEvents_=r,this.listeners_={},de(Array.isArray(r)&&r.length>0,"Requires a non-empty array")}trigger(r,...t){if(Array.isArray(this.listeners_[r])){let n=[...this.listeners_[r]];for(let i=0;i<n.length;i++)n[i].callback.apply(n[i].context,t)}}on(r,t,n){this.validateEventType_(r),this.listeners_[r]=this.listeners_[r]||[],this.listeners_[r].push({callback:t,context:n});let i=this.getInitialEvent(r);i&&t.apply(n,i)}off(r,t,n){this.validateEventType_(r);let i=this.listeners_[r]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!n||n===i[a].context)){i.splice(a,1);return}}validateEventType_(r){de(this.allowedEvents_.find(t=>t===r),"Unknown event: "+r)}};var _f=class e extends gf{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!dd()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new e}getInitialEvent(r){return de(r==="online","Unknown event type: "+r),[this.online_]}currentlyOnline(){return this.online_}};var Sx=32,Ax=768,lt=class{constructor(r,t){if(t===void 0){this.pieces_=r.split("/");let n=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=r,this.pieceNum_=t}toString(){let r="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(r+="/"+this.pieces_[t]);return r||"/"}};function ct(){return new lt("")}function Ke(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function sa(e){return e.pieces_.length-e.pieceNum_}function xt(e){let r=e.pieceNum_;return r<e.pieces_.length&&r++,new lt(e.pieces_,r)}function Kh(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function lI(e){let r="";for(let t=e.pieceNum_;t<e.pieces_.length;t++)e.pieces_[t]!==""&&(r+="/"+encodeURIComponent(String(e.pieces_[t])));return r||"/"}function ec(e,r=0){return e.pieces_.slice(e.pieceNum_+r)}function pv(e){if(e.pieceNum_>=e.pieces_.length)return null;let r=[];for(let t=e.pieceNum_;t<e.pieces_.length-1;t++)r.push(e.pieces_[t]);return new lt(r,0)}function St(e,r){let t=[];for(let n=e.pieceNum_;n<e.pieces_.length;n++)t.push(e.pieces_[n]);if(r instanceof lt)for(let n=r.pieceNum_;n<r.pieces_.length;n++)t.push(r.pieces_[n]);else{let n=r.split("/");for(let i=0;i<n.length;i++)n[i].length>0&&t.push(n[i])}return new lt(t,0)}function Ye(e){return e.pieceNum_>=e.pieces_.length}function Lr(e,r){let t=Ke(e),n=Ke(r);if(t===null)return r;if(t===n)return Lr(xt(e),xt(r));throw new Error("INTERNAL ERROR: innerPath ("+r+") is not within outerPath ("+e+")")}function fI(e,r){let t=ec(e,0),n=ec(r,0);for(let i=0;i<t.length&&i<n.length;i++){let a=Ha(t[i],n[i]);if(a!==0)return a}return t.length===n.length?0:t.length<n.length?-1:1}function Yh(e,r){if(sa(e)!==sa(r))return!1;for(let t=e.pieceNum_,n=r.pieceNum_;t<=e.pieces_.length;t++,n++)if(e.pieces_[t]!==r.pieces_[n])return!1;return!0}function kn(e,r){let t=e.pieceNum_,n=r.pieceNum_;if(sa(e)>sa(r))return!1;for(;t<e.pieces_.length;){if(e.pieces_[t]!==r.pieces_[n])return!1;++t,++n}return!0}var Qd=class{constructor(r,t){this.errorPrefix_=t,this.parts_=ec(r,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=Uo(this.parts_[n]);gv(this)}};function uI(e,r){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(r),e.byteLength_+=Uo(r),gv(e)}function dI(e){let r=e.parts_.pop();e.byteLength_-=Uo(r),e.parts_.length>0&&(e.byteLength_-=1)}function gv(e){if(e.byteLength_>Ax)throw new Error(e.errorPrefix_+"has a key path longer than "+Ax+" bytes ("+e.byteLength_+").");if(e.parts_.length>Sx)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Sx+") or object contains a cycle "+Ma(e))}function Ma(e){return e.parts_.length===0?"":"in property '"+e.parts_.join(".")+"'"}var Jd=class e extends gf{constructor(){super(["visible"]);let r,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",r="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",r="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",r="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",r="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let n=!document[r];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}static getInstance(){return new e}getInitialEvent(r){return de(r==="visible","Unknown event type: "+r),[this.visible_]}};var Xo=1e3,hI=60*5*1e3,Cx=30*1e3,mI=1.3,pI=3e4,gI="server_kill",Fx=3,qh=(()=>{class e extends pf{constructor(t,n,i,a,o,l,f,d){if(super(),this.repoInfo_=t,this.applicationId_=n,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=o,this.authTokenProvider_=l,this.appCheckTokenProvider_=f,this.authOverride_=d,this.id=e.nextPersistentConnectionId_++,this.log_=mc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Xo,this.maxReconnectDelay_=hI,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d&&!ti())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Jd.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&_f.getInstance().on("online",this.onOnline_,this)}sendRequest(t,n,i){let a=++this.requestNumber_,o={r:a,a:t,b:n};this.log_(Ut(o)),de(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();let n=new tr,a={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:l=>{let f=l.d;l.s==="ok"?n.resolve(f):n.reject(f)}};this.outstandingGets_.push(a),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),n.promise}listen(t,n,i,a){this.initConnection_();let o=t._queryIdentifier,l=t._path.toString();this.log_("Listen called for "+l+" "+o),this.listens.has(l)||this.listens.set(l,new Map),de(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),de(!this.listens.get(l).has(o),"listen() called twice for same path/queryId.");let f={onComplete:a,hashFn:n,query:t,tag:i};this.listens.get(l).set(o,f),this.connected_&&this.sendListen_(f)}sendGet_(t){let n=this.outstandingGets_[t];this.sendRequest("g",n.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(i)})}sendListen_(t){let n=t.query,i=n._path.toString(),a=n._queryIdentifier;this.log_("Listen on "+i+" for "+a);let o={p:i},l="q";t.tag&&(o.q=n._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(l,o,f=>{let d=f.d,h=f.s;e.warnOnListenWarnings_(d,n),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",f),h!=="ok"&&this.removeListen_(i,a),t.onComplete&&t.onComplete(h,d))})}static warnOnListenWarnings_(t,n){if(t&&typeof t=="object"&&Tn(t,"w")){let i=Zi(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let a='".indexOn": "'+n._queryParams.getIndex().toString()+'"',o=n._path.toString();vr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||R_(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Cx)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,n=I_(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(n,i,a=>{let o=a.s,l=a.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let n=t.s,i=t.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,i)})}unlisten(t,n){let i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),de(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,n)}sendUnlisten_(t,n,i,a){this.log_("Unlisten on "+t+" for "+n);let o={p:t},l="n";a&&(o.q=i,o.t=a),this.sendRequest(l,o)}onDisconnectPut(t,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,n,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:n,onComplete:i})}onDisconnectMerge(t,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,n,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:n,onComplete:i})}onDisconnectCancel(t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(t,n,i,a){let o={p:n,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,l=>{a&&setTimeout(()=>{a(l.s,l.d)},Math.floor(0))})}put(t,n,i,a){this.putInternal("p",t,n,i,a)}merge(t,n,i,a){this.putInternal("m",t,n,i,a)}putInternal(t,n,i,a,o){this.initConnection_();let l={p:n,d:i};o!==void 0&&(l.h=o),this.outstandingPuts_.push({action:t,request:l,onComplete:a}),this.outstandingPutCount_++;let f=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(f):this.log_("Buffering put: "+n)}sendPut_(t){let n=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,i,o=>{this.log_(n+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),a&&a(o.s,o.d)})}reportStats(t){if(this.connected_){let n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Ut(t));let n=t.r,i=this.requestCBHash_[n];i&&(delete this.requestCBHash_[n],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,n){this.log_("handleServerMessage",t,n),t==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):t==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):t==="c"?this.onListenRevoked_(n.p,n.q):t==="ac"?this.onAuthRevoked_(n.s,n.d):t==="apc"?this.onAppCheckRevoked_(n.s,n.d):t==="sd"?this.onSecurityDebugPacket_(n):zd("Unrecognized action received from server: "+Ut(t)+`
Are you using the latest client?`)}onReady_(t,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){de(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Xo,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Xo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>pI&&(this.reconnectDelay_=Xo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,n=Math.max(0,this.reconnectDelay_-t);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*mI)}this.onConnectStatus_(!1)}establishConnection_(){return lr(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+e.nextConnectionId_++,o=this.lastSessionId,l=!1,f=null,d=function(){f?f.close():(l=!0,i())},h=function(g){de(f,"sendRequest call when we're not connected not allowed."),f.sendRequest(g)};this.realtime_={close:d,sendRequest:h};let p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,x]=yield Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);l?rr("getToken() completed but was canceled"):(rr("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=x&&x.token,f=new qd(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,i,v=>{vr(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(gI)},o))}catch(g){this.log_("Failed to get token: "+g),l||(this.repoInfo_.nodeAdmin&&vr(g),d())}}})}interrupt(t){rr("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){rr("Resuming connection for reason: "+t),delete this.interruptReasons_[t],tf(this.interruptReasons_)&&(this.reconnectDelay_=Xo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let n=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let n=this.outstandingPuts_[t];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,n){let i;n?i=n.map(o=>$h(o)).join("$"):i="default";let a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,n){let i=new lt(t).toString(),a;if(this.listens.has(i)){let o=this.listens.get(i);a=o.get(n),o.delete(n),o.size===0&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,n){rr("Auth token revoked: "+t+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Fx&&(this.reconnectDelay_=Cx,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,n){rr("App check token revoked: "+t+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Fx&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let n of t.values())this.sendListen_(n);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},n="js";ti()&&(this.repoInfo_.nodeAdmin?n="admin_node":n="node"),t["sdk."+n+"."+Gh.replace(/\./g,"-")]=1,dd()?t["framework.cordova"]=1:A_()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=_f.getInstance().currentlyOnline();return tf(this.interruptReasons_)&&t}}e.nextPersistentConnectionId_=0,e.nextConnectionId_=0;return e})(),Qe=class e{constructor(r,t){this.name=r,this.node=t}static Wrap(r,t){return new e(r,t)}};var Vs=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(r,t){let n=new Qe(aa,r),i=new Qe(aa,t);return this.compare(n,i)!==0}minPost(){return Qe.MIN}};var uf,xf=class extends Vs{static get __EMPTY_NODE(){return uf}static set __EMPTY_NODE(r){uf=r}compare(r,t){return Ha(r.name,t.name)}isDefinedOn(r){throw Ds("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(r,t){return!1}minPost(){return Qe.MIN}maxPost(){return new Qe(Ii,uf)}makePost(r,t){return de(typeof r=="string","KeyIndex indexValue must always be a string."),new Qe(r,uf)}toString(){return".key"}},ii=new xf;var Ws=class{constructor(r,t,n,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let o=1;for(;!r.isEmpty();)if(r=r,o=t?n(r.key,t):1,i&&(o*=-1),o<0)this.isReverse_?r=r.left:r=r.right;else if(o===0){this.nodeStack_.push(r);break}else this.nodeStack_.push(r),this.isReverse_?r=r.right:r=r.left}getNext(){if(this.nodeStack_.length===0)return null;let r=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(r.key,r.value):t={key:r.key,value:r.value},this.isReverse_)for(r=r.left;!r.isEmpty();)this.nodeStack_.push(r),r=r.right;else for(r=r.right;!r.isEmpty();)this.nodeStack_.push(r),r=r.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let r=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(r.key,r.value):{key:r.key,value:r.value}}},Hn=(()=>{class e{constructor(t,n,i,a,o){this.key=t,this.value=n,this.color=i??e.RED,this.left=a??Sn.EMPTY_NODE,this.right=o??Sn.EMPTY_NODE}copy(t,n,i,a,o){return new e(t??this.key,n??this.value,i??this.color,a??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let a=this,o=i(t,a.key);return o<0?a=a.copy(null,null,null,a.left.insert(t,n,i),null):o===0?a=a.copy(null,n,null,null,null):a=a.copy(null,null,null,null,a.right.insert(t,n,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return Sn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,n){let i,a;if(i=this,n(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),n(t,i.key)===0){if(i.right.isEmpty())return Sn.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return e.RED=!0,e.BLACK=!1,e})(),Zd=class{copy(r,t,n,i,a){return this}insert(r,t,n){return new Hn(r,t,null)}remove(r,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(r){return!1}reverseTraversal(r){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Sn=class e{constructor(r,t=e.EMPTY_NODE){this.comparator_=r,this.root_=t}insert(r,t){return new e(this.comparator_,this.root_.insert(r,t,this.comparator_).copy(null,null,Hn.BLACK,null,null))}remove(r){return new e(this.comparator_,this.root_.remove(r,this.comparator_).copy(null,null,Hn.BLACK,null,null))}get(r){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(r,n.key),t===0)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(r){let t,n=this.root_,i=null;for(;!n.isEmpty();)if(t=this.comparator_(r,n.key),t===0){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else t<0?n=n.left:t>0&&(i=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(r){return this.root_.inorderTraversal(r)}reverseTraversal(r){return this.root_.reverseTraversal(r)}getIterator(r){return new Ws(this.root_,null,this.comparator_,!1,r)}getIteratorFrom(r,t){return new Ws(this.root_,r,this.comparator_,!1,t)}getReverseIteratorFrom(r,t){return new Ws(this.root_,r,this.comparator_,!0,t)}getReverseIterator(r){return new Ws(this.root_,null,this.comparator_,!0,r)}};Sn.EMPTY_NODE=new Zd;function _I(e,r){return Ha(e.name,r.name)}function Qh(e,r){return Ha(e,r)}var eh;function xI(e){eh=e}var _v=function(e){return typeof e=="number"?"number:"+Jx(e):"string:"+e},xv=function(e){if(e.isLeafNode()){let r=e.val();de(typeof r=="string"||typeof r=="number"||typeof r=="object"&&Tn(r,".sv"),"Priority must be a string or number.")}else de(e===eh||e.isEmpty(),"priority of unexpected type.");de(e===eh||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Ix,zs=(()=>{class e{constructor(t,n=e.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=n,this.lazyHash_=null,de(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),xv(this.priorityNode_)}static set __childrenNodeConstructor(t){Ix=t}static get __childrenNodeConstructor(){return Ix}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new e(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ye(t)?this:Ke(t)===".priority"?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,n){return null}updateImmediateChild(t,n){return t===".priority"?this.updatePriority(n):n.isEmpty()&&t!==".priority"?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}updateChild(t,n){let i=Ke(t);return i===null?n:n.isEmpty()&&i!==".priority"?this:(de(i!==".priority"||sa(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(xt(t),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,n){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+_v(this.priorityNode_.val())+":");let n=typeof this.value_;t+=n+":",n==="number"?t+=Jx(this.value_):t+=this.value_,this.lazyHash_=Yx(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(de(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let n=typeof t.value_,i=typeof this.value_,a=e.VALUE_TYPE_ORDER.indexOf(n),o=e.VALUE_TYPE_ORDER.indexOf(i);return de(a>=0,"Unknown leaf type: "+n),de(o>=0,"Unknown leaf type: "+i),a===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-a}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let n=t;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}e.VALUE_TYPE_ORDER=["object","boolean","number","string"];return e})(),vv,bv;function vI(e){vv=e}function bI(e){bv=e}var th=class extends Vs{compare(r,t){let n=r.node.getPriority(),i=t.node.getPriority(),a=n.compareTo(i);return a===0?Ha(r.name,t.name):a}isDefinedOn(r){return!r.getPriority().isEmpty()}indexedValueChanged(r,t){return!r.getPriority().equals(t.getPriority())}minPost(){return Qe.MIN}maxPost(){return new Qe(Ii,new zs("[PRIORITY-POST]",bv))}makePost(r,t){let n=vv(r);return new Qe(t,new zs("[PRIORITY-POST]",n))}toString(){return".priority"}},bt=new th;var wI=Math.log(2),rh=class{constructor(r){let t=a=>parseInt(Math.log(a)/wI,10),n=a=>parseInt(Array(a+1).join("1"),2);this.count=t(r+1),this.current_=this.count-1;let i=n(this.count);this.bits_=r+1&i}nextBitIsOne(){let r=!(this.bits_&1<<this.current_);return this.current_--,r}},vf=function(e,r,t,n){e.sort(r);let i=function(f,d){let h=d-f,p,g;if(h===0)return null;if(h===1)return p=e[f],g=t?t(p):p,new Hn(g,p.node,Hn.BLACK,null,null);{let x=parseInt(h/2,10)+f,v=i(f,x),_=i(x+1,d);return p=e[x],g=t?t(p):p,new Hn(g,p.node,Hn.BLACK,v,_)}},a=function(f){let d=null,h=null,p=e.length,g=function(v,_){let y=p-v,N=p;p-=v;let R=i(y+1,N),T=e[y],z=t?t(T):T;x(new Hn(z,T.node,_,null,R))},x=function(v){d?(d.left=v,d=v):(h=v,d=v)};for(let v=0;v<f.count;++v){let _=f.nextBitIsOne(),y=Math.pow(2,f.count-(v+1));_?g(y,Hn.BLACK):(g(y,Hn.BLACK),g(y,Hn.RED))}return h},o=new rh(e.length),l=a(o);return new Sn(n||r,l)};var Ld,Bs={},Gs=class e{constructor(r,t){this.indexes_=r,this.indexSet_=t}static get Default(){return de(Bs&&bt,"ChildrenNode.ts has not been loaded"),Ld=Ld||new e({".priority":Bs},{".priority":bt}),Ld}get(r){let t=Zi(this.indexes_,r);if(!t)throw new Error("No index defined for "+r);return t instanceof Sn?t:null}hasIndex(r){return Tn(this.indexSet_,r.toString())}addIndex(r,t){de(r!==ii,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let n=[],i=!1,a=t.getIterator(Qe.Wrap),o=a.getNext();for(;o;)i=i||r.isDefinedOn(o.node),n.push(o),o=a.getNext();let l;i?l=vf(n,r.getCompare()):l=Bs;let f=r.toString(),d=Object.assign({},this.indexSet_);d[f]=r;let h=Object.assign({},this.indexes_);return h[f]=l,new e(h,d)}addToIndexes(r,t){let n=Bo(this.indexes_,(i,a)=>{let o=Zi(this.indexSet_,a);if(de(o,"Missing index implementation for "+a),i===Bs)if(o.isDefinedOn(r.node)){let l=[],f=t.getIterator(Qe.Wrap),d=f.getNext();for(;d;)d.name!==r.name&&l.push(d),d=f.getNext();return l.push(r),vf(l,o.getCompare())}else return Bs;else{let l=t.get(r.name),f=i;return l&&(f=f.remove(new Qe(r.name,l))),f.insert(r,r.node)}});return new e(n,this.indexSet_)}removeFromIndexes(r,t){let n=Bo(this.indexes_,i=>{if(i===Bs)return i;{let a=t.get(r.name);return a?i.remove(new Qe(r.name,a)):i}});return new e(n,this.indexSet_)}};var $o,We=(()=>{class e{constructor(t,n,i){this.children_=t,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&xv(this.priorityNode_),this.children_.isEmpty()&&de(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return $o||($o=new e(new Sn(Qh),null,Gs.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||$o}updatePriority(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let n=this.children_.get(t);return n===null?$o:n}}getChild(t){let n=Ke(t);return n===null?this:this.getImmediateChild(n).getChild(xt(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,n){if(de(n,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(n);{let i=new Qe(t,n),a,o;n.isEmpty()?(a=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,n),o=this.indexMap_.addToIndexes(i,this.children_));let l=a.isEmpty()?$o:this.priorityNode_;return new e(a,l,o)}}updateChild(t,n){let i=Ke(t);if(i===null)return n;{de(Ke(t)!==".priority"||sa(t)===1,".priority must be the last token in a path");let a=this.getImmediateChild(i).updateChild(xt(t),n);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let n={},i=0,a=0,o=!0;if(this.forEachChild(bt,(l,f)=>{n[l]=f.val(t),i++,o&&e.INTEGER_REGEXP_.test(l)?a=Math.max(a,Number(l)):o=!1}),!t&&o&&a<2*i){let l=[];for(let f in n)l[f]=n[f];return l}else return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+_v(this.getPriority().val())+":"),this.forEachChild(bt,(n,i)=>{let a=i.hash();a!==""&&(t+=":"+n+":"+a)}),this.lazyHash_=t===""?"":Yx(t)}return this.lazyHash_}getPredecessorChildName(t,n,i){let a=this.resolveIndex_(i);if(a){let o=a.getPredecessorKey(new Qe(t,n));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let n=this.resolveIndex_(t);if(n){let i=n.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let n=this.getFirstChildName(t);return n?new Qe(n,this.children_.get(n)):null}getLastChildName(t){let n=this.resolveIndex_(t);if(n){let i=n.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let n=this.getLastChildName(t);return n?new Qe(n,this.children_.get(n)):null}forEachChild(t,n){let i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>n(a.name,a.node)):this.children_.inorderTraversal(n)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,n){let i=this.resolveIndex_(n);if(i)return i.getIteratorFrom(t,a=>a);{let a=this.children_.getIteratorFrom(t.name,Qe.Wrap),o=a.peek();for(;o!=null&&n.compare(o,t)<0;)a.getNext(),o=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,n){let i=this.resolveIndex_(n);if(i)return i.getReverseIteratorFrom(t,a=>a);{let a=this.children_.getReverseIteratorFrom(t.name,Qe.Wrap),o=a.peek();for(;o!=null&&n.compare(o,t)>0;)a.getNext(),o=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===pc?-1:0}withIndex(t){if(t===ii||this.indexMap_.hasIndex(t))return this;{let n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}}isIndexed(t){return t===ii||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let n=t;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){let i=this.getIterator(bt),a=n.getIterator(bt),o=i.getNext(),l=a.getNext();for(;o&&l;){if(o.name!==l.name||!o.node.equals(l.node))return!1;o=i.getNext(),l=a.getNext()}return o===null&&l===null}else return!1;else return!1}}resolveIndex_(t){return t===ii?null:this.indexMap_.get(t.toString())}}return e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e})(),nh=class extends We{constructor(){super(new Sn(Qh),We.EMPTY_NODE,Gs.Default)}compareTo(r){return r===this?0:1}equals(r){return r===this}getPriority(){return this}getImmediateChild(r){return We.EMPTY_NODE}isEmpty(){return!1}},pc=new nh;Object.defineProperties(Qe,{MIN:{value:new Qe(aa,We.EMPTY_NODE)},MAX:{value:new Qe(Ii,pc)}});xf.__EMPTY_NODE=We.EMPTY_NODE;zs.__childrenNodeConstructor=We;xI(pc);bI(pc);var yI=!0;function Rt(e,r=null){if(e===null)return We.EMPTY_NODE;if(typeof e=="object"&&".priority"in e&&(r=e[".priority"]),de(r===null||typeof r=="string"||typeof r=="number"||typeof r=="object"&&".sv"in r,"Invalid priority type found: "+typeof r),typeof e=="object"&&".value"in e&&e[".value"]!==null&&(e=e[".value"]),typeof e!="object"||".sv"in e){let t=e;return new zs(t,Rt(r))}if(!(e instanceof Array)&&yI){let t=[],n=!1;if(nr(e,(o,l)=>{if(o.substring(0,1)!=="."){let f=Rt(l);f.isEmpty()||(n=n||!f.getPriority().isEmpty(),t.push(new Qe(o,f)))}}),t.length===0)return We.EMPTY_NODE;let a=vf(t,_I,o=>o.name,Qh);if(n){let o=vf(t,bt.getCompare());return new We(a,Rt(r),new Gs({".priority":o},{".priority":bt}))}else return new We(a,Rt(r),Gs.Default)}else{let t=We.EMPTY_NODE;return nr(e,(n,i)=>{if(Tn(e,n)&&n.substring(0,1)!=="."){let a=Rt(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(n,a))}}),t.updatePriority(Rt(r))}}vI(Rt);var tc=class extends Vs{constructor(r){super(),this.indexPath_=r,de(!Ye(r)&&Ke(r)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(r){return r.getChild(this.indexPath_)}isDefinedOn(r){return!r.getChild(this.indexPath_).isEmpty()}compare(r,t){let n=this.extractChild(r.node),i=this.extractChild(t.node),a=n.compareTo(i);return a===0?Ha(r.name,t.name):a}makePost(r,t){let n=Rt(r),i=We.EMPTY_NODE.updateChild(this.indexPath_,n);return new Qe(t,i)}maxPost(){let r=We.EMPTY_NODE.updateChild(this.indexPath_,pc);return new Qe(Ii,r)}toString(){return ec(this.indexPath_,0).join("/")}};var ih=class extends Vs{compare(r,t){let n=r.node.compareTo(t.node);return n===0?Ha(r.name,t.name):n}isDefinedOn(r){return!0}indexedValueChanged(r,t){return!r.equals(t)}minPost(){return Qe.MIN}maxPost(){return Qe.MAX}makePost(r,t){let n=Rt(r);return new Qe(t,n)}toString(){return".value"}},Jh=new ih;function wv(e){return{type:"value",snapshotNode:e}}function Xs(e,r){return{type:"child_added",snapshotNode:r,childName:e}}function rc(e,r){return{type:"child_removed",snapshotNode:r,childName:e}}function nc(e,r,t){return{type:"child_changed",snapshotNode:r,childName:e,oldSnap:t}}function EI(e,r){return{type:"child_moved",snapshotNode:r,childName:e}}var ic=class{constructor(r){this.index_=r}updateChild(r,t,n,i,a,o){de(r.isIndexed(this.index_),"A node must be indexed if only a child is updated");let l=r.getImmediateChild(t);return l.getChild(i).equals(n.getChild(i))&&l.isEmpty()===n.isEmpty()||(o!=null&&(n.isEmpty()?r.hasChild(t)?o.trackChildChange(rc(t,l)):de(r.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(Xs(t,n)):o.trackChildChange(nc(t,n,l))),r.isLeafNode()&&n.isEmpty())?r:r.updateImmediateChild(t,n).withIndex(this.index_)}updateFullNode(r,t,n){return n!=null&&(r.isLeafNode()||r.forEachChild(bt,(i,a)=>{t.hasChild(i)||n.trackChildChange(rc(i,a))}),t.isLeafNode()||t.forEachChild(bt,(i,a)=>{if(r.hasChild(i)){let o=r.getImmediateChild(i);o.equals(a)||n.trackChildChange(nc(i,a,o))}else n.trackChildChange(Xs(i,a))})),t.withIndex(this.index_)}updatePriority(r,t){return r.isEmpty()?We.EMPTY_NODE:r.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var bf=class e{constructor(r){this.indexedFilter_=new ic(r.getIndex()),this.index_=r.getIndex(),this.startPost_=e.getStartPost_(r),this.endPost_=e.getEndPost_(r),this.startIsInclusive_=!r.startAfterSet_,this.endIsInclusive_=!r.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(r){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),r)<=0:this.index_.compare(this.getStartPost(),r)<0,n=this.endIsInclusive_?this.index_.compare(r,this.getEndPost())<=0:this.index_.compare(r,this.getEndPost())<0;return t&&n}updateChild(r,t,n,i,a,o){return this.matches(new Qe(t,n))||(n=We.EMPTY_NODE),this.indexedFilter_.updateChild(r,t,n,i,a,o)}updateFullNode(r,t,n){t.isLeafNode()&&(t=We.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(We.EMPTY_NODE);let a=this;return t.forEachChild(bt,(o,l)=>{a.matches(new Qe(o,l))||(i=i.updateImmediateChild(o,We.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(r,i,n)}updatePriority(r,t){return r}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(r){if(r.hasStart()){let t=r.getIndexStartName();return r.getIndex().makePost(r.getIndexStartValue(),t)}else return r.getIndex().minPost()}static getEndPost_(r){if(r.hasEnd()){let t=r.getIndexEndName();return r.getIndex().makePost(r.getIndexEndValue(),t)}else return r.getIndex().maxPost()}};var ah=class{constructor(r){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let n=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?n<=0:n<0},this.withinEndPost=t=>{let n=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?n<=0:n<0},this.rangedFilter_=new bf(r),this.index_=r.getIndex(),this.limit_=r.getLimit(),this.reverse_=!r.isViewFromLeft(),this.startIsInclusive_=!r.startAfterSet_,this.endIsInclusive_=!r.endBeforeSet_}updateChild(r,t,n,i,a,o){return this.rangedFilter_.matches(new Qe(t,n))||(n=We.EMPTY_NODE),r.getImmediateChild(t).equals(n)?r:r.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(r,t,n,i,a,o):this.fullLimitUpdateChild_(r,t,n,a,o)}updateFullNode(r,t,n){let i;if(t.isLeafNode()||t.isEmpty())i=We.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=We.EMPTY_NODE.withIndex(this.index_);let a;this.reverse_?a=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):a=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;a.hasNext()&&o<this.limit_;){let l=a.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))i=i.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(We.EMPTY_NODE);let a;this.reverse_?a=i.getReverseIterator(this.index_):a=i.getIterator(this.index_);let o=0;for(;a.hasNext();){let l=a.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:i=i.updateImmediateChild(l.name,We.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(r,i,n)}updatePriority(r,t){return r}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(r,t,n,i,a){let o;if(this.reverse_){let p=this.index_.getCompare();o=(g,x)=>p(x,g)}else o=this.index_.getCompare();let l=r;de(l.numChildren()===this.limit_,"");let f=new Qe(t,n),d=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),h=this.rangedFilter_.matches(f);if(l.hasChild(t)){let p=l.getImmediateChild(t),g=i.getChildAfterChild(this.index_,d,this.reverse_);for(;g!=null&&(g.name===t||l.hasChild(g.name));)g=i.getChildAfterChild(this.index_,g,this.reverse_);let x=g==null?1:o(g,f);if(h&&!n.isEmpty()&&x>=0)return a?.trackChildChange(nc(t,n,p)),l.updateImmediateChild(t,n);{a?.trackChildChange(rc(t,p));let _=l.updateImmediateChild(t,We.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(a?.trackChildChange(Xs(g.name,g.node)),_.updateImmediateChild(g.name,g.node)):_}}else return n.isEmpty()?r:h&&o(d,f)>=0?(a!=null&&(a.trackChildChange(rc(d.name,d.node)),a.trackChildChange(Xs(t,n))),l.updateImmediateChild(t,n).updateImmediateChild(d.name,We.EMPTY_NODE)):r}};var ac=class e{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=bt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return de(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return de(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:aa}hasEnd(){return this.endSet_}getIndexEndValue(){return de(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return de(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ii}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return de(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===bt}copy(){let r=new e;return r.limitSet_=this.limitSet_,r.limit_=this.limit_,r.startSet_=this.startSet_,r.startAfterSet_=this.startAfterSet_,r.indexStartValue_=this.indexStartValue_,r.startNameSet_=this.startNameSet_,r.indexStartName_=this.indexStartName_,r.endSet_=this.endSet_,r.endBeforeSet_=this.endBeforeSet_,r.indexEndValue_=this.indexEndValue_,r.endNameSet_=this.endNameSet_,r.indexEndName_=this.indexEndName_,r.index_=this.index_,r.viewFrom_=this.viewFrom_,r}};function TI(e){return e.loadsAllData()?new ic(e.getIndex()):e.hasLimit()?new ah(e):new bf(e)}function kI(e,r){let t=e.copy();return t.limitSet_=!0,t.limit_=r,t.viewFrom_="l",t}function SI(e,r){let t=e.copy();return t.limitSet_=!0,t.limit_=r,t.viewFrom_="r",t}function sh(e,r,t){let n=e.copy();return n.startSet_=!0,r===void 0&&(r=null),n.indexStartValue_=r,t!=null?(n.startNameSet_=!0,n.indexStartName_=t):(n.startNameSet_=!1,n.indexStartName_=""),n}function AI(e,r,t){let n;return e.index_===ii||t?n=sh(e,r,t):n=sh(e,r,Ii),n.startAfterSet_=!0,n}function oh(e,r,t){let n=e.copy();return n.endSet_=!0,r===void 0&&(r=null),n.indexEndValue_=r,t!==void 0?(n.endNameSet_=!0,n.indexEndName_=t):(n.endNameSet_=!1,n.indexEndName_=""),n}function CI(e,r,t){let n;return e.index_===ii||t?n=oh(e,r,t):n=oh(e,r,aa),n.endBeforeSet_=!0,n}function Uf(e,r){let t=e.copy();return t.index_=r,t}function Rx(e){let r={};if(e.isDefault())return r;let t;if(e.index_===bt?t="$priority":e.index_===Jh?t="$value":e.index_===ii?t="$key":(de(e.index_ instanceof tc,"Unrecognized index type!"),t=e.index_.toString()),r.orderBy=Ut(t),e.startSet_){let n=e.startAfterSet_?"startAfter":"startAt";r[n]=Ut(e.indexStartValue_),e.startNameSet_&&(r[n]+=","+Ut(e.indexStartName_))}if(e.endSet_){let n=e.endBeforeSet_?"endBefore":"endAt";r[n]=Ut(e.indexEndValue_),e.endNameSet_&&(r[n]+=","+Ut(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?r.limitToFirst=e.limit_:r.limitToLast=e.limit_),r}function Nx(e){let r={};if(e.startSet_&&(r.sp=e.indexStartValue_,e.startNameSet_&&(r.sn=e.indexStartName_),r.sin=!e.startAfterSet_),e.endSet_&&(r.ep=e.indexEndValue_,e.endNameSet_&&(r.en=e.indexEndName_),r.ein=!e.endBeforeSet_),e.limitSet_){r.l=e.limit_;let t=e.viewFrom_;t===""&&(e.isViewFromLeft()?t="l":t="r"),r.vf=t}return e.index_!==bt&&(r.i=e.index_.toString()),r}var ch=class e extends pf{constructor(r,t,n,i){super(),this.repoInfo_=r,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=mc("p:rest:"),this.listens_={}}reportStats(r){throw new Error("Method not implemented.")}static getListenId_(r,t){return t!==void 0?"tag$"+t:(de(r._queryParams.isDefault(),"should have a tag if it's not a default query."),r._path.toString())}listen(r,t,n,i){let a=r._path.toString();this.log_("Listen called for "+a+" "+r._queryIdentifier);let o=e.getListenId_(r,n),l={};this.listens_[o]=l;let f=Rx(r._queryParams);this.restRequest_(a+".json",f,(d,h)=>{let p=h;if(d===404&&(p=null,d=null),d===null&&this.onDataUpdate_(a,p,!1,n),Zi(this.listens_,o)===l){let g;d?d===401?g="permission_denied":g="rest_error:"+d:g="ok",i(g,null)}})}unlisten(r,t){let n=e.getListenId_(r,t);delete this.listens_[n]}get(r){let t=Rx(r._queryParams),n=r._path.toString(),i=new tr;return this.restRequest_(n+".json",t,(a,o)=>{let l=o;a===404&&(l=null,a=null),a===null?(this.onDataUpdate_(n,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(r){}restRequest_(r,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+r+"?ns="+this.repoInfo_.namespace+N_(t);this.log_("Sending REST request for "+o);let l=new XMLHttpRequest;l.onreadystatechange=()=>{if(n&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let f=null;if(l.status>=200&&l.status<300){try{f=ef(l.responseText)}catch{vr("Failed to parse JSON response for "+o+": "+l.responseText)}n(null,f)}else l.status!==401&&l.status!==404&&vr("Got unsuccessful REST response for "+o+" Status: "+l.status),n(l.status);n=null}},l.open("GET",o,!0),l.send()})}};var lh=class{constructor(){this.rootNode_=We.EMPTY_NODE}getNode(r){return this.rootNode_.getChild(r)}updateSnapshot(r,t){this.rootNode_=this.rootNode_.updateChild(r,t)}};function wf(){return{value:null,children:new Map}}function Qs(e,r,t){if(Ye(r))e.value=t,e.children.clear();else if(e.value!==null)e.value=e.value.updateChild(r,t);else{let n=Ke(r);e.children.has(n)||e.children.set(n,wf());let i=e.children.get(n);r=xt(r),Qs(i,r,t)}}function fh(e,r){if(Ye(r))return e.value=null,e.children.clear(),!0;if(e.value!==null){if(e.value.isLeafNode())return!1;{let t=e.value;return e.value=null,t.forEachChild(bt,(n,i)=>{Qs(e,new lt(n),i)}),fh(e,r)}}else if(e.children.size>0){let t=Ke(r);return r=xt(r),e.children.has(t)&&fh(e.children.get(t),r)&&e.children.delete(t),e.children.size===0}else return!0}function uh(e,r,t){e.value!==null?t(r,e.value):FI(e,(n,i)=>{let a=new lt(r.toString()+"/"+n);uh(i,a,t)})}function FI(e,r){e.children.forEach((t,n)=>{r(n,t)})}var dh=class{constructor(r){this.collection_=r,this.last_=null}get(){let r=this.collection_.get(),t=Object.assign({},r);return this.last_&&nr(this.last_,(n,i)=>{t[n]=t[n]-i}),this.last_=r,t}};var Dx=10*1e3,II=30*1e3,RI=5*60*1e3,hh=class{constructor(r,t){this.server_=t,this.statsToReport_={},this.statsListener_=new dh(r);let n=Dx+(II-Dx)*Math.random();Ko(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){let r=this.statsListener_.get(),t={},n=!1;nr(r,(i,a)=>{a>0&&Tn(this.statsToReport_,i)&&(t[i]=a,n=!0)}),n&&this.server_.reportStats(t),Ko(this.reportStats_.bind(this),Math.floor(Math.random()*2*RI))}};var ni=function(e){return e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",e}(ni||{});function Zh(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function em(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function tm(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}var mh=class e{constructor(r,t,n){this.path=r,this.affectedTree=t,this.revert=n,this.type=ni.ACK_USER_WRITE,this.source=Zh()}operationForChild(r){if(Ye(this.path)){if(this.affectedTree.value!=null)return de(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new lt(r));return new e(ct(),t,this.revert)}}else return de(Ke(this.path)===r,"operationForChild called for unrelated child."),new e(xt(this.path),this.affectedTree,this.revert)}};var yf=class e{constructor(r,t){this.source=r,this.path=t,this.type=ni.LISTEN_COMPLETE}operationForChild(r){return Ye(this.path)?new e(this.source,ct()):new e(this.source,xt(this.path))}};var $s=class e{constructor(r,t,n){this.source=r,this.path=t,this.snap=n,this.type=ni.OVERWRITE}operationForChild(r){return Ye(this.path)?new e(this.source,ct(),this.snap.getImmediateChild(r)):new e(this.source,xt(this.path),this.snap)}};var sc=class e{constructor(r,t,n){this.source=r,this.path=t,this.children=n,this.type=ni.MERGE}operationForChild(r){if(Ye(this.path)){let t=this.children.subtree(new lt(r));return t.isEmpty()?null:t.value?new $s(this.source,ct(),t.value):new e(this.source,ct(),t)}else return de(Ke(this.path)===r,"Can't get a merge for a child not on the path of the operation"),new e(this.source,xt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var si=class{constructor(r,t,n){this.node_=r,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(r){if(Ye(r))return this.isFullyInitialized()&&!this.filtered_;let t=Ke(r);return this.isCompleteForChild(t)}isCompleteForChild(r){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(r)}getNode(){return this.node_}};var ph=class{constructor(r){this.query_=r,this.index_=this.query_._queryParams.getIndex()}};function NI(e,r,t,n){let i=[],a=[];return r.forEach(o=>{o.type==="child_changed"&&e.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&a.push(EI(o.childName,o.snapshotNode))}),jo(e,i,"child_removed",r,n,t),jo(e,i,"child_added",r,n,t),jo(e,i,"child_moved",a,n,t),jo(e,i,"child_changed",r,n,t),jo(e,i,"value",r,n,t),i}function jo(e,r,t,n,i,a){let o=n.filter(l=>l.type===t);o.sort((l,f)=>OI(e,l,f)),o.forEach(l=>{let f=DI(e,l,a);i.forEach(d=>{d.respondsTo(l.type)&&r.push(d.createEvent(f,e.query_))})})}function DI(e,r,t){return r.type==="value"||r.type==="child_removed"||(r.prevName=t.getPredecessorChildName(r.childName,r.snapshotNode,e.index_)),r}function OI(e,r,t){if(r.childName==null||t.childName==null)throw Ds("Should only compare child_ events.");let n=new Qe(r.childName,r.snapshotNode),i=new Qe(t.childName,t.snapshotNode);return e.index_.compare(n,i)}function Wf(e,r){return{eventCache:e,serverCache:r}}function qo(e,r,t,n){return Wf(new si(r,t,n),e.serverCache)}function yv(e,r,t,n){return Wf(e.eventCache,new si(r,t,n))}function Ef(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Wa(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var Md,PI=()=>(Md||(Md=new Sn(DF)),Md),Mr=class e{constructor(r,t=PI()){this.value=r,this.children=t}static fromObject(r){let t=new e(null);return nr(r,(n,i)=>{t=t.set(new lt(n),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(r,t){if(this.value!=null&&t(this.value))return{path:ct(),value:this.value};if(Ye(r))return null;{let n=Ke(r),i=this.children.get(n);if(i!==null){let a=i.findRootMostMatchingPathAndValue(xt(r),t);return a!=null?{path:St(new lt(n),a.path),value:a.value}:null}else return null}}findRootMostValueAndPath(r){return this.findRootMostMatchingPathAndValue(r,()=>!0)}subtree(r){if(Ye(r))return this;{let t=Ke(r),n=this.children.get(t);return n!==null?n.subtree(xt(r)):new e(null)}}set(r,t){if(Ye(r))return new e(t,this.children);{let n=Ke(r),a=(this.children.get(n)||new e(null)).set(xt(r),t),o=this.children.insert(n,a);return new e(this.value,o)}}remove(r){if(Ye(r))return this.children.isEmpty()?new e(null):new e(null,this.children);{let t=Ke(r),n=this.children.get(t);if(n){let i=n.remove(xt(r)),a;return i.isEmpty()?a=this.children.remove(t):a=this.children.insert(t,i),this.value===null&&a.isEmpty()?new e(null):new e(this.value,a)}else return this}}get(r){if(Ye(r))return this.value;{let t=Ke(r),n=this.children.get(t);return n?n.get(xt(r)):null}}setTree(r,t){if(Ye(r))return t;{let n=Ke(r),a=(this.children.get(n)||new e(null)).setTree(xt(r),t),o;return a.isEmpty()?o=this.children.remove(n):o=this.children.insert(n,a),new e(this.value,o)}}fold(r){return this.fold_(ct(),r)}fold_(r,t){let n={};return this.children.inorderTraversal((i,a)=>{n[i]=a.fold_(St(r,i),t)}),t(r,this.value,n)}findOnPath(r,t){return this.findOnPath_(r,ct(),t)}findOnPath_(r,t,n){let i=this.value?n(t,this.value):!1;if(i)return i;if(Ye(r))return null;{let a=Ke(r),o=this.children.get(a);return o?o.findOnPath_(xt(r),St(t,a),n):null}}foreachOnPath(r,t){return this.foreachOnPath_(r,ct(),t)}foreachOnPath_(r,t,n){if(Ye(r))return this;{this.value&&n(t,this.value);let i=Ke(r),a=this.children.get(i);return a?a.foreachOnPath_(xt(r),St(t,i),n):new e(null)}}foreach(r){this.foreach_(ct(),r)}foreach_(r,t){this.children.inorderTraversal((n,i)=>{i.foreach_(St(r,n),t)}),this.value&&t(r,this.value)}foreachChild(r){this.children.inorderTraversal((t,n)=>{n.value&&r(t,n.value)})}};var Vn=class e{constructor(r){this.writeTree_=r}static empty(){return new e(new Mr(null))}};function Qo(e,r,t){if(Ye(r))return new Vn(new Mr(t));{let n=e.writeTree_.findRootMostValueAndPath(r);if(n!=null){let i=n.path,a=n.value,o=Lr(i,r);return a=a.updateChild(o,t),new Vn(e.writeTree_.set(i,a))}else{let i=new Mr(t),a=e.writeTree_.setTree(r,i);return new Vn(a)}}}function gh(e,r,t){let n=e;return nr(t,(i,a)=>{n=Qo(n,St(r,i),a)}),n}function Ox(e,r){if(Ye(r))return Vn.empty();{let t=e.writeTree_.setTree(r,new Mr(null));return new Vn(t)}}function _h(e,r){return Va(e,r)!=null}function Va(e,r){let t=e.writeTree_.findRootMostValueAndPath(r);return t!=null?e.writeTree_.get(t.path).getChild(Lr(t.path,r)):null}function Px(e){let r=[],t=e.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(bt,(n,i)=>{r.push(new Qe(n,i))}):e.writeTree_.children.inorderTraversal((n,i)=>{i.value!=null&&r.push(new Qe(n,i.value))}),r}function na(e,r){if(Ye(r))return e;{let t=Va(e,r);return t!=null?new Vn(new Mr(t)):new Vn(e.writeTree_.subtree(r))}}function xh(e){return e.writeTree_.isEmpty()}function js(e,r){return Ev(ct(),e.writeTree_,r)}function Ev(e,r,t){if(r.value!=null)return t.updateChild(e,r.value);{let n=null;return r.children.inorderTraversal((i,a)=>{i===".priority"?(de(a.value!==null,"Priority writes must always be leaf nodes"),n=a.value):t=Ev(St(e,i),a,t)}),!t.getChild(e).isEmpty()&&n!==null&&(t=t.updateChild(St(e,".priority"),n)),t}}function Hf(e,r){return Av(r,e)}function LI(e,r,t,n,i){de(n>e.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),e.allWrites.push({path:r,snap:t,writeId:n,visible:i}),i&&(e.visibleWrites=Qo(e.visibleWrites,r,t)),e.lastWriteId=n}function MI(e,r,t,n){de(n>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:r,children:t,writeId:n,visible:!0}),e.visibleWrites=gh(e.visibleWrites,r,t),e.lastWriteId=n}function BI(e,r){for(let t=0;t<e.allWrites.length;t++){let n=e.allWrites[t];if(n.writeId===r)return n}return null}function UI(e,r){let t=e.allWrites.findIndex(l=>l.writeId===r);de(t>=0,"removeWrite called with nonexistent writeId.");let n=e.allWrites[t];e.allWrites.splice(t,1);let i=n.visible,a=!1,o=e.allWrites.length-1;for(;i&&o>=0;){let l=e.allWrites[o];l.visible&&(o>=t&&WI(l,n.path)?i=!1:kn(n.path,l.path)&&(a=!0)),o--}if(i){if(a)return HI(e),!0;if(n.snap)e.visibleWrites=Ox(e.visibleWrites,n.path);else{let l=n.children;nr(l,f=>{e.visibleWrites=Ox(e.visibleWrites,St(n.path,f))})}return!0}else return!1}function WI(e,r){if(e.snap)return kn(e.path,r);for(let t in e.children)if(e.children.hasOwnProperty(t)&&kn(St(e.path,t),r))return!0;return!1}function HI(e){e.visibleWrites=Tv(e.allWrites,VI,ct()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function VI(e){return e.visible}function Tv(e,r,t){let n=Vn.empty();for(let i=0;i<e.length;++i){let a=e[i];if(r(a)){let o=a.path,l;if(a.snap)kn(t,o)?(l=Lr(t,o),n=Qo(n,l,a.snap)):kn(o,t)&&(l=Lr(o,t),n=Qo(n,ct(),a.snap.getChild(l)));else if(a.children){if(kn(t,o))l=Lr(t,o),n=gh(n,l,a.children);else if(kn(o,t))if(l=Lr(o,t),Ye(l))n=gh(n,ct(),a.children);else{let f=Zi(a.children,Ke(l));if(f){let d=f.getChild(xt(l));n=Qo(n,ct(),d)}}}else throw Ds("WriteRecord should have .snap or .children")}}return n}function kv(e,r,t,n,i){if(!n&&!i){let a=Va(e.visibleWrites,r);if(a!=null)return a;{let o=na(e.visibleWrites,r);if(xh(o))return t;if(t==null&&!_h(o,ct()))return null;{let l=t||We.EMPTY_NODE;return js(o,l)}}}else{let a=na(e.visibleWrites,r);if(!i&&xh(a))return t;if(!i&&t==null&&!_h(a,ct()))return null;{let o=function(d){return(d.visible||i)&&(!n||!~n.indexOf(d.writeId))&&(kn(d.path,r)||kn(r,d.path))},l=Tv(e.allWrites,o,r),f=t||We.EMPTY_NODE;return js(l,f)}}}function zI(e,r,t){let n=We.EMPTY_NODE,i=Va(e.visibleWrites,r);if(i)return i.isLeafNode()||i.forEachChild(bt,(a,o)=>{n=n.updateImmediateChild(a,o)}),n;if(t){let a=na(e.visibleWrites,r);return t.forEachChild(bt,(o,l)=>{let f=js(na(a,new lt(o)),l);n=n.updateImmediateChild(o,f)}),Px(a).forEach(o=>{n=n.updateImmediateChild(o.name,o.node)}),n}else{let a=na(e.visibleWrites,r);return Px(a).forEach(o=>{n=n.updateImmediateChild(o.name,o.node)}),n}}function GI(e,r,t,n,i){de(n||i,"Either existingEventSnap or existingServerSnap must exist");let a=St(r,t);if(_h(e.visibleWrites,a))return null;{let o=na(e.visibleWrites,a);return xh(o)?i.getChild(t):js(o,i.getChild(t))}}function XI(e,r,t,n){let i=St(r,t),a=Va(e.visibleWrites,i);if(a!=null)return a;if(n.isCompleteForChild(t)){let o=na(e.visibleWrites,i);return js(o,n.getNode().getImmediateChild(t))}else return null}function $I(e,r){return Va(e.visibleWrites,r)}function jI(e,r,t,n,i,a,o){let l,f=na(e.visibleWrites,r),d=Va(f,ct());if(d!=null)l=d;else if(t!=null)l=js(f,t);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){let h=[],p=o.getCompare(),g=a?l.getReverseIteratorFrom(n,o):l.getIteratorFrom(n,o),x=g.getNext();for(;x&&h.length<i;)p(x,n)!==0&&h.push(x),x=g.getNext();return h}else return[]}function KI(){return{visibleWrites:Vn.empty(),allWrites:[],lastWriteId:-1}}function Tf(e,r,t,n){return kv(e.writeTree,e.treePath,r,t,n)}function rm(e,r){return zI(e.writeTree,e.treePath,r)}function Lx(e,r,t,n){return GI(e.writeTree,e.treePath,r,t,n)}function kf(e,r){return $I(e.writeTree,St(e.treePath,r))}function YI(e,r,t,n,i,a){return jI(e.writeTree,e.treePath,r,t,n,i,a)}function nm(e,r,t){return XI(e.writeTree,e.treePath,r,t)}function Sv(e,r){return Av(St(e.treePath,r),e.writeTree)}function Av(e,r){return{treePath:e,writeTree:r}}var vh=class{constructor(){this.changeMap=new Map}trackChildChange(r){let t=r.type,n=r.childName;de(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),de(n!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(n);if(i){let a=i.type;if(t==="child_added"&&a==="child_removed")this.changeMap.set(n,nc(n,r.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&a==="child_added")this.changeMap.delete(n);else if(t==="child_removed"&&a==="child_changed")this.changeMap.set(n,rc(n,i.oldSnap));else if(t==="child_changed"&&a==="child_added")this.changeMap.set(n,Xs(n,r.snapshotNode));else if(t==="child_changed"&&a==="child_changed")this.changeMap.set(n,nc(n,r.snapshotNode,i.oldSnap));else throw Ds("Illegal combination of changes: "+r+" occurred after "+i)}else this.changeMap.set(n,r)}getChanges(){return Array.from(this.changeMap.values())}};var bh=class{getCompleteChild(r){return null}getChildAfterChild(r,t,n){return null}},Cv=new bh,oc=class{constructor(r,t,n=null){this.writes_=r,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(r){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(r))return t.getNode().getImmediateChild(r);{let n=this.optCompleteServerCache_!=null?new si(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return nm(this.writes_,r,n)}}getChildAfterChild(r,t,n){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Wa(this.viewCache_),a=YI(this.writes_,i,t,1,n,r);return a.length===0?null:a[0]}};function qI(e){return{filter:e}}function QI(e,r){de(r.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),de(r.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function JI(e,r,t,n,i){let a=new vh,o,l;if(t.type===ni.OVERWRITE){let d=t;d.source.fromUser?o=wh(e,r,d.path,d.snap,n,i,a):(de(d.source.fromServer,"Unknown source."),l=d.source.tagged||r.serverCache.isFiltered()&&!Ye(d.path),o=Sf(e,r,d.path,d.snap,n,i,l,a))}else if(t.type===ni.MERGE){let d=t;d.source.fromUser?o=e3(e,r,d.path,d.children,n,i,a):(de(d.source.fromServer,"Unknown source."),l=d.source.tagged||r.serverCache.isFiltered(),o=yh(e,r,d.path,d.children,n,i,l,a))}else if(t.type===ni.ACK_USER_WRITE){let d=t;d.revert?o=n3(e,r,d.path,n,i,a):o=t3(e,r,d.path,d.affectedTree,n,i,a)}else if(t.type===ni.LISTEN_COMPLETE)o=r3(e,r,t.path,n,a);else throw Ds("Unknown operation type: "+t.type);let f=a.getChanges();return ZI(r,o,f),{viewCache:o,changes:f}}function ZI(e,r,t){let n=r.eventCache;if(n.isFullyInitialized()){let i=n.getNode().isLeafNode()||n.getNode().isEmpty(),a=Ef(e);(t.length>0||!e.eventCache.isFullyInitialized()||i&&!n.getNode().equals(a)||!n.getNode().getPriority().equals(a.getPriority()))&&t.push(wv(Ef(r)))}}function Fv(e,r,t,n,i,a){let o=r.eventCache;if(kf(n,t)!=null)return r;{let l,f;if(Ye(t))if(de(r.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),r.serverCache.isFiltered()){let d=Wa(r),h=d instanceof We?d:We.EMPTY_NODE,p=rm(n,h);l=e.filter.updateFullNode(r.eventCache.getNode(),p,a)}else{let d=Tf(n,Wa(r));l=e.filter.updateFullNode(r.eventCache.getNode(),d,a)}else{let d=Ke(t);if(d===".priority"){de(sa(t)===1,"Can't have a priority with additional path components");let h=o.getNode();f=r.serverCache.getNode();let p=Lx(n,t,h,f);p!=null?l=e.filter.updatePriority(h,p):l=o.getNode()}else{let h=xt(t),p;if(o.isCompleteForChild(d)){f=r.serverCache.getNode();let g=Lx(n,t,o.getNode(),f);g!=null?p=o.getNode().getImmediateChild(d).updateChild(h,g):p=o.getNode().getImmediateChild(d)}else p=nm(n,d,r.serverCache);p!=null?l=e.filter.updateChild(o.getNode(),d,p,h,i,a):l=o.getNode()}}return qo(r,l,o.isFullyInitialized()||Ye(t),e.filter.filtersNodes())}}function Sf(e,r,t,n,i,a,o,l){let f=r.serverCache,d,h=o?e.filter:e.filter.getIndexedFilter();if(Ye(t))d=h.updateFullNode(f.getNode(),n,null);else if(h.filtersNodes()&&!f.isFiltered()){let x=f.getNode().updateChild(t,n);d=h.updateFullNode(f.getNode(),x,null)}else{let x=Ke(t);if(!f.isCompleteForPath(t)&&sa(t)>1)return r;let v=xt(t),y=f.getNode().getImmediateChild(x).updateChild(v,n);x===".priority"?d=h.updatePriority(f.getNode(),y):d=h.updateChild(f.getNode(),x,y,v,Cv,null)}let p=yv(r,d,f.isFullyInitialized()||Ye(t),h.filtersNodes()),g=new oc(i,p,a);return Fv(e,p,t,i,g,l)}function wh(e,r,t,n,i,a,o){let l=r.eventCache,f,d,h=new oc(i,r,a);if(Ye(t))d=e.filter.updateFullNode(r.eventCache.getNode(),n,o),f=qo(r,d,!0,e.filter.filtersNodes());else{let p=Ke(t);if(p===".priority")d=e.filter.updatePriority(r.eventCache.getNode(),n),f=qo(r,d,l.isFullyInitialized(),l.isFiltered());else{let g=xt(t),x=l.getNode().getImmediateChild(p),v;if(Ye(g))v=n;else{let _=h.getCompleteChild(p);_!=null?Kh(g)===".priority"&&_.getChild(pv(g)).isEmpty()?v=_:v=_.updateChild(g,n):v=We.EMPTY_NODE}if(x.equals(v))f=r;else{let _=e.filter.updateChild(l.getNode(),p,v,g,h,o);f=qo(r,_,l.isFullyInitialized(),e.filter.filtersNodes())}}}return f}function Mx(e,r){return e.eventCache.isCompleteForChild(r)}function e3(e,r,t,n,i,a,o){let l=r;return n.foreach((f,d)=>{let h=St(t,f);Mx(r,Ke(h))&&(l=wh(e,l,h,d,i,a,o))}),n.foreach((f,d)=>{let h=St(t,f);Mx(r,Ke(h))||(l=wh(e,l,h,d,i,a,o))}),l}function Bx(e,r,t){return t.foreach((n,i)=>{r=r.updateChild(n,i)}),r}function yh(e,r,t,n,i,a,o,l){if(r.serverCache.getNode().isEmpty()&&!r.serverCache.isFullyInitialized())return r;let f=r,d;Ye(t)?d=n:d=new Mr(null).setTree(t,n);let h=r.serverCache.getNode();return d.children.inorderTraversal((p,g)=>{if(h.hasChild(p)){let x=r.serverCache.getNode().getImmediateChild(p),v=Bx(e,x,g);f=Sf(e,f,new lt(p),v,i,a,o,l)}}),d.children.inorderTraversal((p,g)=>{let x=!r.serverCache.isCompleteForChild(p)&&g.value===null;if(!h.hasChild(p)&&!x){let v=r.serverCache.getNode().getImmediateChild(p),_=Bx(e,v,g);f=Sf(e,f,new lt(p),_,i,a,o,l)}}),f}function t3(e,r,t,n,i,a,o){if(kf(i,t)!=null)return r;let l=r.serverCache.isFiltered(),f=r.serverCache;if(n.value!=null){if(Ye(t)&&f.isFullyInitialized()||f.isCompleteForPath(t))return Sf(e,r,t,f.getNode().getChild(t),i,a,l,o);if(Ye(t)){let d=new Mr(null);return f.getNode().forEachChild(ii,(h,p)=>{d=d.set(new lt(h),p)}),yh(e,r,t,d,i,a,l,o)}else return r}else{let d=new Mr(null);return n.foreach((h,p)=>{let g=St(t,h);f.isCompleteForPath(g)&&(d=d.set(h,f.getNode().getChild(g)))}),yh(e,r,t,d,i,a,l,o)}}function r3(e,r,t,n,i){let a=r.serverCache,o=yv(r,a.getNode(),a.isFullyInitialized()||Ye(t),a.isFiltered());return Fv(e,o,t,n,Cv,i)}function n3(e,r,t,n,i,a){let o;if(kf(n,t)!=null)return r;{let l=new oc(n,r,i),f=r.eventCache.getNode(),d;if(Ye(t)||Ke(t)===".priority"){let h;if(r.serverCache.isFullyInitialized())h=Tf(n,Wa(r));else{let p=r.serverCache.getNode();de(p instanceof We,"serverChildren would be complete if leaf node"),h=rm(n,p)}h=h,d=e.filter.updateFullNode(f,h,a)}else{let h=Ke(t),p=nm(n,h,r.serverCache);p==null&&r.serverCache.isCompleteForChild(h)&&(p=f.getImmediateChild(h)),p!=null?d=e.filter.updateChild(f,h,p,xt(t),l,a):r.eventCache.getNode().hasChild(h)?d=e.filter.updateChild(f,h,We.EMPTY_NODE,xt(t),l,a):d=f,d.isEmpty()&&r.serverCache.isFullyInitialized()&&(o=Tf(n,Wa(r)),o.isLeafNode()&&(d=e.filter.updateFullNode(d,o,a)))}return o=r.serverCache.isFullyInitialized()||kf(n,ct())!=null,qo(r,d,o,e.filter.filtersNodes())}}var Eh=class{constructor(r,t){this.query_=r,this.eventRegistrations_=[];let n=this.query_._queryParams,i=new ic(n.getIndex()),a=TI(n);this.processor_=qI(a);let o=t.serverCache,l=t.eventCache,f=i.updateFullNode(We.EMPTY_NODE,o.getNode(),null),d=a.updateFullNode(We.EMPTY_NODE,l.getNode(),null),h=new si(f,o.isFullyInitialized(),i.filtersNodes()),p=new si(d,l.isFullyInitialized(),a.filtersNodes());this.viewCache_=Wf(p,h),this.eventGenerator_=new ph(this.query_)}get query(){return this.query_}};function i3(e){return e.viewCache_.serverCache.getNode()}function a3(e){return Ef(e.viewCache_)}function s3(e,r){let t=Wa(e.viewCache_);return t&&(e.query._queryParams.loadsAllData()||!Ye(r)&&!t.getImmediateChild(Ke(r)).isEmpty())?t.getChild(r):null}function Ux(e){return e.eventRegistrations_.length===0}function o3(e,r){e.eventRegistrations_.push(r)}function Wx(e,r,t){let n=[];if(t){de(r==null,"A cancel should cancel all event registrations.");let i=e.query._path;e.eventRegistrations_.forEach(a=>{let o=a.createCancelEvent(t,i);o&&n.push(o)})}if(r){let i=[];for(let a=0;a<e.eventRegistrations_.length;++a){let o=e.eventRegistrations_[a];if(!o.matches(r))i.push(o);else if(r.hasAnyCallback()){i=i.concat(e.eventRegistrations_.slice(a+1));break}}e.eventRegistrations_=i}else e.eventRegistrations_=[];return n}function Hx(e,r,t,n){r.type===ni.MERGE&&r.source.queryId!==null&&(de(Wa(e.viewCache_),"We should always have a full cache before handling merges"),de(Ef(e.viewCache_),"Missing event cache, even though we have a server cache"));let i=e.viewCache_,a=JI(e.processor_,i,r,t,n);return QI(e.processor_,a.viewCache),de(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=a.viewCache,Iv(e,a.changes,a.viewCache.eventCache.getNode(),null)}function c3(e,r){let t=e.viewCache_.eventCache,n=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(bt,(a,o)=>{n.push(Xs(a,o))}),t.isFullyInitialized()&&n.push(wv(t.getNode())),Iv(e,n,t.getNode(),r)}function Iv(e,r,t,n){let i=n?[n]:e.eventRegistrations_;return NI(e.eventGenerator_,r,t,i)}var Af,Cf=class{constructor(){this.views=new Map}};function l3(e){de(!Af,"__referenceConstructor has already been defined"),Af=e}function f3(){return de(Af,"Reference.ts has not been loaded"),Af}function u3(e){return e.views.size===0}function im(e,r,t,n){let i=r.source.queryId;if(i!==null){let a=e.views.get(i);return de(a!=null,"SyncTree gave us an op for an invalid query."),Hx(a,r,t,n)}else{let a=[];for(let o of e.views.values())a=a.concat(Hx(o,r,t,n));return a}}function Rv(e,r,t,n,i){let a=r._queryIdentifier,o=e.views.get(a);if(!o){let l=Tf(t,i?n:null),f=!1;l?f=!0:n instanceof We?(l=rm(t,n),f=!1):(l=We.EMPTY_NODE,f=!1);let d=Wf(new si(l,f,!1),new si(n,i,!1));return new Eh(r,d)}return o}function d3(e,r,t,n,i,a){let o=Rv(e,r,n,i,a);return e.views.has(r._queryIdentifier)||e.views.set(r._queryIdentifier,o),o3(o,t),c3(o,t)}function h3(e,r,t,n){let i=r._queryIdentifier,a=[],o=[],l=oa(e);if(i==="default")for(let[f,d]of e.views.entries())o=o.concat(Wx(d,t,n)),Ux(d)&&(e.views.delete(f),d.query._queryParams.loadsAllData()||a.push(d.query));else{let f=e.views.get(i);f&&(o=o.concat(Wx(f,t,n)),Ux(f)&&(e.views.delete(i),f.query._queryParams.loadsAllData()||a.push(f.query)))}return l&&!oa(e)&&a.push(new(f3())(r._repo,r._path)),{removed:a,events:o}}function Nv(e){let r=[];for(let t of e.views.values())t.query._queryParams.loadsAllData()||r.push(t);return r}function ia(e,r){let t=null;for(let n of e.views.values())t=t||s3(n,r);return t}function Dv(e,r){if(r._queryParams.loadsAllData())return Vf(e);{let n=r._queryIdentifier;return e.views.get(n)}}function Ov(e,r){return Dv(e,r)!=null}function oa(e){return Vf(e)!=null}function Vf(e){for(let r of e.views.values())if(r.query._queryParams.loadsAllData())return r;return null}var Ff;function m3(e){de(!Ff,"__referenceConstructor has already been defined"),Ff=e}function p3(){return de(Ff,"Reference.ts has not been loaded"),Ff}var g3=1,If=class{constructor(r){this.listenProvider_=r,this.syncPointTree_=new Mr(null),this.pendingWriteTree_=KI(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function am(e,r,t,n,i){return LI(e.pendingWriteTree_,r,t,n,i),i?Js(e,new $s(Zh(),r,t)):[]}function _3(e,r,t,n){MI(e.pendingWriteTree_,r,t,n);let i=Mr.fromObject(t);return Js(e,new sc(Zh(),r,i))}function ra(e,r,t=!1){let n=BI(e.pendingWriteTree_,r);if(UI(e.pendingWriteTree_,r)){let a=new Mr(null);return n.snap!=null?a=a.set(ct(),!0):nr(n.children,o=>{a=a.set(new lt(o),!0)}),Js(e,new mh(n.path,a,t))}else return[]}function gc(e,r,t){return Js(e,new $s(em(),r,t))}function x3(e,r,t){let n=Mr.fromObject(t);return Js(e,new sc(em(),r,n))}function v3(e,r){return Js(e,new yf(em(),r))}function b3(e,r,t){let n=sm(e,t);if(n){let i=om(n),a=i.path,o=i.queryId,l=Lr(a,r),f=new yf(tm(o),l);return cm(e,a,f)}else return[]}function Rf(e,r,t,n,i=!1){let a=r._path,o=e.syncPointTree_.get(a),l=[];if(o&&(r._queryIdentifier==="default"||Ov(o,r))){let f=h3(o,r,t,n);u3(o)&&(e.syncPointTree_=e.syncPointTree_.remove(a));let d=f.removed;if(l=f.events,!i){let h=d.findIndex(g=>g._queryParams.loadsAllData())!==-1,p=e.syncPointTree_.findOnPath(a,(g,x)=>oa(x));if(h&&!p){let g=e.syncPointTree_.subtree(a);if(!g.isEmpty()){let x=E3(g);for(let v=0;v<x.length;++v){let _=x[v],y=_.query,N=Bv(e,_);e.listenProvider_.startListening(Jo(y),cc(e,y),N.hashFn,N.onComplete)}}}!p&&d.length>0&&!n&&(h?e.listenProvider_.stopListening(Jo(r),null):d.forEach(g=>{let x=e.queryToTagMap.get(Gf(g));e.listenProvider_.stopListening(Jo(g),x)}))}T3(e,d)}return l}function Pv(e,r,t,n){let i=sm(e,n);if(i!=null){let a=om(i),o=a.path,l=a.queryId,f=Lr(o,r),d=new $s(tm(l),f,t);return cm(e,o,d)}else return[]}function w3(e,r,t,n){let i=sm(e,n);if(i){let a=om(i),o=a.path,l=a.queryId,f=Lr(o,r),d=Mr.fromObject(t),h=new sc(tm(l),f,d);return cm(e,o,h)}else return[]}function Th(e,r,t,n=!1){let i=r._path,a=null,o=!1;e.syncPointTree_.foreachOnPath(i,(g,x)=>{let v=Lr(g,i);a=a||ia(x,v),o=o||oa(x)});let l=e.syncPointTree_.get(i);l?(o=o||oa(l),a=a||ia(l,ct())):(l=new Cf,e.syncPointTree_=e.syncPointTree_.set(i,l));let f;a!=null?f=!0:(f=!1,a=We.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild((x,v)=>{let _=ia(v,ct());_&&(a=a.updateImmediateChild(x,_))}));let d=Ov(l,r);if(!d&&!r._queryParams.loadsAllData()){let g=Gf(r);de(!e.queryToTagMap.has(g),"View does not exist, but we have a tag");let x=k3();e.queryToTagMap.set(g,x),e.tagToQueryMap.set(x,g)}let h=Hf(e.pendingWriteTree_,i),p=d3(l,r,t,h,a,f);if(!d&&!o&&!n){let g=Dv(l,r);p=p.concat(S3(e,r,g))}return p}function zf(e,r,t){let i=e.pendingWriteTree_,a=e.syncPointTree_.findOnPath(r,(o,l)=>{let f=Lr(o,r),d=ia(l,f);if(d)return d});return kv(i,r,a,t,!0)}function y3(e,r){let t=r._path,n=null;e.syncPointTree_.foreachOnPath(t,(d,h)=>{let p=Lr(d,t);n=n||ia(h,p)});let i=e.syncPointTree_.get(t);i?n=n||ia(i,ct()):(i=new Cf,e.syncPointTree_=e.syncPointTree_.set(t,i));let a=n!=null,o=a?new si(n,!0,!1):null,l=Hf(e.pendingWriteTree_,r._path),f=Rv(i,r,l,a?o.getNode():We.EMPTY_NODE,a);return a3(f)}function Js(e,r){return Lv(r,e.syncPointTree_,null,Hf(e.pendingWriteTree_,ct()))}function Lv(e,r,t,n){if(Ye(e.path))return Mv(e,r,t,n);{let i=r.get(ct());t==null&&i!=null&&(t=ia(i,ct()));let a=[],o=Ke(e.path),l=e.operationForChild(o),f=r.children.get(o);if(f&&l){let d=t?t.getImmediateChild(o):null,h=Sv(n,o);a=a.concat(Lv(l,f,d,h))}return i&&(a=a.concat(im(i,e,n,t))),a}}function Mv(e,r,t,n){let i=r.get(ct());t==null&&i!=null&&(t=ia(i,ct()));let a=[];return r.children.inorderTraversal((o,l)=>{let f=t?t.getImmediateChild(o):null,d=Sv(n,o),h=e.operationForChild(o);h&&(a=a.concat(Mv(h,l,f,d)))}),i&&(a=a.concat(im(i,e,n,t))),a}function Bv(e,r){let t=r.query,n=cc(e,t);return{hashFn:()=>(i3(r)||We.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return n?b3(e,t._path,n):v3(e,t._path);{let a=LF(i,t);return Rf(e,t,null,a)}}}}function cc(e,r){let t=Gf(r);return e.queryToTagMap.get(t)}function Gf(e){return e._path.toString()+"$"+e._queryIdentifier}function sm(e,r){return e.tagToQueryMap.get(r)}function om(e){let r=e.indexOf("$");return de(r!==-1&&r<e.length-1,"Bad queryKey."),{queryId:e.substr(r+1),path:new lt(e.substr(0,r))}}function cm(e,r,t){let n=e.syncPointTree_.get(r);de(n,"Missing sync point for query tag that we're tracking");let i=Hf(e.pendingWriteTree_,r);return im(n,t,i,null)}function E3(e){return e.fold((r,t,n)=>{if(t&&oa(t))return[Vf(t)];{let i=[];return t&&(i=Nv(t)),nr(n,(a,o)=>{i=i.concat(o)}),i}})}function Jo(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(p3())(e._repo,e._path):e}function T3(e,r){for(let t=0;t<r.length;++t){let n=r[t];if(!n._queryParams.loadsAllData()){let i=Gf(n),a=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(a)}}}function k3(){return g3++}function S3(e,r,t){let n=r._path,i=cc(e,r),a=Bv(e,t),o=e.listenProvider_.startListening(Jo(r),i,a.hashFn,a.onComplete),l=e.syncPointTree_.subtree(n);if(i)de(!oa(l.value),"If we're adding a query, it shouldn't be shadowed");else{let f=l.fold((d,h,p)=>{if(!Ye(d)&&h&&oa(h))return[Vf(h).query];{let g=[];return h&&(g=g.concat(Nv(h).map(x=>x.query))),nr(p,(x,v)=>{g=g.concat(v)}),g}});for(let d=0;d<f.length;++d){let h=f[d];e.listenProvider_.stopListening(Jo(h),cc(e,h))}}return o}var kh=class e{constructor(r){this.node_=r}getImmediateChild(r){let t=this.node_.getImmediateChild(r);return new e(t)}node(){return this.node_}},Sh=class e{constructor(r,t){this.syncTree_=r,this.path_=t}getImmediateChild(r){let t=St(this.path_,r);return new e(this.syncTree_,t)}node(){return zf(this.syncTree_,this.path_)}},A3=function(e){return e=e||{},e.timestamp=e.timestamp||new Date().getTime(),e},Vx=function(e,r,t){if(!e||typeof e!="object")return e;if(de(".sv"in e,"Unexpected leaf node or priority contents"),typeof e[".sv"]=="string")return C3(e[".sv"],r,t);if(typeof e[".sv"]=="object")return F3(e[".sv"],r);de(!1,"Unexpected server value: "+JSON.stringify(e,null,2))},C3=function(e,r,t){switch(e){case"timestamp":return t.timestamp;default:de(!1,"Unexpected server value: "+e)}},F3=function(e,r,t){e.hasOwnProperty("increment")||de(!1,"Unexpected server value: "+JSON.stringify(e,null,2));let n=e.increment;typeof n!="number"&&de(!1,"Unexpected increment value: "+n);let i=r.node();if(de(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;let o=i.getValue();return typeof o!="number"?n:o+n},Uv=function(e,r,t,n){return fm(r,new Sh(t,e),n)},lm=function(e,r,t){return fm(e,new kh(r),t)};function fm(e,r,t){let n=e.getPriority().val(),i=Vx(n,r.getImmediateChild(".priority"),t),a;if(e.isLeafNode()){let o=e,l=Vx(o.getValue(),r,t);return l!==o.getValue()||i!==o.getPriority().val()?new zs(l,Rt(i)):e}else{let o=e;return a=o,i!==o.getPriority().val()&&(a=a.updatePriority(new zs(i))),o.forEachChild(bt,(l,f)=>{let d=fm(f,r.getImmediateChild(l),t);d!==f&&(a=a.updateImmediateChild(l,d))}),a}}var lc=class{constructor(r="",t=null,n={children:{},childCount:0}){this.name=r,this.parent=t,this.node=n}};function Xf(e,r){let t=r instanceof lt?r:new lt(r),n=e,i=Ke(t);for(;i!==null;){let a=Zi(n.node.children,i)||{children:{},childCount:0};n=new lc(i,n,a),t=xt(t),i=Ke(t)}return n}function za(e){return e.node.value}function um(e,r){e.node.value=r,Ah(e)}function Wv(e){return e.node.childCount>0}function I3(e){return za(e)===void 0&&!Wv(e)}function $f(e,r){nr(e.node.children,(t,n)=>{r(new lc(t,e,n))})}function Hv(e,r,t,n){t&&!n&&r(e),$f(e,i=>{Hv(i,r,!0,n)}),t&&n&&r(e)}function R3(e,r,t){let n=t?e:e.parent;for(;n!==null;){if(r(n))return!0;n=n.parent}return!1}function _c(e){return new lt(e.parent===null?e.name:_c(e.parent)+"/"+e.name)}function Ah(e){e.parent!==null&&N3(e.parent,e.name,e)}function N3(e,r,t){let n=I3(t),i=Tn(e.node.children,r);n&&i?(delete e.node.children[r],e.node.childCount--,Ah(e)):!n&&!i&&(e.node.children[r]=t.node,e.node.childCount++,Ah(e))}var D3=/[\[\].#$\/\u0000-\u001F\u007F]/,O3=/[\[\].#$\u0000-\u001F\u007F]/,Bd=10*1024*1024,jf=function(e){return typeof e=="string"&&e.length!==0&&!D3.test(e)},Vv=function(e){return typeof e=="string"&&e.length!==0&&!O3.test(e)},P3=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Vv(e)},fc=function(e){return e===null||typeof e=="string"||typeof e=="number"&&!Bf(e)||e&&typeof e=="object"&&Tn(e,".sv")},oi=function(e,r,t,n){n&&r===void 0||xc(Qr(e,"value"),r,t)},xc=function(e,r,t){let n=t instanceof lt?new Qd(t,e):t;if(r===void 0)throw new Error(e+"contains undefined "+Ma(n));if(typeof r=="function")throw new Error(e+"contains a function "+Ma(n)+" with contents = "+r.toString());if(Bf(r))throw new Error(e+"contains "+r.toString()+" "+Ma(n));if(typeof r=="string"&&r.length>Bd/3&&Uo(r)>Bd)throw new Error(e+"contains a string greater than "+Bd+" utf8 bytes "+Ma(n)+" ('"+r.substring(0,50)+"...')");if(r&&typeof r=="object"){let i=!1,a=!1;if(nr(r,(o,l)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(a=!0,!jf(o)))throw new Error(e+" contains an invalid key ("+o+") "+Ma(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);uI(n,o),xc(e,l,n),dI(n)}),i&&a)throw new Error(e+' contains ".value" child '+Ma(n)+" in addition to actual children.")}},L3=function(e,r){let t,n;for(t=0;t<r.length;t++){n=r[t];let a=ec(n);for(let o=0;o<a.length;o++)if(!(a[o]===".priority"&&o===a.length-1)){if(!jf(a[o]))throw new Error(e+"contains an invalid key ("+a[o]+") in path "+n.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}r.sort(fI);let i=null;for(t=0;t<r.length;t++){if(n=r[t],i!==null&&kn(i,n))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+n.toString());i=n}},zv=function(e,r,t,n){if(n&&r===void 0)return;let i=Qr(e,"values");if(!(r&&typeof r=="object")||Array.isArray(r))throw new Error(i+" must be an object containing the children to replace.");let a=[];nr(r,(o,l)=>{let f=new lt(o);if(xc(i,l,St(t,f)),Kh(f)===".priority"&&!fc(l))throw new Error(i+"contains an invalid value for '"+f.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(f)}),L3(i,a)},dm=function(e,r,t){if(!(t&&r===void 0)){if(Bf(r))throw new Error(Qr(e,"priority")+"is "+r.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!fc(r))throw new Error(Qr(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},vc=function(e,r,t,n){if(!(n&&t===void 0)&&!jf(t))throw new Error(Qr(e,r)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Zs=function(e,r,t,n){if(!(n&&t===void 0)&&!Vv(t))throw new Error(Qr(e,r)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},M3=function(e,r,t,n){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Zs(e,r,t,n)},cn=function(e,r){if(Ke(r)===".info")throw new Error(e+" failed = Can't modify data under /.info/")},Gv=function(e,r){let t=r.path.toString();if(typeof r.repoInfo.host!="string"||r.repoInfo.host.length===0||!jf(r.repoInfo.namespace)&&r.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!P3(t))throw new Error(Qr(e,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Ch=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Kf(e,r){let t=null;for(let n=0;n<r.length;n++){let i=r[n],a=i.getPath();t!==null&&!Yh(a,t.path)&&(e.eventLists_.push(t),t=null),t===null&&(t={events:[],path:a}),t.events.push(i)}t&&e.eventLists_.push(t)}function Xv(e,r,t){Kf(e,t),$v(e,n=>Yh(n,r))}function ln(e,r,t){Kf(e,t),$v(e,n=>kn(n,r)||kn(r,n))}function $v(e,r){e.recursionDepth_++;let t=!0;for(let n=0;n<e.eventLists_.length;n++){let i=e.eventLists_[n];if(i){let a=i.path;r(a)?(B3(e.eventLists_[n]),e.eventLists_[n]=null):t=!1}}t&&(e.eventLists_=[]),e.recursionDepth_--}function B3(e){for(let r=0;r<e.events.length;r++){let t=e.events[r];if(t!==null){e.events[r]=null;let n=t.getEventRunner();Ua&&rr("event: "+t.toString()),qs(n)}}}var jv="repo_interrupt",U3=25,Fh=class{constructor(r,t,n,i){this.repoInfo_=r,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ch,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=wf(),this.transactionQueueTree_=new lc,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function W3(e,r,t){if(e.stats_=jh(e.repoInfo_),e.forceRestClient_||WF())e.server_=new ch(e.repoInfo_,(n,i,a,o)=>{zx(e,n,i,a,o)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>Gx(e,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ut(t)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}e.persistentConnection_=new qh(e.repoInfo_,r,(n,i,a,o)=>{zx(e,n,i,a,o)},n=>{Gx(e,n)},n=>{H3(e,n)},e.authTokenProvider_,e.appCheckProvider_,t),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(n=>{e.server_.refreshAuthToken(n)}),e.appCheckProvider_.addTokenChangeListener(n=>{e.server_.refreshAppCheckToken(n.token)}),e.statsReporter_=VF(e.repoInfo_,()=>new hh(e.stats_,e.server_)),e.infoData_=new lh,e.infoSyncTree_=new If({startListening:(n,i,a,o)=>{let l=[],f=e.infoData_.getNode(n._path);return f.isEmpty()||(l=gc(e.infoSyncTree_,n._path,f),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),hm(e,"connected",!1),e.serverSyncTree_=new If({startListening:(n,i,a,o)=>(e.server_.listen(n,a,i,(l,f)=>{let d=o(l,f);ln(e.eventQueue_,n._path,d)}),[]),stopListening:(n,i)=>{e.server_.unlisten(n,i)}})}function Kv(e){let t=e.infoData_.getNode(new lt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function bc(e){return A3({timestamp:Kv(e)})}function zx(e,r,t,n,i){e.dataUpdateCount++;let a=new lt(r);t=e.interceptServerDataCallback_?e.interceptServerDataCallback_(r,t):t;let o=[];if(i)if(n){let f=Bo(t,d=>Rt(d));o=w3(e.serverSyncTree_,a,f,i)}else{let f=Rt(t);o=Pv(e.serverSyncTree_,a,f,i)}else if(n){let f=Bo(t,d=>Rt(d));o=x3(e.serverSyncTree_,a,f)}else{let f=Rt(t);o=gc(e.serverSyncTree_,a,f)}let l=a;o.length>0&&(l=Ks(e,a)),ln(e.eventQueue_,l,o)}function Gx(e,r){hm(e,"connected",r),r===!1&&G3(e)}function H3(e,r){nr(r,(t,n)=>{hm(e,t,n)})}function hm(e,r,t){let n=new lt("/.info/"+r),i=Rt(t);e.infoData_.updateSnapshot(n,i);let a=gc(e.infoSyncTree_,n,i);ln(e.eventQueue_,n,a)}function Yf(e){return e.nextWriteId_++}function V3(e,r,t){let n=y3(e.serverSyncTree_,r);return n!=null?Promise.resolve(n):e.server_.get(r).then(i=>{let a=Rt(i).withIndex(r._queryParams.getIndex());Th(e.serverSyncTree_,r,t,!0);let o;if(r._queryParams.loadsAllData())o=gc(e.serverSyncTree_,r._path,a);else{let l=cc(e.serverSyncTree_,r);o=Pv(e.serverSyncTree_,r._path,a,l)}return ln(e.eventQueue_,r._path,o),Rf(e.serverSyncTree_,r,t,null,!0),a},i=>(eo(e,"get for query "+Ut(r)+" failed: "+i),Promise.reject(new Error(i))))}function mm(e,r,t,n,i){eo(e,"set",{path:r.toString(),value:t,priority:n});let a=bc(e),o=Rt(t,n),l=zf(e.serverSyncTree_,r),f=lm(o,l,a),d=Yf(e),h=am(e.serverSyncTree_,r,f,d,!0);Kf(e.eventQueue_,h),e.server_.put(r.toString(),o.val(!0),(g,x)=>{let v=g==="ok";v||vr("set at "+r+" failed: "+g);let _=ra(e.serverSyncTree_,d,!v);ln(e.eventQueue_,r,_),ca(e,i,g,x)});let p=gm(e,r);Ks(e,p),ln(e.eventQueue_,p,[])}function z3(e,r,t,n){eo(e,"update",{path:r.toString(),value:t});let i=!0,a=bc(e),o={};if(nr(t,(l,f)=>{i=!1,o[l]=Uv(St(r,l),Rt(f),e.serverSyncTree_,a)}),i)rr("update() called with empty data.  Don't do anything."),ca(e,n,"ok",void 0);else{let l=Yf(e),f=_3(e.serverSyncTree_,r,o,l);Kf(e.eventQueue_,f),e.server_.merge(r.toString(),t,(d,h)=>{let p=d==="ok";p||vr("update at "+r+" failed: "+d);let g=ra(e.serverSyncTree_,l,!p),x=g.length>0?Ks(e,r):r;ln(e.eventQueue_,x,g),ca(e,n,d,h)}),nr(t,d=>{let h=gm(e,St(r,d));Ks(e,h)}),ln(e.eventQueue_,r,[])}}function G3(e){eo(e,"onDisconnectEvents");let r=bc(e),t=wf();uh(e.onDisconnect_,ct(),(i,a)=>{let o=Uv(i,a,e.serverSyncTree_,r);Qs(t,i,o)});let n=[];uh(t,ct(),(i,a)=>{n=n.concat(gc(e.serverSyncTree_,i,a));let o=gm(e,i);Ks(e,o)}),e.onDisconnect_=wf(),ln(e.eventQueue_,ct(),n)}function X3(e,r,t){e.server_.onDisconnectCancel(r.toString(),(n,i)=>{n==="ok"&&fh(e.onDisconnect_,r),ca(e,t,n,i)})}function Xx(e,r,t,n){let i=Rt(t);e.server_.onDisconnectPut(r.toString(),i.val(!0),(a,o)=>{a==="ok"&&Qs(e.onDisconnect_,r,i),ca(e,n,a,o)})}function $3(e,r,t,n,i){let a=Rt(t,n);e.server_.onDisconnectPut(r.toString(),a.val(!0),(o,l)=>{o==="ok"&&Qs(e.onDisconnect_,r,a),ca(e,i,o,l)})}function j3(e,r,t,n){if(tf(t)){rr("onDisconnect().update() called with empty data.  Don't do anything."),ca(e,n,"ok",void 0);return}e.server_.onDisconnectMerge(r.toString(),t,(i,a)=>{i==="ok"&&nr(t,(o,l)=>{let f=Rt(l);Qs(e.onDisconnect_,St(r,o),f)}),ca(e,n,i,a)})}function K3(e,r,t){let n;Ke(r._path)===".info"?n=Th(e.infoSyncTree_,r,t):n=Th(e.serverSyncTree_,r,t),Xv(e.eventQueue_,r._path,n)}function Ih(e,r,t){let n;Ke(r._path)===".info"?n=Rf(e.infoSyncTree_,r,t):n=Rf(e.serverSyncTree_,r,t),Xv(e.eventQueue_,r._path,n)}function Yv(e){e.persistentConnection_&&e.persistentConnection_.interrupt(jv)}function Y3(e){e.persistentConnection_&&e.persistentConnection_.resume(jv)}function eo(e,...r){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":"),rr(t,...r)}function ca(e,r,t,n){r&&qs(()=>{if(t==="ok")r(null);else{let i=(t||"error").toUpperCase(),a=i;n&&(a+=": "+n);let o=new Error(a);o.code=i,r(o)}})}function q3(e,r,t,n,i,a){eo(e,"transaction on "+r);let o={path:r,update:t,onComplete:n,status:null,order:Kx(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=pm(e,r,void 0);o.currentInputSnapshot=l;let f=o.update(l.val());if(f===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{xc("transaction failed: Data returned ",f,o.path),o.status=0;let d=Xf(e.transactionQueueTree_,r),h=za(d)||[];h.push(o),um(d,h);let p;typeof f=="object"&&f!==null&&Tn(f,".priority")?(p=Zi(f,".priority"),de(fc(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(zf(e.serverSyncTree_,r)||We.EMPTY_NODE).getPriority().val();let g=bc(e),x=Rt(f,p),v=lm(x,l,g);o.currentOutputSnapshotRaw=x,o.currentOutputSnapshotResolved=v,o.currentWriteId=Yf(e);let _=am(e.serverSyncTree_,r,v,o.currentWriteId,o.applyLocally);ln(e.eventQueue_,r,_),qf(e,e.transactionQueueTree_)}}function pm(e,r,t){return zf(e.serverSyncTree_,r,t)||We.EMPTY_NODE}function qf(e,r=e.transactionQueueTree_){if(r||Qf(e,r),za(r)){let t=Qv(e,r);de(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&Q3(e,_c(r),t)}else Wv(r)&&$f(r,t=>{qf(e,t)})}function Q3(e,r,t){let n=t.map(d=>d.currentWriteId),i=pm(e,r,n),a=i,o=i.hash();for(let d=0;d<t.length;d++){let h=t[d];de(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;let p=Lr(r,h.path);a=a.updateChild(p,h.currentOutputSnapshotRaw)}let l=a.val(!0),f=r;e.server_.put(f.toString(),l,d=>{eo(e,"transaction put response",{path:f.toString(),status:d});let h=[];if(d==="ok"){let p=[];for(let g=0;g<t.length;g++)t[g].status=2,h=h.concat(ra(e.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&p.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();Qf(e,Xf(e.transactionQueueTree_,r)),qf(e,e.transactionQueueTree_),ln(e.eventQueue_,r,h);for(let g=0;g<p.length;g++)qs(p[g])}else{if(d==="datastale")for(let p=0;p<t.length;p++)t[p].status===3?t[p].status=4:t[p].status=0;else{vr("transaction at "+f.toString()+" failed: "+d);for(let p=0;p<t.length;p++)t[p].status=4,t[p].abortReason=d}Ks(e,r)}},o)}function Ks(e,r){let t=qv(e,r),n=_c(t),i=Qv(e,t);return J3(e,i,n),n}function J3(e,r,t){if(r.length===0)return;let n=[],i=[],o=r.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<r.length;l++){let f=r[l],d=Lr(t,f.path),h=!1,p;if(de(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),f.status===4)h=!0,p=f.abortReason,i=i.concat(ra(e.serverSyncTree_,f.currentWriteId,!0));else if(f.status===0)if(f.retryCount>=U3)h=!0,p="maxretry",i=i.concat(ra(e.serverSyncTree_,f.currentWriteId,!0));else{let g=pm(e,f.path,o);f.currentInputSnapshot=g;let x=r[l].update(g.val());if(x!==void 0){xc("transaction failed: Data returned ",x,f.path);let v=Rt(x);typeof x=="object"&&x!=null&&Tn(x,".priority")||(v=v.updatePriority(g.getPriority()));let y=f.currentWriteId,N=bc(e),R=lm(v,g,N);f.currentOutputSnapshotRaw=v,f.currentOutputSnapshotResolved=R,f.currentWriteId=Yf(e),o.splice(o.indexOf(y),1),i=i.concat(am(e.serverSyncTree_,f.path,R,f.currentWriteId,f.applyLocally)),i=i.concat(ra(e.serverSyncTree_,y,!0))}else h=!0,p="nodata",i=i.concat(ra(e.serverSyncTree_,f.currentWriteId,!0))}ln(e.eventQueue_,t,i),i=[],h&&(r[l].status=2,function(g){setTimeout(g,Math.floor(0))}(r[l].unwatcher),r[l].onComplete&&(p==="nodata"?n.push(()=>r[l].onComplete(null,!1,r[l].currentInputSnapshot)):n.push(()=>r[l].onComplete(new Error(p),!1,null))))}Qf(e,e.transactionQueueTree_);for(let l=0;l<n.length;l++)qs(n[l]);qf(e,e.transactionQueueTree_)}function qv(e,r){let t,n=e.transactionQueueTree_;for(t=Ke(r);t!==null&&za(n)===void 0;)n=Xf(n,t),r=xt(r),t=Ke(r);return n}function Qv(e,r){let t=[];return Jv(e,r,t),t.sort((n,i)=>n.order-i.order),t}function Jv(e,r,t){let n=za(r);if(n)for(let i=0;i<n.length;i++)t.push(n[i]);$f(r,i=>{Jv(e,i,t)})}function Qf(e,r){let t=za(r);if(t){let n=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[n]=t[i],n++);t.length=n,um(r,t.length>0?t:void 0)}$f(r,n=>{Qf(e,n)})}function gm(e,r){let t=_c(qv(e,r)),n=Xf(e.transactionQueueTree_,r);return R3(n,i=>{Ud(e,i)}),Ud(e,n),Hv(n,i=>{Ud(e,i)}),t}function Ud(e,r){let t=za(r);if(t){let n=[],i=[],a=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(de(a===o-1,"All SENT items should be at beginning of queue."),a=o,t[o].status=3,t[o].abortReason="set"):(de(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(ra(e.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&n.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));a===-1?um(r,void 0):t.length=a+1,ln(e.eventQueue_,_c(r),i);for(let o=0;o<n.length;o++)qs(n[o])}}function Z3(e){let r="",t=e.split("/");for(let n=0;n<t.length;n++)if(t[n].length>0){let i=t[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}r+="/"+i}return r}function eR(e){let r={};e.charAt(0)==="?"&&(e=e.substring(1));for(let t of e.split("&")){if(t.length===0)continue;let n=t.split("=");n.length===2?r[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):vr(`Invalid query segment '${t}' in query '${e}'`)}return r}var Rh=function(e,r){let t=tR(e),n=t.namespace;t.domain==="firebase.com"&&ai(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&t.domain!=="localhost"&&ai("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||RF();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new hf(t.host,t.secure,n,i,r,"",n!==t.subdomain),path:new lt(t.pathString)}},tR=function(e){let r="",t="",n="",i="",a="",o=!0,l="https",f=443;if(typeof e=="string"){let d=e.indexOf("//");d>=0&&(l=e.substring(0,d-1),e=e.substring(d+2));let h=e.indexOf("/");h===-1&&(h=e.length);let p=e.indexOf("?");p===-1&&(p=e.length),r=e.substring(0,Math.min(h,p)),h<p&&(i=Z3(e.substring(h,p)));let g=eR(e.substring(Math.min(e.length,p)));d=r.indexOf(":"),d>=0?(o=l==="https"||l==="wss",f=parseInt(r.substring(d+1),10)):d=r.length;let x=r.slice(0,d);if(x.toLowerCase()==="localhost")t="localhost";else if(x.split(".").length<=2)t=x;else{let v=r.indexOf(".");n=r.substring(0,v).toLowerCase(),t=r.substring(v+1),a=n}"ns"in g&&(a=g.ns)}return{host:r,port:f,domain:t,subdomain:n,secure:o,scheme:l,pathString:i,namespace:a}};var $x="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",rR=function(){let e=0,r=[];return function(t){let n=t===e;e=t;let i,a=new Array(8);for(i=7;i>=0;i--)a[i]=$x.charAt(t%64),t=Math.floor(t/64);de(t===0,"Cannot push at time == 0");let o=a.join("");if(n){for(i=11;i>=0&&r[i]===63;i--)r[i]=0;r[i]++}else for(i=0;i<12;i++)r[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=$x.charAt(r[i]);return de(o.length===20,"nextPushId: Length should be 20."),o}}();var Nf=class{constructor(r,t,n,i){this.eventType=r,this.eventRegistration=t,this.snapshot=n,this.prevName=i}getPath(){let r=this.snapshot.ref;return this.eventType==="value"?r._path:r.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ut(this.snapshot.exportVal())}},Df=class{constructor(r,t,n){this.eventRegistration=r,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var uc=class{constructor(r,t){this.snapshotCallback=r,this.cancelCallback=t}onValue(r,t){this.snapshotCallback.call(null,r,t)}onCancel(r){return de(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,r)}get hasCancelCallback(){return!!this.cancelCallback}matches(r){return this.snapshotCallback===r.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===r.snapshotCallback.userCallback&&this.snapshotCallback.context===r.snapshotCallback.context}};var Of=class{constructor(r,t){this._repo=r,this._path=t}cancel(){let r=new tr;return X3(this._repo,this._path,r.wrapCallback(()=>{})),r.promise}remove(){cn("OnDisconnect.remove",this._path);let r=new tr;return Xx(this._repo,this._path,null,r.wrapCallback(()=>{})),r.promise}set(r){cn("OnDisconnect.set",this._path),oi("OnDisconnect.set",r,this._path,!1);let t=new tr;return Xx(this._repo,this._path,r,t.wrapCallback(()=>{})),t.promise}setWithPriority(r,t){cn("OnDisconnect.setWithPriority",this._path),oi("OnDisconnect.setWithPriority",r,this._path,!1),dm("OnDisconnect.setWithPriority",t,!1);let n=new tr;return $3(this._repo,this._path,r,t,n.wrapCallback(()=>{})),n.promise}update(r){cn("OnDisconnect.update",this._path),zv("OnDisconnect.update",r,this._path,!1);let t=new tr;return j3(this._repo,this._path,r,t.wrapCallback(()=>{})),t.promise}};var Br=class e{constructor(r,t,n,i){this._repo=r,this._path=t,this._queryParams=n,this._orderByCalled=i}get key(){return Ye(this._path)?null:Kh(this._path)}get ref(){return new fn(this._repo,this._path)}get _queryIdentifier(){let r=Nx(this._queryParams),t=$h(r);return t==="{}"?"default":t}get _queryObject(){return Nx(this._queryParams)}isEqual(r){if(r=Pr(r),!(r instanceof e))return!1;let t=this._repo===r._repo,n=Yh(this._path,r._path),i=this._queryIdentifier===r._queryIdentifier;return t&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+lI(this._path)}};function Jf(e,r){if(e._orderByCalled===!0)throw new Error(r+": You can't combine multiple orderBy calls.")}function fa(e){let r=null,t=null;if(e.hasStart()&&(r=e.getIndexStartValue()),e.hasEnd()&&(t=e.getIndexEndValue()),e.getIndex()===ii){let n="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==aa)throw new Error(n);if(typeof r!="string")throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==Ii)throw new Error(n);if(typeof t!="string")throw new Error(i)}}else if(e.getIndex()===bt){if(r!=null&&!fc(r)||t!=null&&!fc(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(de(e.getIndex()instanceof tc||e.getIndex()===Jh,"unknown index type."),r!=null&&typeof r=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Zf(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var fn=class e extends Br{constructor(r,t){super(r,t,new ac,!1)}get parent(){let r=pv(this._path);return r===null?null:new e(this._repo,r)}get root(){let r=this;for(;r.parent!==null;)r=r.parent;return r}},Ys=class e{constructor(r,t,n){this._node=r,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(r){let t=new lt(r),n=la(this.ref,r);return new e(this._node.getChild(t),n,bt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(r){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,i)=>r(new e(i,la(this.ref,n),bt)))}hasChild(r){let t=new lt(r);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function wc(e,r){return e=Pr(e),e._checkNotDeleted("ref"),r!==void 0?la(e._root,r):e._root}function _m(e,r){e=Pr(e),e._checkNotDeleted("refFromURL");let t=Rh(r,e._repo.repoInfo_.nodeAdmin);Gv("refFromURL",t);let n=t.repoInfo;return!e._repo.repoInfo_.isCustomHost()&&n.host!==e._repo.repoInfo_.host&&ai("refFromURL: Host name does not match the current database: (found "+n.host+" but expected "+e._repo.repoInfo_.host+")"),wc(e,t.path.toString())}function la(e,r){return e=Pr(e),Ke(e._path)===null?M3("child","path",r,!1):Zs("child","path",r,!1),new fn(e._repo,St(e._path,r))}function Zv(e,r){e=Pr(e),cn("push",e._path),oi("push",r,e._path,!0);let t=Kv(e._repo),n=rR(t),i=la(e,n),a=la(e,n),o;return r!=null?o=eu(a,r).then(()=>a):o=Promise.resolve(a),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function eb(e){return cn("remove",e._path),eu(e,null)}function eu(e,r){e=Pr(e),cn("set",e._path),oi("set",r,e._path,!1);let t=new tr;return mm(e._repo,e._path,r,null,t.wrapCallback(()=>{})),t.promise}function tb(e,r){e=Pr(e),cn("setPriority",e._path),dm("setPriority",r,!1);let t=new tr;return mm(e._repo,St(e._path,".priority"),r,null,t.wrapCallback(()=>{})),t.promise}function rb(e,r,t){if(cn("setWithPriority",e._path),oi("setWithPriority",r,e._path,!1),dm("setWithPriority",t,!1),e.key===".length"||e.key===".keys")throw"setWithPriority failed: "+e.key+" is a read-only object.";let n=new tr;return mm(e._repo,e._path,r,t,n.wrapCallback(()=>{})),n.promise}function nb(e,r){zv("update",r,e._path,!1);let t=new tr;return z3(e._repo,e._path,r,t.wrapCallback(()=>{})),t.promise}function tu(e){e=Pr(e);let r=new uc(()=>{}),t=new dc(r);return V3(e._repo,e,t).then(n=>new Ys(n,new fn(e._repo,e._path),e._queryParams.getIndex()))}var dc=class e{constructor(r){this.callbackContext=r}respondsTo(r){return r==="value"}createEvent(r,t){let n=t._queryParams.getIndex();return new Nf("value",this,new Ys(r.snapshotNode,new fn(t._repo,t._path),n))}getEventRunner(r){return r.getEventType()==="cancel"?()=>this.callbackContext.onCancel(r.error):()=>this.callbackContext.onValue(r.snapshot,null)}createCancelEvent(r,t){return this.callbackContext.hasCancelCallback?new Df(this,r,t):null}matches(r){return r instanceof e?!r.callbackContext||!this.callbackContext?!0:r.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Pf=class e{constructor(r,t){this.eventType=r,this.callbackContext=t}respondsTo(r){let t=r==="children_added"?"child_added":r;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(r,t){return this.callbackContext.hasCancelCallback?new Df(this,r,t):null}createEvent(r,t){de(r.childName!=null,"Child events should have a childName.");let n=la(new fn(t._repo,t._path),r.childName),i=t._queryParams.getIndex();return new Nf(r.type,this,new Ys(r.snapshotNode,n,i),r.prevName)}getEventRunner(r){return r.getEventType()==="cancel"?()=>this.callbackContext.onCancel(r.error):()=>this.callbackContext.onValue(r.snapshot,r.prevName)}matches(r){return r instanceof e?this.eventType===r.eventType&&(!this.callbackContext||!r.callbackContext||this.callbackContext.matches(r.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function yc(e,r,t,n,i){let a;if(typeof n=="object"&&(a=void 0,i=n),typeof n=="function"&&(a=n),i&&i.onlyOnce){let f=t,d=(h,p)=>{Ih(e._repo,e,l),f(h,p)};d.userCallback=t.userCallback,d.context=t.context,t=d}let o=new uc(t,a||void 0),l=r==="value"?new dc(o):new Pf(r,o);return K3(e._repo,e,l),()=>Ih(e._repo,e,l)}function ru(e,r,t,n){return yc(e,"value",r,t,n)}function xm(e,r,t,n){return yc(e,"child_added",r,t,n)}function vm(e,r,t,n){return yc(e,"child_changed",r,t,n)}function bm(e,r,t,n){return yc(e,"child_moved",r,t,n)}function wm(e,r,t,n){return yc(e,"child_removed",r,t,n)}function ym(e,r,t){let n=null,i=t?new uc(t):null;r==="value"?n=new dc(i):r&&(n=new Pf(r,i)),Ih(e._repo,e,n)}var un=class{},Lf=class extends un{constructor(r,t){super(),this._value=r,this._key=t,this.type="endAt"}_apply(r){oi("endAt",this._value,r._path,!0);let t=oh(r._queryParams,this._value,this._key);if(Zf(t),fa(t),r._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Br(r._repo,r._path,t,r._orderByCalled)}};function ib(e,r){return vc("endAt","key",r,!0),new Lf(e,r)}var Nh=class extends un{constructor(r,t){super(),this._value=r,this._key=t,this.type="endBefore"}_apply(r){oi("endBefore",this._value,r._path,!1);let t=CI(r._queryParams,this._value,this._key);if(Zf(t),fa(t),r._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Br(r._repo,r._path,t,r._orderByCalled)}};function ab(e,r){return vc("endBefore","key",r,!0),new Nh(e,r)}var Mf=class extends un{constructor(r,t){super(),this._value=r,this._key=t,this.type="startAt"}_apply(r){oi("startAt",this._value,r._path,!0);let t=sh(r._queryParams,this._value,this._key);if(Zf(t),fa(t),r._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Br(r._repo,r._path,t,r._orderByCalled)}};function sb(e=null,r){return vc("startAt","key",r,!0),new Mf(e,r)}var Dh=class extends un{constructor(r,t){super(),this._value=r,this._key=t,this.type="startAfter"}_apply(r){oi("startAfter",this._value,r._path,!1);let t=AI(r._queryParams,this._value,this._key);if(Zf(t),fa(t),r._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Br(r._repo,r._path,t,r._orderByCalled)}};function ob(e,r){return vc("startAfter","key",r,!0),new Dh(e,r)}var Oh=class extends un{constructor(r){super(),this._limit=r,this.type="limitToFirst"}_apply(r){if(r._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Br(r._repo,r._path,kI(r._queryParams,this._limit),r._orderByCalled)}};function cb(e){if(typeof e!="number"||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Oh(e)}var Ph=class extends un{constructor(r){super(),this._limit=r,this.type="limitToLast"}_apply(r){if(r._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Br(r._repo,r._path,SI(r._queryParams,this._limit),r._orderByCalled)}};function lb(e){if(typeof e!="number"||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Ph(e)}var Lh=class extends un{constructor(r){super(),this._path=r,this.type="orderByChild"}_apply(r){Jf(r,"orderByChild");let t=new lt(this._path);if(Ye(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let n=new tc(t),i=Uf(r._queryParams,n);return fa(i),new Br(r._repo,r._path,i,!0)}};function nu(e){if(e==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(e==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(e==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Zs("orderByChild","path",e,!1),new Lh(e)}var Mh=class extends un{constructor(){super(...arguments),this.type="orderByKey"}_apply(r){Jf(r,"orderByKey");let t=Uf(r._queryParams,ii);return fa(t),new Br(r._repo,r._path,t,!0)}};function fb(){return new Mh}var Bh=class extends un{constructor(){super(...arguments),this.type="orderByPriority"}_apply(r){Jf(r,"orderByPriority");let t=Uf(r._queryParams,bt);return fa(t),new Br(r._repo,r._path,t,!0)}};function ub(){return new Bh}var Uh=class extends un{constructor(){super(...arguments),this.type="orderByValue"}_apply(r){Jf(r,"orderByValue");let t=Uf(r._queryParams,Jh);return fa(t),new Br(r._repo,r._path,t,!0)}};function db(){return new Uh}var Wh=class extends un{constructor(r,t){super(),this._value=r,this._key=t,this.type="equalTo"}_apply(r){if(oi("equalTo",this._value,r._path,!1),r._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(r._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Lf(this._value,this._key)._apply(new Mf(this._value,this._key)._apply(r))}};function iu(e,r){return vc("equalTo","key",r,!0),new Wh(e,r)}function Jr(e,...r){let t=Pr(e);for(let n of r)t=n._apply(t);return t}l3(fn);m3(fn);var nR="FIREBASE_DATABASE_EMULATOR_HOST",Hh={},iR=!1;function aR(e,r,t,n){e.repoInfo_=new hf(`${r}:${t}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),n&&(e.authTokenProvider_=n)}function Em(e,r,t,n,i){let a=n||e.options.databaseURL;a===void 0&&(e.options.projectId||ai("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),rr("Using default host for project ",e.options.projectId),a=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o=Rh(a,i),l=o.repoInfo,f,d;typeof process<"u"&&process.env&&(d=process.env[nR]),d?(f=!0,a=`http://${d}?ns=${l.namespace}`,o=Rh(a,i),l=o.repoInfo):f=!o.repoInfo.secure;let h=i&&f?new Yo(Yo.OWNER):new Xd(e.name,e.options,r);Gv("Invalid Firebase Database URL",o),Ye(o.path)||ai("Database URL must point to the root of a Firebase Database (not including a child path).");let p=oR(l,e,h,new Gd(e.name,t));return new Vh(p,e)}function sR(e,r){let t=Hh[r];(!t||t[e.key]!==e)&&ai(`Database ${r}(${e.repoInfo_}) has already been deleted.`),Yv(e),delete t[e.key]}function oR(e,r,t,n){let i=Hh[r.name];i||(i={},Hh[r.name]=i);let a=i[e.toURLString()];return a&&ai("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new Fh(e,iR,t,n),i[e.toURLString()]=a,a}var Vh=class{constructor(r,t){this._repoInternal=r,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(W3(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new fn(this._repo,ct())),this._rootInternal}_delete(){return this._rootInternal!==null&&(sR(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(r){this._rootInternal===null&&ai("Cannot call "+r+" on a deleted database.")}};function hb(){mv.IS_TRANSPORT_INITIALIZED&&vr("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function mb(){hb(),Zo.forceDisallow()}function pb(){hb(),Us.forceDisallow(),Zo.forceAllow()}function gb(e=gd(),r){let t=pd(e,"database").getImmediate({identifier:r});if(!t._instanceStarted){let n=k_("database");n&&Tm(t,...n)}return t}function Tm(e,r,t,n={}){e=Pr(e),e._checkNotDeleted("useEmulator"),e._instanceStarted&&ai("Cannot call useEmulator() after instance has already been initialized.");let i=e._repoInternal,a;if(i.repoInfo_.nodeAdmin)n.mockUserToken&&ai('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new Yo(Yo.OWNER);else if(n.mockUserToken){let o=typeof n.mockUserToken=="string"?n.mockUserToken:S_(n.mockUserToken,e.app.options.projectId);a=new Yo(o)}aR(i,r,t,a)}function _b(e){e=Pr(e),e._checkNotDeleted("goOffline"),Yv(e._repo)}function xb(e){e=Pr(e),e._checkNotDeleted("goOnline"),Y3(e._repo)}function vb(e,r){qx(e,r)}function cR(e){Xh(L_),Wo(new Ai("database",(r,{instanceIdentifier:t})=>{let n=r.getProvider("app").getImmediate(),i=r.getProvider("auth-internal"),a=r.getProvider("app-check-internal");return Em(n,i,a,t)},"PUBLIC").setMultipleInstances(!0)),ea(px,gx,e),ea(px,gx,"esm2017")}var lR={".sv":"timestamp"};function bb(){return lR}function wb(e){return{".sv":{increment:e}}}var zh=class{constructor(r,t){this.committed=r,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function yb(e,r,t){var n;if(e=Pr(e),cn("Reference.transaction",e._path),e.key===".length"||e.key===".keys")throw"Reference.transaction failed: "+e.key+" is a read-only object.";let i=(n=t?.applyLocally)!==null&&n!==void 0?n:!0,a=new tr,o=(f,d,h)=>{let p=null;f?a.reject(f):(p=new Ys(h,new fn(e._repo,e._path),bt),a.resolve(new zh(d,p)))},l=ru(e,()=>{});return q3(e._repo,e._path,r,o,l,i),a.promise}qh.prototype.simpleListen=function(e,r){this.sendRequest("q",{p:e},r)};qh.prototype.echo=function(e,r){this.sendRequest("echo",{d:e},r)};cR();var fR="@firebase/database-compat",uR="1.0.8";var dR=new Os("@firebase/database-compat"),Eb=function(e){let r="FIREBASE WARNING: "+e;dR.warn(r)};var hR=function(e,r,t,n){if(!(n&&t===void 0)&&typeof t!="boolean")throw new Error(Qr(e,r)+"must be a boolean.")},mR=function(e,r,t){if(!(t&&r===void 0))switch(r){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Qr(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var km=class{constructor(r){this._delegate=r}cancel(r){Oe("OnDisconnect.cancel",0,1,arguments.length),qt("OnDisconnect.cancel","onComplete",r,!0);let t=this._delegate.cancel();return r&&t.then(()=>r(null),n=>r(n)),t}remove(r){Oe("OnDisconnect.remove",0,1,arguments.length),qt("OnDisconnect.remove","onComplete",r,!0);let t=this._delegate.remove();return r&&t.then(()=>r(null),n=>r(n)),t}set(r,t){Oe("OnDisconnect.set",1,2,arguments.length),qt("OnDisconnect.set","onComplete",t,!0);let n=this._delegate.set(r);return t&&n.then(()=>t(null),i=>t(i)),n}setWithPriority(r,t,n){Oe("OnDisconnect.setWithPriority",2,3,arguments.length),qt("OnDisconnect.setWithPriority","onComplete",n,!0);let i=this._delegate.setWithPriority(r,t);return n&&i.then(()=>n(null),a=>n(a)),i}update(r,t){if(Oe("OnDisconnect.update",1,2,arguments.length),Array.isArray(r)){let i={};for(let a=0;a<r.length;++a)i[""+a]=r[a];r=i,Eb("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}qt("OnDisconnect.update","onComplete",t,!0);let n=this._delegate.update(r);return t&&n.then(()=>t(null),i=>t(i)),n}};var Sm=class{constructor(r,t){this.committed=r,this.snapshot=t}toJSON(){return Oe("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Ga=class e{constructor(r,t){this._database=r,this._delegate=t}val(){return Oe("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return Oe("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return Oe("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return Oe("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(r){return Oe("DataSnapshot.child",0,1,arguments.length),r=String(r),Zs("DataSnapshot.child","path",r,!1),new e(this._database,this._delegate.child(r))}hasChild(r){return Oe("DataSnapshot.hasChild",1,1,arguments.length),Zs("DataSnapshot.hasChild","path",r,!1),this._delegate.hasChild(r)}getPriority(){return Oe("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(r){return Oe("DataSnapshot.forEach",1,1,arguments.length),qt("DataSnapshot.forEach","action",r,!1),this._delegate.forEach(t=>r(new e(this._database,t)))}hasChildren(){return Oe("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return Oe("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return Oe("DataSnapshot.ref",0,0,arguments.length),new Ri(this._database,this._delegate.ref)}get ref(){return this.getRef()}},au=class e{constructor(r,t){this.database=r,this._delegate=t}on(r,t,n,i){var a;Oe("Query.on",2,4,arguments.length),qt("Query.on","callback",t,!1);let o=e.getCancelAndContextArgs_("Query.on",n,i),l=(d,h)=>{t.call(o.context,new Ga(this.database,d),h)};l.userCallback=t,l.context=o.context;let f=(a=o.cancel)===null||a===void 0?void 0:a.bind(o.context);switch(r){case"value":return ru(this._delegate,l,f),t;case"child_added":return xm(this._delegate,l,f),t;case"child_removed":return wm(this._delegate,l,f),t;case"child_changed":return vm(this._delegate,l,f),t;case"child_moved":return bm(this._delegate,l,f),t;default:throw new Error(Qr("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(r,t,n){if(Oe("Query.off",0,3,arguments.length),mR("Query.off",r,!0),qt("Query.off","callback",t,!0),hd("Query.off","context",n,!0),t){let i=()=>{};i.userCallback=t,i.context=n,ym(this._delegate,r,i)}else ym(this._delegate,r)}get(){return tu(this._delegate).then(r=>new Ga(this.database,r))}once(r,t,n,i){Oe("Query.once",1,4,arguments.length),qt("Query.once","callback",t,!0);let a=e.getCancelAndContextArgs_("Query.once",n,i),o=new tr,l=(d,h)=>{let p=new Ga(this.database,d);t&&t.call(a.context,p,h),o.resolve(p)};l.userCallback=t,l.context=a.context;let f=d=>{a.cancel&&a.cancel.call(a.context,d),o.reject(d)};switch(r){case"value":ru(this._delegate,l,f,{onlyOnce:!0});break;case"child_added":xm(this._delegate,l,f,{onlyOnce:!0});break;case"child_removed":wm(this._delegate,l,f,{onlyOnce:!0});break;case"child_changed":vm(this._delegate,l,f,{onlyOnce:!0});break;case"child_moved":bm(this._delegate,l,f,{onlyOnce:!0});break;default:throw new Error(Qr("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(r){return Oe("Query.limitToFirst",1,1,arguments.length),new e(this.database,Jr(this._delegate,cb(r)))}limitToLast(r){return Oe("Query.limitToLast",1,1,arguments.length),new e(this.database,Jr(this._delegate,lb(r)))}orderByChild(r){return Oe("Query.orderByChild",1,1,arguments.length),new e(this.database,Jr(this._delegate,nu(r)))}orderByKey(){return Oe("Query.orderByKey",0,0,arguments.length),new e(this.database,Jr(this._delegate,fb()))}orderByPriority(){return Oe("Query.orderByPriority",0,0,arguments.length),new e(this.database,Jr(this._delegate,ub()))}orderByValue(){return Oe("Query.orderByValue",0,0,arguments.length),new e(this.database,Jr(this._delegate,db()))}startAt(r=null,t){return Oe("Query.startAt",0,2,arguments.length),new e(this.database,Jr(this._delegate,sb(r,t)))}startAfter(r=null,t){return Oe("Query.startAfter",0,2,arguments.length),new e(this.database,Jr(this._delegate,ob(r,t)))}endAt(r=null,t){return Oe("Query.endAt",0,2,arguments.length),new e(this.database,Jr(this._delegate,ib(r,t)))}endBefore(r=null,t){return Oe("Query.endBefore",0,2,arguments.length),new e(this.database,Jr(this._delegate,ab(r,t)))}equalTo(r,t){return Oe("Query.equalTo",1,2,arguments.length),new e(this.database,Jr(this._delegate,iu(r,t)))}toString(){return Oe("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return Oe("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(r){if(Oe("Query.isEqual",1,1,arguments.length),!(r instanceof e)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(r._delegate)}static getCancelAndContextArgs_(r,t,n){let i={cancel:void 0,context:void 0};if(t&&n)i.cancel=t,qt(r,"cancel",i.cancel,!0),i.context=n,hd(r,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(Qr(r,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Ri(this.database,new fn(this._delegate._repo,this._delegate._path))}},Ri=class e extends au{constructor(r,t){super(r,new Br(t._repo,t._path,new ac,!1)),this.database=r,this._delegate=t}getKey(){return Oe("Reference.key",0,0,arguments.length),this._delegate.key}child(r){return Oe("Reference.child",1,1,arguments.length),typeof r=="number"&&(r=String(r)),new e(this.database,la(this._delegate,r))}getParent(){Oe("Reference.parent",0,0,arguments.length);let r=this._delegate.parent;return r?new e(this.database,r):null}getRoot(){return Oe("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)}set(r,t){Oe("Reference.set",1,2,arguments.length),qt("Reference.set","onComplete",t,!0);let n=eu(this._delegate,r);return t&&n.then(()=>t(null),i=>t(i)),n}update(r,t){if(Oe("Reference.update",1,2,arguments.length),Array.isArray(r)){let i={};for(let a=0;a<r.length;++a)i[""+a]=r[a];r=i,Eb("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}cn("Reference.update",this._delegate._path),qt("Reference.update","onComplete",t,!0);let n=nb(this._delegate,r);return t&&n.then(()=>t(null),i=>t(i)),n}setWithPriority(r,t,n){Oe("Reference.setWithPriority",2,3,arguments.length),qt("Reference.setWithPriority","onComplete",n,!0);let i=rb(this._delegate,r,t);return n&&i.then(()=>n(null),a=>n(a)),i}remove(r){Oe("Reference.remove",0,1,arguments.length),qt("Reference.remove","onComplete",r,!0);let t=eb(this._delegate);return r&&t.then(()=>r(null),n=>r(n)),t}transaction(r,t,n){Oe("Reference.transaction",1,3,arguments.length),qt("Reference.transaction","transactionUpdate",r,!1),qt("Reference.transaction","onComplete",t,!0),hR("Reference.transaction","applyLocally",n,!0);let i=yb(this._delegate,r,{applyLocally:n}).then(a=>new Sm(a.committed,new Ga(this.database,a.snapshot)));return t&&i.then(a=>t(null,a.committed,a.snapshot),a=>t(a,!1,null)),i}setPriority(r,t){Oe("Reference.setPriority",1,2,arguments.length),qt("Reference.setPriority","onComplete",t,!0);let n=tb(this._delegate,r);return t&&n.then(()=>t(null),i=>t(i)),n}push(r,t){Oe("Reference.push",0,2,arguments.length),qt("Reference.push","onComplete",t,!0);let n=Zv(this._delegate,r),i=n.then(o=>new e(this.database,o));t&&i.then(()=>t(null),o=>t(o));let a=new e(this.database,n);return a.then=i.then.bind(i),a.catch=i.catch.bind(i,void 0),a}onDisconnect(){return cn("Reference.onDisconnect",this._delegate._path),new km(new Of(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Xa=class{constructor(r,t){this._delegate=r,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:mb,forceLongPolling:pb}}useEmulator(r,t,n={}){Tm(this._delegate,r,t,n)}ref(r){if(Oe("database.ref",0,1,arguments.length),r instanceof Ri){let t=_m(this._delegate,r.toString());return new Ri(this,t)}else{let t=wc(this._delegate,r);return new Ri(this,t)}}refFromURL(r){Oe("database.refFromURL",1,1,arguments.length);let n=_m(this._delegate,r);return new Ri(this,n)}goOffline(){return Oe("database.goOffline",0,0,arguments.length),_b(this._delegate)}goOnline(){return Oe("database.goOnline",0,0,arguments.length),xb(this._delegate)}};Xa.ServerValue={TIMESTAMP:bb(),increment:e=>wb(e)};function pR({app:e,url:r,version:t,customAuthImpl:n,customAppCheckImpl:i,namespace:a,nodeAdmin:o=!1}){Xh(t);let l=new md("database-standalone"),f=new rf("auth-internal",l);f.setComponent(new Ai("auth-internal",()=>n,"PRIVATE"));let d;return i&&(d=new rf("app-check-internal",l),d.setComponent(new Ai("app-check-internal",()=>i,"PRIVATE"))),{instance:new Xa(Em(e,f,d,r,o),e),namespace:a}}var gR=Object.freeze({__proto__:null,initStandalone:pR});var _R=Xa.ServerValue;function xR(e){e.INTERNAL.registerComponent(new Ai("database-compat",(r,{instanceIdentifier:t})=>{let n=r.getProvider("app-compat").getImmediate(),i=r.getProvider("database").getImmediate({identifier:t});return new Xa(i,n)},"PUBLIC").setServiceProps({Reference:Ri,Query:au,Database:Xa,DataSnapshot:Ga,enableLogging:vb,INTERNAL:gR,ServerValue:_R}).setMultipleInstances(!0)),e.registerVersion(fR,uR)}xR(xr);function Ec(e,r,t="on",n=Wl){return new ws(i=>{let a=null;return a=e[t](r,(o,l)=>{n.schedule(()=>{i.next({snapshot:o,prevKey:l})}),t==="once"&&n.schedule(()=>i.complete())},o=>{n.schedule(()=>i.error(o))}),t==="on"?{unsubscribe(){a!=null&&e.off(r,a)}}:{unsubscribe(){}}}).pipe(Kt(i=>{let{snapshot:a,prevKey:o}=i,l=null;return a.exists()&&(l=a.key),{type:r,payload:a,prevKey:o,key:l}}),Vl())}function vR(e){return typeof e=="string"}function bR(e){return typeof e.exportVal=="function"}function Cb(e){return e==null}function Fb(e){return typeof e.set=="function"}function Tb(e,r){return Fb(r)?r:e.ref(r)}function Ib(e,r){if(vR(e))return r.stringCase();if(Fb(e))return r.firebaseCase();if(bR(e))return r.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof e}`)}function Rb(e){return(Cb(e)||e.length===0)&&(e=["child_added","child_removed","child_changed","child_moved"]),e}function Nb(e,r,t){r=Rb(r);let n=r.map(i=>Ec(e,i,"on",t));return Po(...n)}function wR(e,r,t){let n=Nb(e,r).pipe(nd((i,a)=>[...i,a],[]));return ER(e,n,t)}function yR(e,r){return Ec(e,"value","on",r).pipe(Kt(t=>{let n;return t.payload.forEach(i=>(n=i.key,!1)),{data:t,lastKeyToLoad:n}}))}function ER(e,r,t){return yR(e,t).pipe(a_(r),Kt(([i,a])=>{let o=i.lastKeyToLoad,l=a.map(f=>f.key);return{actions:a,lastKeyToLoad:o,loadedKeys:l}}),i_(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),Kt(i=>i.actions))}function kb(e,r){return function(n,i){return Ib(n,{stringCase:()=>e.child(n)[r](i),firebaseCase:()=>n[r](i),snapshotCase:()=>n.ref[r](i)})}}function TR(e){return function(t){return t?Ib(t,{stringCase:()=>e.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):e.remove()}}function kR(e,r,t){return Ec(e,"value","once",t).pipe(ki(n=>{let i=[on(n)];return r.forEach(a=>i.push(Ec(e,a,"on",t))),Po(...i).pipe(nd(AR,[]))}),t_())}function Db(e,r){let t=e.length;for(let n=0;n<t;n++)if(e[n].payload.key===r)return n;return-1}function SR(e,r){if(Cb(r))return 0;{let t=Db(e,r);return t===-1?e.length:t+1}}function AR(e,r){let{payload:t,prevKey:n,key:i}=r,a=Db(e,i),o=SR(e,n);switch(r.type){case"value":if(r.payload?.exists()){let l=null;r.payload.forEach(f=>{let d={payload:f,type:"value",prevKey:l,key:f.key};return l=f.key,e=[...e,d],!1})}return e;case"child_added":if(a>-1)(e[a-1]?.key||null)!==n&&(e=e.filter(f=>f.payload.key!==t.key),e.splice(o,0,r));else{if(n==null)return[r,...e];e=e.slice(),e.splice(o,0,r)}return e;case"child_removed":return e.filter(l=>l.payload.key!==t.key);case"child_changed":return e.map(l=>l.payload.key===i?r:l);case"child_moved":if(a>-1){let l=e.splice(a,1)[0];return e=e.slice(),e.splice(o,0,l),e}return e;default:return e}}function Sb(e,r,t){return r=Rb(r),kR(e,r,t)}function CR(e,r){let t=r.schedulers.outsideAngular,n=r.schedulers.ngZone.run(()=>e.ref);return{query:e,update:kb(n,"update"),set:kb(n,"set"),push:i=>n.push(i),remove:TR(n),snapshotChanges(i){return Sb(e,i,t).pipe(Fi)},stateChanges(i){return Nb(e,i,t).pipe(Fi)},auditTrail(i){return wR(e,i,t).pipe(Fi)},valueChanges(i,a){return Sb(e,i,t).pipe(Kt(l=>l.map(f=>a&&a.idField?Yi(Ki({},f.payload.val()),{[a.idField]:f.key}):f.payload.val())),Fi)}}}function Ab(e,r){return function(){return Ec(e,"value","on",r)}}function FR(e,r){return{query:e,snapshotChanges(){return Ab(e,r.schedulers.outsideAngular)().pipe(Fi)},update(t){return e.ref.update(t)},set(t){return e.ref.set(t)},remove(){return e.ref.remove()},valueChanges(){return Ab(e,r.schedulers.outsideAngular)().pipe(Fi,Kt(n=>n.payload.exists()?n.payload.val():null))}}}var IR=new Yt("angularfire2.realtimeDatabaseURL"),RR=new Yt("angularfire2.database.use-emulator"),Am=(()=>{class e{schedulers;database;constructor(t,n,i,a,o,l,f,d,h,p,g,x,v,_,y){this.schedulers=l;let N=f,R=Vo(t,o,n);d&&Nd(R,o,h,g,x,v,p,_),this.database=lf(`${R.name}.database.${i}`,"AngularFireDatabase",R.name,()=>{let T=o.runOutsideAngular(()=>R.database(i||void 0));return N&&T.useEmulator(...N),T},[N])}list(t,n){let i=this.schedulers.ngZone.runOutsideAngular(()=>Tb(this.database,t)),a=i;return n&&(a=n(i)),CR(a,this)}object(t){let n=this.schedulers.ngZone.runOutsideAngular(()=>Tb(this.database,t));return FR(n,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(n){return new(n||e)(Ve(Ls),Ve(Ms,8),Ve(IR,8),Ve(Ss),Ve(En),Ve(of),Ve(RR,8),Ve(mx,8),Ve(Sd,8),Ve(Ad,8),Ve(Cd,8),Ve(Fd,8),Ve(Id,8),Ve(Rd,8),Ve(La,8))};static \u0275prov=qr({token:e,factory:e.\u0275fac,providedIn:"any"})}return e})(),e9=(()=>{class e{constructor(){xr.registerVersion("angularfire",Ps.full,"rtdb-compat")}static \u0275fac=function(n){return new(n||e)};static \u0275mod=Bn({type:e});static \u0275inj=Mn({providers:[Am]})}return e})();var r9={apiKey:"AIzaSyDO-OAtdUr1YyKTSl_-Ysgy0IiRNMgINvI",authDomain:"tic-desinger.firebaseapp.com",databaseURL:"https://tic-desinger-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"tic-desinger",storageBucket:"tic-desinger.appspot.com",messagingSenderId:"152821549306",appId:"1:152821549306:web:e6a42873b97b8722b0a143",measurementId:"G-9JDG2FP46N"};var fr=[];for(su=0;su<256;++su)fr.push((su+256).toString(16).slice(1));var su;function Ob(e,r=0){return(fr[e[r+0]]+fr[e[r+1]]+fr[e[r+2]]+fr[e[r+3]]+"-"+fr[e[r+4]]+fr[e[r+5]]+"-"+fr[e[r+6]]+fr[e[r+7]]+"-"+fr[e[r+8]]+fr[e[r+9]]+"-"+fr[e[r+10]]+fr[e[r+11]]+fr[e[r+12]]+fr[e[r+13]]+fr[e[r+14]]+fr[e[r+15]]).toLowerCase()}var ou,DR=new Uint8Array(16);function Cm(){if(!ou&&(ou=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ou))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ou(DR)}var OR=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Fm={randomUUID:OR};function PR(e,r,t){if(Fm.randomUUID&&!r&&!e)return Fm.randomUUID();e=e||{};var n=e.random||(e.rng||Cm)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,r){t=t||0;for(var i=0;i<16;++i)r[t+i]=n[i];return r}return Ob(n)}var ua=PR;var Pb=(()=>{let r=class r{constructor(n){this.db=n,this.dbPath="/ticRecordOBJECT",this.ticRef=n.list(this.dbPath)}getAll(){return this.ticRef}create(n){return lr(this,null,function*(){return yield this.db.list("/ticRecordOBJECT").push(n),{id:n.id,rev:n.rev}})}update(n,i,a){return new Promise((o,l)=>{this.db.list("/ticRecordOBJECT").valueChanges().pipe(Lo(1)).subscribe(f=>{let d=f.find(h=>h.id===n);if(console.log("Current Record:",d),d){let h=d.rev.split("_")[0];if(console.log("Current Revision:",h,"Local Revision:",i.split("_")[0]),h!==i.split("_")[0])console.error("Conflict detected!"),l(`Conflict detected in the ${a.data.type} Object! The record has been updated by another user.`);else{let p=`${parseInt(h)+1}_${ua()}`;a.rev=p,console.log("Updating Record with New Revision:",p),this.db.list("/ticRecordOBJECT").snapshotChanges().pipe(Lo(1)).subscribe(g=>{let x=g.find(v=>v.payload.val().id===n);console.log("Snapshot Found:",x),x?this.db.object(`/ticRecordOBJECT/${x.key}`).update(a).then(()=>{o({id:a.id,rev:a.rev})}).catch(v=>{console.error("Error saving record:",v),l(v)}):l("Record not found")})}}else l("Record not found")})})}listFetch(n){return this.db.list("/ticRecordOBJECT",i=>i.orderByChild("data/type").equalTo(n)).snapshotChanges().pipe(Kt(i=>i.map(a=>{let o=a.payload.val();return{id:o.id,rev:o.rev,data:o.data}})))}queryDataWithFilter(n,i,a,o){return Hl(this.db.list(n,l=>l.orderByChild(i).equalTo(a)).valueChanges()).then(l=>o?l.filter(f=>f.data?.type===o):l)}queryDataByField(n,i,a){return Hl(this.db.list(n,o=>o.orderByChild(i).equalTo(a)).valueChanges())}generateIdForPrimaryField(n,i){return Hl(this.db.list("ticRecordOBJECT",a=>a.orderByChild("data/type").equalTo(n)).valueChanges()).then(a=>{if(a.length===0)return i.primaryFieldNamePrefix+"01";{let l=a.sort((d,h)=>h.timestamp-d.timestamp)[0].data[i.primaryFieldName],f=(parseInt(l.replace(/^\D+/g,""))+1).toString().padStart(2,"0");return i.primaryFieldNamePrefix+f}})}pushToFirebases(n){return new Promise((i,a)=>{this.db.list(this.dbPath).push(n).then(()=>{console.log("Data pushed to Firebase:",n),i()}).catch(o=>{console.error("Error pushing data to Firebase:",o),a(o)})})}};r.\u0275fac=function(i){return new(i||r)(Ve(Am))},r.\u0275prov=qr({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();var _y=v4(Lb());var Ww={};Ww.version="0.18.5";var fi=1200,oo=1252,MR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Qm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Jm=function(e){MR.indexOf(e)!=-1&&(oo=Qm[0]=e)};function BR(){Jm(1252)}var $n=function(e){fi=e,Jm(e)};function Hw(){$n(1200),BR()}function Wm(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function UR(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function Vw(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Sc=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?UR(e.slice(2)):r==254&&t==255?Vw(e.slice(2)):r==65279?e.slice(1):e},cu=function(r){return String.fromCharCode(r)},Mb=function(r){return String.fromCharCode(r)},dt;var Gt=null,kc=!0,ma="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Bb(e){for(var r="",t=0,n=0,i=0,a=0,o=0,l=0,f=0,d=0;d<e.length;)t=e.charCodeAt(d++),a=t>>2,n=e.charCodeAt(d++),o=(t&3)<<4|n>>4,i=e.charCodeAt(d++),l=(n&15)<<2|i>>6,f=i&63,isNaN(n)?l=f=64:isNaN(i)&&(f=64),r+=ma.charAt(a)+ma.charAt(o)+ma.charAt(l)+ma.charAt(f);return r}function hn(e){var r="",t=0,n=0,i=0,a=0,o=0,l=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)a=ma.indexOf(e.charAt(d++)),o=ma.indexOf(e.charAt(d++)),t=a<<2|o>>4,r+=String.fromCharCode(t),l=ma.indexOf(e.charAt(d++)),n=(o&15)<<4|l>>2,l!==64&&(r+=String.fromCharCode(n)),f=ma.indexOf(e.charAt(d++)),i=(l&3)<<6|f,f!==64&&(r+=String.fromCharCode(i));return r}var it=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Za=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function _a(e){return it?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Ub(e){return it?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Xn=function(r){return it?Za(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function es(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Zm(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Zm(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var ha=it?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Za(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),i=0;for(r=0,t=0;r<e.length;t+=i,++r)if(i=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function WR(e){for(var r=[],t=0,n=e.length+250,i=_a(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[t++]=o;else if(o<2048)i[t++]=192|o>>6&31,i[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;i[t++]=240|o>>8&7,i[t++]=128|o>>2&63,i[t++]=128|l>>6&15|(o&3)<<4,i[t++]=128|l&63}else i[t++]=224|o>>12&15,i[t++]=128|o>>6&63,i[t++]=128|o&63;t>n&&(r.push(i.slice(0,t)),t=0,i=_a(65535),n=65530)}return r.push(i.slice(0,t)),ha(r)}var Tr=/\u0000/g,Ac=/[\u0001-\u0006]/g;function io(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function jn(e,r){var t=""+e;return t.length>=r?t:Ot("0",r-t.length)+t}function ep(e,r){var t=""+e;return t.length>=r?t:Ot(" ",r-t.length)+t}function _u(e,r){var t=""+e;return t.length>=r?t:t+Ot(" ",r-t.length)}function HR(e,r){var t=""+Math.round(e);return t.length>=r?t:Ot("0",r-t.length)+t}function VR(e,r){var t=""+e;return t.length>=r?t:Ot("0",r-t.length)+t}var Wb=Math.pow(2,32);function ro(e,r){if(e>Wb||e<-Wb)return HR(e,r);var t=Math.round(e);return VR(t,r)}function xu(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Hb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Im=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Vb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},GR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vu(e,r,t){for(var n=e<0?-1:1,i=e*n,a=0,o=1,l=0,f=1,d=0,h=0,p=Math.floor(i);d<r&&(p=Math.floor(i),l=p*o+a,h=p*d+f,!(i-p<5e-8));)i=1/(i-p),a=o,o=l,f=d,d=h;if(h>r&&(d>r?(h=f,l=a):(h=d,l=o)),!t)return[0,n*l,h];var g=Math.floor(n*l/h);return[g,n*l-g*h,h]}function ja(e,r,t){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=t?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=t?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],a=f.getDay(),n<60&&(a=(a+6)%7),t&&(a=qR(f,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=a,l}var zw=new Date(1899,11,31,0,0,0),XR=zw.getTime(),$R=new Date(1900,2,1,0,0,0);function Gw(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=$R&&(t+=24*60*60*1e3),(t-(XR+(e.getTimezoneOffset()-zw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function tp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function KR(e){var r=e<0?12:11,t=tp(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function YR(e){var r=tp(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Uc(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=KR(e):r===10?t=e.toFixed(10).substr(0,12):t=YR(e),tp(jR(t.toUpperCase()))}function qa(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Uc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return In(14,Gw(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function qR(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function QR(e,r,t,n){var i="",a=0,o=0,l=t.y,f,d=0;switch(e){case 98:l=t.y+543;case 121:switch(r.length){case 1:case 2:f=l%100,d=2;break;default:f=l%1e4,d=4;break}break;case 109:switch(r.length){case 1:case 2:f=t.m,d=r.length;break;case 3:return Im[t.m-1][1];case 5:return Im[t.m-1][0];default:return Im[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:f=t.d,d=r.length;break;case 3:return Hb[t.q][0];default:return Hb[t.q][1]}break;case 104:switch(r.length){case 1:case 2:f=1+(t.H+11)%12,d=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:f=t.H,d=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:f=t.M,d=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?jn(t.S,r.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(t.S+t.u)),a>=60*o&&(a=0),r==="s"?a===0?"0":""+a/o:(i=jn(a,2+n),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}d=r.length===3?1:2;break;case 101:f=l,d=1;break}var h=d>0?jn(f,d):"";return h}function pa(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Xw=/%/g;function JR(e,r,t){var n=r.replace(Xw,""),i=r.length-n.length;return Oi(e,n,t*Math.pow(10,2*i))+Ot("%",i)}function ZR(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Oi(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function $w(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+$w(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),t=(r/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),t.indexOf("e")===-1){var o=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+a):t+="E+"+(o-a);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,f,d,h){return f+d+h.substr(0,(i+a)%i)+"."+h.substr(a)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var jw=/# (\?+)( ?)\/( ?)(\d+)/;function eN(e,r,t){var n=parseInt(e[4],10),i=Math.round(r*n),a=Math.floor(i/n),o=i-a*n,l=n;return t+(a===0?"":""+a)+" "+(o===0?Ot(" ",e[1].length+1+e[4].length):ep(o,e[1].length)+e[2]+"/"+e[3]+jn(l,e[4].length))}function tN(e,r,t){return t+(r===0?"":""+r)+Ot(" ",e[1].length+2+e[4].length)}var Kw=/^#*0*\.([0#]+)/,Yw=/\).*[0#]/,qw=/\(###\) ###\\?-####/;function Ur(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function zb(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Gb(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function rN(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function nN(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Cn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Yw)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Cn("n",n,t):"("+Cn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return ZR(e,r,t);if(r.indexOf("%")!==-1)return JR(e,r,t);if(r.indexOf("E")!==-1)return $w(r,t);if(r.charCodeAt(0)===36)return"$"+Cn(e,r.substr(r.charAt(1)==" "?2:1),t);var i,a,o,l,f=Math.abs(t),d=t<0?"-":"";if(r.match(/^00+$/))return d+ro(f,r.length);if(r.match(/^[#?]+$/))return i=ro(t,0),i==="0"&&(i=""),i.length>r.length?i:Ur(r.substr(0,r.length-i.length))+i;if(a=r.match(jw))return eN(a,f,d);if(r.match(/^#+0+$/))return d+ro(f,r.length-r.indexOf("0"));if(a=r.match(Kw))return i=zb(t,a[1].length).replace(/^([^\.]+)$/,"$1."+Ur(a[1])).replace(/\.$/,"."+Ur(a[1])).replace(/\.(\d*)$/,function(v,_){return"."+_+Ot("0",Ur(a[1]).length-_.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return d+zb(f,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return d+pa(ro(f,0));if(a=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Cn(e,r,-t):pa(""+(Math.floor(t)+rN(t,a[1].length)))+"."+jn(Gb(t,a[1].length),a[1].length);if(a=r.match(/^#,#*,#0/))return Cn(e,r.replace(/^#,#*,/,""),t);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=io(Cn(e,r.replace(/[\\-]/g,""),t)),o=0,io(io(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(r.match(qw))return i=Cn(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=vu(f,Math.pow(10,o)-1,!1),i=""+d,h=Oi("n",a[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+a[2]+"/"+a[3],h=_u(l[2],o),h.length<a[4].length&&(h=Ur(a[4].substr(a[4].length-h.length))+h),i+=h,i;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=vu(f,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?ep(l[1],o)+a[2]+"/"+a[3]+_u(l[2],o):Ot(" ",2*o+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=ro(t,0),r.length<=i.length?i:Ur(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var p=r.indexOf(".")-o,g=r.length-i.length-p;return Ur(r.substr(0,p)+i+r.substr(r.length-g))}if(a=r.match(/^00,000\.([#0]*0)$/))return o=Gb(t,a[1].length),t<0?"-"+Cn(e,r,-t):pa(nN(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?jn(0,3-v.length):"")+v})+"."+jn(o,a[1].length);switch(r){case"###,##0.00":return Cn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var x=pa(ro(f,0));return x!=="0"?d+x:"";case"###,###.00":return Cn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Cn(e,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+r+"|")}function iN(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Oi(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function aN(e,r,t){var n=r.replace(Xw,""),i=r.length-n.length;return Oi(e,n,t*Math.pow(10,2*i))+Ot("%",i)}function Qw(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Qw(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),t=(r/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!t.match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+a):t+="E+"+(o-a),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,f,d,h){return f+d+h.substr(0,(i+a)%i)+"."+h.substr(a)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function li(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Yw)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?li("n",n,t):"("+li("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return iN(e,r,t);if(r.indexOf("%")!==-1)return aN(e,r,t);if(r.indexOf("E")!==-1)return Qw(r,t);if(r.charCodeAt(0)===36)return"$"+li(e,r.substr(r.charAt(1)==" "?2:1),t);var i,a,o,l,f=Math.abs(t),d=t<0?"-":"";if(r.match(/^00+$/))return d+jn(f,r.length);if(r.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>r.length?i:Ur(r.substr(0,r.length-i.length))+i;if(a=r.match(jw))return tN(a,f,d);if(r.match(/^#+0+$/))return d+jn(f,r.length-r.indexOf("0"));if(a=r.match(Kw))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Ur(a[1])).replace(/\.$/,"."+Ur(a[1])),i=i.replace(/\.(\d*)$/,function(v,_){return"."+_+Ot("0",Ur(a[1]).length-_.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return d+pa(""+f);if(a=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+li(e,r,-t):pa(""+t)+"."+Ot("0",a[1].length);if(a=r.match(/^#,#*,#0/))return li(e,r.replace(/^#,#*,/,""),t);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=io(li(e,r.replace(/[\\-]/g,""),t)),o=0,io(io(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(r.match(qw))return i=li(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=vu(f,Math.pow(10,o)-1,!1),i=""+d,h=Oi("n",a[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+a[2]+"/"+a[3],h=_u(l[2],o),h.length<a[4].length&&(h=Ur(a[4].substr(a[4].length-h.length))+h),i+=h,i;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=vu(f,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?ep(l[1],o)+a[2]+"/"+a[3]+_u(l[2],o):Ot(" ",2*o+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=""+t,r.length<=i.length?i:Ur(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var p=r.indexOf(".")-o,g=r.length-i.length-p;return Ur(r.substr(0,p)+i+r.substr(r.length-g))}if(a=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+li(e,r,-t):pa(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?jn(0,3-v.length):"")+v})+"."+jn(0,a[1].length);switch(r){case"###,###":case"##,###":case"#,###":var x=pa(""+f);return x!=="0"?d+x:"";default:if(r.match(/\.[0#?]*$/))return li(e,r.slice(0,r.lastIndexOf(".")),t)+Ur(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Oi(e,r,t){return(t|0)===t?li(e,r,t):Cn(e,r,t)}function sN(e){for(var r=[],t=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(i,n-i),i=n+1}if(r[r.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Jw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fo(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":xu(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(Jw))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function oN(e,r,t,n){for(var i=[],a="",o=0,l="",f="t",d,h,p,g="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!xu(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(p=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(p);i[i.length]={t:"t",v:a},++o;break;case"\\":var x=e.charAt(++o),v=x==="("||x===")"?x:"t";i[i.length]={t:v,v:x},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:r},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=ja(r,t,e.charAt(o+1)==="2"),d==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},f=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||d==null&&(d=ja(r,t),d==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&f.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=g),i[i.length]={t:l,v:a},f=l;break;case"A":case"a":case"\u4E0A":var _={t:l,v:l};if(d==null&&(d=ja(r,t)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(_.v=d.H>=12?"P":"A"),_.t="T",g="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(_.v=d.H>=12?"PM":"AM"),_.t="T",o+=5,g="h"):e.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(d!=null&&(_.v=d.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),_.t="T",o+=5,g="h"):(_.t="t",++o),d==null&&_.t==="T")return"";i[i.length]=_,f=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Jw)){if(d==null&&(d=ja(r,t),d==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},f=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",fo(e)||(i[i.length]={t:"t",v:a}));break;case".":if(d!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;i[i.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;i[i.length]={t:l,v:a},f=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var y=0,N=0,R;for(o=i.length-1,f="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=g,f="h",y<1&&(y=1);break;case"s":(R=i[o].v.match(/\.0+$/))&&(N=Math.max(N,R[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":f=i[o].t;break;case"m":f==="s"&&(i[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[o].v.match(/[Hh]/)&&(y=1),y<2&&i[o].v.match(/[Mm]/)&&(y=2),y<3&&i[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var T="",z;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=QR(i[o].t.charCodeAt(0),i[o].v,d,N),i[o].t="t";break;case"n":case"?":for(z=o+1;i[z]!=null&&((l=i[z].t)==="?"||l==="D"||(l===" "||l==="t")&&i[z+1]!=null&&(i[z+1].t==="?"||i[z+1].t==="t"&&i[z+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[z].v==="/"||i[z].v===" "&&i[z+1]!=null&&i[z+1].t=="?"));)i[o].v+=i[z].v,i[z]={v:"",t:";"},++z;T+=i[o].v,o=z-1;break;case"G":i[o].t="t",i[o].v=qa(r,t);break}var J="",U,D;if(T.length>0){T.charCodeAt(0)==40?(U=r<0&&T.charCodeAt(0)===45?-r:r,D=Oi("n",T,U)):(U=r<0&&n>1?-r:r,D=Oi("n",T,U),U<0&&i[0]&&i[0].t=="t"&&(D=D.substr(1),i[0].v="-"+i[0].v)),z=D.length-1;var j=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){j=o;break}var V=i.length;if(j===i.length&&D.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(z>=i[o].v.length-1?(z-=i[o].v.length,i[o].v=D.substr(z+1,i[o].v.length)):z<0?i[o].v="":(i[o].v=D.substr(0,z+1),z=-1),i[o].t="t",V=o);z>=0&&V<i.length&&(i[V].v=D.substr(0,z+1)+i[V].v)}else if(j!==i.length&&D.indexOf("E")===-1){for(z=D.indexOf(".")-1,o=j;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(h=i[o].v.indexOf(".")>-1&&o===j?i[o].v.indexOf(".")-1:i[o].v.length-1,J=i[o].v.substr(h+1);h>=0;--h)z>=0&&(i[o].v.charAt(h)==="0"||i[o].v.charAt(h)==="#")&&(J=D.charAt(z--)+J);i[o].v=J,i[o].t="t",V=o}for(z>=0&&V<i.length&&(i[V].v=D.substr(0,z+1)+i[V].v),z=D.indexOf(".")+1,o=j;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==j)){for(h=i[o].v.indexOf(".")>-1&&o===j?i[o].v.indexOf(".")+1:0,J=i[o].v.substr(0,h);h<i[o].v.length;++h)z<D.length&&(J+=D.charAt(z++));i[o].v=J,i[o].t="t",V=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(U=n>1&&r<0&&o>0&&i[o-1].v==="-"?-r:r,i[o].v=Oi(i[o].t,i[o].v,U),i[o].t="t");var re="";for(o=0;o!==i.length;++o)i[o]!=null&&(re+=i[o].v);return re}var Xb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $b(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function cN(e,r){var t=sN(e),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var a=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,a];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(Xb),l=t[1].match(Xb);return $b(r,o)?[n,t[0]]:$b(r,l)?[n,t[1]]:[n,t[o!=null&&l!=null?2:1]]}return[n,a]}function In(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:ze)[e],n==null&&(n=t.table&&t.table[Vb[e]]||ze[Vb[e]]),n==null&&(n=GR[e]||"General");break}if(xu(n,0))return qa(r,t);r instanceof Date&&(r=Gw(r,t.date1904));var i=cN(n,r);if(xu(i[1]))return qa(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return oN(i[1],r,t,i[0])}function Ka(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(ze[t]==null){r<0&&(r=t);continue}if(ze[t]==e){r=t;break}}r<0&&(r=391)}return ze[r]=e,r}function Zw(){ze=zR()}var lN={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},e2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fN(e){var r=typeof e=="number"?ze[e]:e;return r=r.replace(e2,"(\\d+)"),new RegExp("^"+r+"$")}function uN(e,r,t){var n=-1,i=-1,a=-1,o=-1,l=-1,f=-1;(r.match(e2)||[]).forEach(function(p,g){var x=parseInt(t[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=x;break;case"d":a=x;break;case"h":o=x;break;case"s":f=x;break;case"m":o>=0?l=x:i=x;break}}),f>=0&&l==-1&&i>=0&&(l=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&l==-1&&f==-1?d:n==-1&&i==-1&&a==-1?h:d+"T"+h}var dN=function(){var e={};e.version="1.2.0";function r(){for(var D=0,j=new Array(256),V=0;V!=256;++V)D=V,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,j[V]=D;return typeof Int32Array<"u"?new Int32Array(j):j}var t=r();function n(D){var j=0,V=0,re=0,te=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(re=0;re!=256;++re)te[re]=D[re];for(re=0;re!=256;++re)for(V=D[re],j=256+re;j<4096;j+=256)V=te[j]=V>>>8^D[V&255];var X=[];for(re=1;re!=16;++re)X[re-1]=typeof Int32Array<"u"?te.subarray(re*256,re*256+256):te.slice(re*256,re*256+256);return X}var i=n(t),a=i[0],o=i[1],l=i[2],f=i[3],d=i[4],h=i[5],p=i[6],g=i[7],x=i[8],v=i[9],_=i[10],y=i[11],N=i[12],R=i[13],T=i[14];function z(D,j){for(var V=j^-1,re=0,te=D.length;re<te;)V=V>>>8^t[(V^D.charCodeAt(re++))&255];return~V}function J(D,j){for(var V=j^-1,re=D.length-15,te=0;te<re;)V=T[D[te++]^V&255]^R[D[te++]^V>>8&255]^N[D[te++]^V>>16&255]^y[D[te++]^V>>>24]^_[D[te++]]^v[D[te++]]^x[D[te++]]^g[D[te++]]^p[D[te++]]^h[D[te++]]^d[D[te++]]^f[D[te++]]^l[D[te++]]^o[D[te++]]^a[D[te++]]^t[D[te++]];for(re+=15;te<re;)V=V>>>8^t[(V^D[te++])&255];return~V}function U(D,j){for(var V=j^-1,re=0,te=D.length,X=0,me=0;re<te;)X=D.charCodeAt(re++),X<128?V=V>>>8^t[(V^X)&255]:X<2048?(V=V>>>8^t[(V^(192|X>>6&31))&255],V=V>>>8^t[(V^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,me=D.charCodeAt(re++)&1023,V=V>>>8^t[(V^(240|X>>8&7))&255],V=V>>>8^t[(V^(128|X>>2&63))&255],V=V>>>8^t[(V^(128|me>>6&15|(X&3)<<4))&255],V=V>>>8^t[(V^(128|me&63))&255]):(V=V>>>8^t[(V^(224|X>>12&15))&255],V=V>>>8^t[(V^(128|X>>6&63))&255],V=V>>>8^t[(V^(128|X&63))&255]);return~V}return e.table=t,e.bstr=z,e.buf=J,e.str=U,e}(),at=function(){var r={};r.version="1.2.1";function t(w,C){for(var S=w.split("/"),A=C.split("/"),F=0,I=0,Y=Math.min(S.length,A.length);F<Y;++F){if(I=S[F].length-A[F].length)return I;if(S[F]!=A[F])return S[F]<A[F]?-1:1}return S.length-A.length}function n(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:n(w.slice(0,-1));var C=w.lastIndexOf("/");return C===-1?w:w.slice(0,C+1)}function i(w){if(w.charAt(w.length-1)=="/")return i(w.slice(0,-1));var C=w.lastIndexOf("/");return C===-1?w:w.slice(C+1)}function a(w,C){typeof C=="string"&&(C=new Date(C));var S=C.getHours();S=S<<6|C.getMinutes(),S=S<<5|C.getSeconds()>>>1,w.write_shift(2,S);var A=C.getFullYear()-1980;A=A<<4|C.getMonth()+1,A=A<<5|C.getDate(),w.write_shift(2,A)}function o(w){var C=w.read_shift(2)&65535,S=w.read_shift(2)&65535,A=new Date,F=S&31;S>>>=5;var I=S&15;S>>>=4,A.setMilliseconds(0),A.setFullYear(S+1980),A.setMonth(I-1),A.setDate(F);var Y=C&31;C>>>=5;var ne=C&63;return C>>>=6,A.setHours(C),A.setMinutes(ne),A.setSeconds(Y<<1),A}function l(w){ur(w,0);for(var C={},S=0;w.l<=w.length-4;){var A=w.read_shift(2),F=w.read_shift(2),I=w.l+F,Y={};switch(A){case 21589:S=w.read_shift(1),S&1&&(Y.mtime=w.read_shift(4)),F>5&&(S&2&&(Y.atime=w.read_shift(4)),S&4&&(Y.ctime=w.read_shift(4))),Y.mtime&&(Y.mt=new Date(Y.mtime*1e3));break}w.l=I,C[A]=Y}return C}var f;function d(){return f||(f={})}function h(w,C){if(w[0]==80&&w[1]==75)return go(w,C);if((w[0]|32)==109&&(w[1]|32)==105)return _o(w,C);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var S=3,A=512,F=0,I=0,Y=0,ne=0,Q=0,q=[],Z=w.slice(0,512);ur(Z,0);var ue=p(Z);switch(S=ue[0],S){case 3:A=512;break;case 4:A=4096;break;case 0:if(ue[1]==0)return go(w,C);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}A!==512&&(Z=w.slice(0,A),ur(Z,28));var ge=w.slice(0,A);g(Z,S);var Te=Z.read_shift(4,"i");if(S===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);Z.l+=4,Y=Z.read_shift(4,"i"),Z.l+=4,Z.chk("00100000","Mini Stream Cutoff Size: "),ne=Z.read_shift(4,"i"),F=Z.read_shift(4,"i"),Q=Z.read_shift(4,"i"),I=Z.read_shift(4,"i");for(var _e=-1,xe=0;xe<109&&(_e=Z.read_shift(4,"i"),!(_e<0));++xe)q[xe]=_e;var Le=x(w,A);y(Q,I,Le,A,q);var pt=R(Le,Y,q,A);pt[Y].name="!Directory",F>0&&ne!==me&&(pt[ne].name="!MiniFAT"),pt[q[0]].name="!FAT",pt.fat_addrs=q,pt.ssz=A;var or={},Ft=[],Rr=[],wa=[];T(Y,pt,Le,Ft,F,or,Rr,ne),v(Rr,wa,Ft),Ft.shift();var ya={FileIndex:Rr,FullPaths:wa};return C&&C.raw&&(ya.raw={header:ge,sectors:Le}),ya}function p(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(Ce,"Header Signature: "),w.l+=16;var C=w.read_shift(2,"u");return[w.read_shift(2,"u"),C]}function g(w,C){var S=9;switch(w.l+=2,S=w.read_shift(2)){case 9:if(C!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(C!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function x(w,C){for(var S=Math.ceil(w.length/C)-1,A=[],F=1;F<S;++F)A[F-1]=w.slice(F*C,(F+1)*C);return A[S-1]=w.slice(S*C),A}function v(w,C,S){for(var A=0,F=0,I=0,Y=0,ne=0,Q=S.length,q=[],Z=[];A<Q;++A)q[A]=Z[A]=A,C[A]=S[A];for(;ne<Z.length;++ne)A=Z[ne],F=w[A].L,I=w[A].R,Y=w[A].C,q[A]===A&&(F!==-1&&q[F]!==F&&(q[A]=q[F]),I!==-1&&q[I]!==I&&(q[A]=q[I])),Y!==-1&&(q[Y]=A),F!==-1&&A!=q[A]&&(q[F]=q[A],Z.lastIndexOf(F)<ne&&Z.push(F)),I!==-1&&A!=q[A]&&(q[I]=q[A],Z.lastIndexOf(I)<ne&&Z.push(I));for(A=1;A<Q;++A)q[A]===A&&(I!==-1&&q[I]!==I?q[A]=q[I]:F!==-1&&q[F]!==F&&(q[A]=q[F]));for(A=1;A<Q;++A)if(w[A].type!==0){if(ne=A,ne!=q[ne])do ne=q[ne],C[A]=C[ne]+"/"+C[A];while(ne!==0&&q[ne]!==-1&&ne!=q[ne]);q[A]=-1}for(C[0]+="/",A=1;A<Q;++A)w[A].type!==2&&(C[A]+="/")}function _(w,C,S){for(var A=w.start,F=w.size,I=[],Y=A;S&&F>0&&Y>=0;)I.push(C.slice(Y*X,Y*X+X)),F-=X,Y=$a(S,Y*4);return I.length===0?zt(0):ha(I).slice(0,w.size)}function y(w,C,S,A,F){var I=me;if(w===me){if(C!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var Y=S[w],ne=(A>>>2)-1;if(!Y)return;for(var Q=0;Q<ne&&(I=$a(Y,Q*4))!==me;++Q)F.push(I);y($a(Y,A-4),C-1,S,A,F)}}function N(w,C,S,A,F){var I=[],Y=[];F||(F=[]);var ne=A-1,Q=0,q=0;for(Q=C;Q>=0;){F[Q]=!0,I[I.length]=Q,Y.push(w[Q]);var Z=S[Math.floor(Q*4/A)];if(q=Q*4&ne,A<4+q)throw new Error("FAT boundary crossed: "+Q+" 4 "+A);if(!w[Z])break;Q=$a(w[Z],q)}return{nodes:I,data:nw([Y])}}function R(w,C,S,A){var F=w.length,I=[],Y=[],ne=[],Q=[],q=A-1,Z=0,ue=0,ge=0,Te=0;for(Z=0;Z<F;++Z)if(ne=[],ge=Z+C,ge>=F&&(ge-=F),!Y[ge]){Q=[];var _e=[];for(ue=ge;ue>=0;){_e[ue]=!0,Y[ue]=!0,ne[ne.length]=ue,Q.push(w[ue]);var xe=S[Math.floor(ue*4/A)];if(Te=ue*4&q,A<4+Te)throw new Error("FAT boundary crossed: "+ue+" 4 "+A);if(!w[xe]||(ue=$a(w[xe],Te),_e[ue]))break}I[ge]={nodes:ne,data:nw([Q])}}return I}function T(w,C,S,A,F,I,Y,ne){for(var Q=0,q=A.length?2:0,Z=C[w].data,ue=0,ge=0,Te;ue<Z.length;ue+=128){var _e=Z.slice(ue,ue+128);ur(_e,64),ge=_e.read_shift(2),Te=Iu(_e,0,ge-q),A.push(Te);var xe={name:Te,type:_e.read_shift(1),color:_e.read_shift(1),L:_e.read_shift(4,"i"),R:_e.read_shift(4,"i"),C:_e.read_shift(4,"i"),clsid:_e.read_shift(16),state:_e.read_shift(4,"i"),start:0,size:0},Le=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Le!==0&&(xe.ct=z(_e,_e.l-8));var pt=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);pt!==0&&(xe.mt=z(_e,_e.l-8)),xe.start=_e.read_shift(4,"i"),xe.size=_e.read_shift(4,"i"),xe.size<0&&xe.start<0&&(xe.size=xe.type=0,xe.start=me,xe.name=""),xe.type===5?(Q=xe.start,F>0&&Q!==me&&(C[Q].name="!StreamData")):xe.size>=4096?(xe.storage="fat",C[xe.start]===void 0&&(C[xe.start]=N(S,xe.start,C.fat_addrs,C.ssz)),C[xe.start].name=xe.name,xe.content=C[xe.start].data.slice(0,xe.size)):(xe.storage="minifat",xe.size<0?xe.size=0:Q!==me&&xe.start!==me&&C[Q]&&(xe.content=_(xe,C[Q].data,(C[ne]||{}).data))),xe.content&&ur(xe.content,0),I[Te]=xe,Y.push(xe)}}function z(w,C){return new Date((ar(w,C+4)/1e7*Math.pow(2,32)+ar(w,C)/1e7-11644473600)*1e3)}function J(w,C){return d(),h(f.readFileSync(w),C)}function U(w,C){var S=C&&C.type;switch(S||it&&Buffer.isBuffer(w)&&(S="buffer"),S||"base64"){case"file":return J(w,C);case"base64":return h(Xn(hn(w)),C);case"binary":return h(Xn(w),C)}return h(w,C)}function D(w,C){var S=C||{},A=S.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=A+"/",w.FileIndex[0]={name:A,type:5}),S.CLSID&&(w.FileIndex[0].clsid=S.CLSID),j(w)}function j(w){var C="Sh33tJ5";if(!at.find(w,"/"+C)){var S=zt(4);S[0]=55,S[1]=S[3]=50,S[2]=54,w.FileIndex.push({name:C,type:2,content:S,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+C),V(w)}}function V(w,C){D(w);for(var S=!1,A=!1,F=w.FullPaths.length-1;F>=0;--F){var I=w.FileIndex[F];switch(I.type){case 0:A?S=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:A=!0,isNaN(I.R*I.L*I.C)&&(S=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!C)){var Y=new Date(1987,1,19),ne=0,Q=Object.create?Object.create(null):{},q=[];for(F=0;F<w.FullPaths.length;++F)Q[w.FullPaths[F]]=!0,w.FileIndex[F].type!==0&&q.push([w.FullPaths[F],w.FileIndex[F]]);for(F=0;F<q.length;++F){var Z=n(q[F][0]);A=Q[Z],A||(q.push([Z,{name:i(Z).replace("/",""),type:1,clsid:Ae,ct:Y,mt:Y,content:null}]),Q[Z]=!0)}for(q.sort(function(Te,_e){return t(Te[0],_e[0])}),w.FullPaths=[],w.FileIndex=[],F=0;F<q.length;++F)w.FullPaths[F]=q[F][0],w.FileIndex[F]=q[F][1];for(F=0;F<q.length;++F){var ue=w.FileIndex[F],ge=w.FullPaths[F];if(ue.name=i(ge).replace("/",""),ue.L=ue.R=ue.C=-(ue.color=1),ue.size=ue.content?ue.content.length:0,ue.start=0,ue.clsid=ue.clsid||Ae,F===0)ue.C=q.length>1?1:-1,ue.size=0,ue.type=5;else if(ge.slice(-1)=="/"){for(ne=F+1;ne<q.length&&n(w.FullPaths[ne])!=ge;++ne);for(ue.C=ne>=q.length?-1:ne,ne=F+1;ne<q.length&&n(w.FullPaths[ne])!=n(ge);++ne);ue.R=ne>=q.length?-1:ne,ue.type=1}else n(w.FullPaths[F+1]||"")==n(ge)&&(ue.R=F+1),ue.type=2}}}function re(w,C){var S=C||{};if(S.fileType=="mad")return Vu(w,S);switch(V(w),S.fileType){case"zip":return Mu(w,S)}var A=function(Te){for(var _e=0,xe=0,Le=0;Le<Te.FileIndex.length;++Le){var pt=Te.FileIndex[Le];if(pt.content){var or=pt.content.length;or>0&&(or<4096?_e+=or+63>>6:xe+=or+511>>9)}}for(var Ft=Te.FullPaths.length+3>>2,Rr=_e+7>>3,wa=_e+127>>7,ya=Rr+xe+Ft+wa,pi=ya+127>>7,os=pi<=109?0:Math.ceil((pi-109)/127);ya+pi+os+127>>7>pi;)os=++pi<=109?0:Math.ceil((pi-109)/127);var mn=[1,os,pi,wa,Ft,xe,_e,0];return Te.FileIndex[0].size=_e<<6,mn[7]=(Te.FileIndex[0].start=mn[0]+mn[1]+mn[2]+mn[3]+mn[4]+mn[5])+(mn[6]+7>>3),mn}(w),F=zt(A[7]<<9),I=0,Y=0;{for(I=0;I<8;++I)F.write_shift(1,he[I]);for(I=0;I<8;++I)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),I=0;I<3;++I)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,A[2]),F.write_shift(4,A[0]+A[1]+A[2]+A[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,A[3]?A[0]+A[1]+A[2]-1:me),F.write_shift(4,A[3]),F.write_shift(-4,A[1]?A[0]-1:me),F.write_shift(4,A[1]),I=0;I<109;++I)F.write_shift(-4,I<A[2]?A[1]+I:-1)}if(A[1])for(Y=0;Y<A[1];++Y){for(;I<236+Y*127;++I)F.write_shift(-4,I<A[2]?A[1]+I:-1);F.write_shift(-4,Y===A[1]-1?me:Y+1)}var ne=function(Te){for(Y+=Te;I<Y-1;++I)F.write_shift(-4,I+1);Te&&(++I,F.write_shift(-4,me))};for(Y=I=0,Y+=A[1];I<Y;++I)F.write_shift(-4,Se.DIFSECT);for(Y+=A[2];I<Y;++I)F.write_shift(-4,Se.FATSECT);ne(A[3]),ne(A[4]);for(var Q=0,q=0,Z=w.FileIndex[0];Q<w.FileIndex.length;++Q)Z=w.FileIndex[Q],Z.content&&(q=Z.content.length,!(q<4096)&&(Z.start=Y,ne(q+511>>9)));for(ne(A[6]+7>>3);F.l&511;)F.write_shift(-4,Se.ENDOFCHAIN);for(Y=I=0,Q=0;Q<w.FileIndex.length;++Q)Z=w.FileIndex[Q],Z.content&&(q=Z.content.length,!(!q||q>=4096)&&(Z.start=Y,ne(q+63>>6)));for(;F.l&511;)F.write_shift(-4,Se.ENDOFCHAIN);for(I=0;I<A[4]<<2;++I){var ue=w.FullPaths[I];if(!ue||ue.length===0){for(Q=0;Q<17;++Q)F.write_shift(4,0);for(Q=0;Q<3;++Q)F.write_shift(4,-1);for(Q=0;Q<12;++Q)F.write_shift(4,0);continue}Z=w.FileIndex[I],I===0&&(Z.start=Z.size?Z.start-1:me);var ge=I===0&&S.root||Z.name;if(q=2*(ge.length+1),F.write_shift(64,ge,"utf16le"),F.write_shift(2,q),F.write_shift(1,Z.type),F.write_shift(1,Z.color),F.write_shift(-4,Z.L),F.write_shift(-4,Z.R),F.write_shift(-4,Z.C),Z.clsid)F.write_shift(16,Z.clsid,"hex");else for(Q=0;Q<4;++Q)F.write_shift(4,0);F.write_shift(4,Z.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,Z.start),F.write_shift(4,Z.size),F.write_shift(4,0)}for(I=1;I<w.FileIndex.length;++I)if(Z=w.FileIndex[I],Z.size>=4096)if(F.l=Z.start+1<<9,it&&Buffer.isBuffer(Z.content))Z.content.copy(F,F.l,0,Z.size),F.l+=Z.size+511&-512;else{for(Q=0;Q<Z.size;++Q)F.write_shift(1,Z.content[Q]);for(;Q&511;++Q)F.write_shift(1,0)}for(I=1;I<w.FileIndex.length;++I)if(Z=w.FileIndex[I],Z.size>0&&Z.size<4096)if(it&&Buffer.isBuffer(Z.content))Z.content.copy(F,F.l,0,Z.size),F.l+=Z.size+63&-64;else{for(Q=0;Q<Z.size;++Q)F.write_shift(1,Z.content[Q]);for(;Q&63;++Q)F.write_shift(1,0)}if(it)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function te(w,C){var S=w.FullPaths.map(function(Q){return Q.toUpperCase()}),A=S.map(function(Q){var q=Q.split("/");return q[q.length-(Q.slice(-1)=="/"?2:1)]}),F=!1;C.charCodeAt(0)===47?(F=!0,C=S[0].slice(0,-1)+C):F=C.indexOf("/")!==-1;var I=C.toUpperCase(),Y=F===!0?S.indexOf(I):A.indexOf(I);if(Y!==-1)return w.FileIndex[Y];var ne=!I.match(Ac);for(I=I.replace(Tr,""),ne&&(I=I.replace(Ac,"!")),Y=0;Y<S.length;++Y)if((ne?S[Y].replace(Ac,"!"):S[Y]).replace(Tr,"")==I||(ne?A[Y].replace(Ac,"!"):A[Y]).replace(Tr,"")==I)return w.FileIndex[Y];return null}var X=64,me=-2,Ce="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],Ae="00000000000000000000000000000000",Se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:me,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function qe(w,C,S){d();var A=re(w,S);f.writeFileSync(C,A)}function pe(w){for(var C=new Array(w.length),S=0;S<w.length;++S)C[S]=String.fromCharCode(w[S]);return C.join("")}function Fe(w,C){var S=re(w,C);switch(C&&C.type||"buffer"){case"file":return d(),f.writeFileSync(C.filename,S),S;case"binary":return typeof S=="string"?S:pe(S);case"base64":return Bb(typeof S=="string"?S:pe(S));case"buffer":if(it)return Buffer.isBuffer(S)?S:Za(S);case"array":return typeof S=="string"?Xn(S):S}return S}var oe;function L(w){try{var C=w.InflateRaw,S=new C;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)oe=w;else throw new Error("zlib does not expose bytesRead")}catch(A){console.error("cannot use native zlib: "+(A.message||A))}}function K(w,C){if(!oe)return Jc(w,C);var S=oe.InflateRaw,A=new S,F=A._processChunk(w.slice(w.l),A._finishFlushFlag);return w.l+=A.bytesRead,F}function W(w){return oe?oe.deflateRawSync(w):He(w)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(w){var C=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(C>>16|C>>8|C)&255}for(var be=typeof Uint8Array<"u",fe=be?new Uint8Array(256):[],Je=0;Je<256;++Je)fe[Je]=ve(Je);function O(w,C){var S=fe[w&255];return C<=8?S>>>8-C:(S=S<<8|fe[w>>8&255],C<=16?S>>>16-C:(S=S<<8|fe[w>>16&255],S>>>24-C))}function ht(w,C){var S=C&7,A=C>>>3;return(w[A]|(S<=6?0:w[A+1]<<8))>>>S&3}function rt(w,C){var S=C&7,A=C>>>3;return(w[A]|(S<=5?0:w[A+1]<<8))>>>S&7}function Ze(w,C){var S=C&7,A=C>>>3;return(w[A]|(S<=4?0:w[A+1]<<8))>>>S&15}function Xe(w,C){var S=C&7,A=C>>>3;return(w[A]|(S<=3?0:w[A+1]<<8))>>>S&31}function we(w,C){var S=C&7,A=C>>>3;return(w[A]|(S<=1?0:w[A+1]<<8))>>>S&127}function gt(w,C,S){var A=C&7,F=C>>>3,I=(1<<S)-1,Y=w[F]>>>A;return S<8-A||(Y|=w[F+1]<<8-A,S<16-A)||(Y|=w[F+2]<<16-A,S<24-A)||(Y|=w[F+3]<<24-A),Y&I}function Tt(w,C,S){var A=C&7,F=C>>>3;return A<=5?w[F]|=(S&7)<<A:(w[F]|=S<<A&255,w[F+1]=(S&7)>>8-A),C+3}function mr(w,C,S){var A=C&7,F=C>>>3;return S=(S&1)<<A,w[F]|=S,C+1}function zr(w,C,S){var A=C&7,F=C>>>3;return S<<=A,w[F]|=S&255,S>>>=8,w[F+1]=S,C+8}function ba(w,C,S){var A=C&7,F=C>>>3;return S<<=A,w[F]|=S&255,S>>>=8,w[F+1]=S&255,w[F+2]=S>>>8,C+16}function Gr(w,C){var S=w.length,A=2*S>C?2*S:C+5,F=0;if(S>=C)return w;if(it){var I=Ub(A);if(w.copy)w.copy(I);else for(;F<w.length;++F)I[F]=w[F];return I}else if(be){var Y=new Uint8Array(A);if(Y.set)Y.set(w);else for(;F<S;++F)Y[F]=w[F];return Y}return w.length=A,w}function Cr(w){for(var C=new Array(w),S=0;S<w;++S)C[S]=0;return C}function Fr(w,C,S){var A=1,F=0,I=0,Y=0,ne=0,Q=w.length,q=be?new Uint16Array(32):Cr(32);for(I=0;I<32;++I)q[I]=0;for(I=Q;I<S;++I)w[I]=0;Q=w.length;var Z=be?new Uint16Array(Q):Cr(Q);for(I=0;I<Q;++I)q[F=w[I]]++,A<F&&(A=F),Z[I]=0;for(q[0]=0,I=1;I<=A;++I)q[I+16]=ne=ne+q[I-1]<<1;for(I=0;I<Q;++I)ne=w[I],ne!=0&&(Z[I]=q[ne+16]++);var ue=0;for(I=0;I<Q;++I)if(ue=w[I],ue!=0)for(ne=O(Z[I],A)>>A-ue,Y=(1<<A+4-ue)-1;Y>=0;--Y)C[ne|Y<<ue]=ue&15|I<<4;return A}var Ir=be?new Uint16Array(512):Cr(512),mi=be?new Uint16Array(32):Cr(32);if(!be){for(var Xt=0;Xt<512;++Xt)Ir[Xt]=0;for(Xt=0;Xt<32;++Xt)mi[Xt]=0}(function(){for(var w=[],C=0;C<32;C++)w.push(5);Fr(w,mi,32);var S=[];for(C=0;C<=143;C++)S.push(8);for(;C<=255;C++)S.push(9);for(;C<=279;C++)S.push(7);for(;C<=287;C++)S.push(8);Fr(S,Ir,288)})();var Xr=function(){for(var C=be?new Uint8Array(32768):[],S=0,A=0;S<Ee.length-1;++S)for(;A<Ee[S+1];++A)C[A]=S;for(;A<32768;++A)C[A]=29;var F=be?new Uint8Array(259):[];for(S=0,A=0;S<ae.length-1;++S)for(;A<ae[S+1];++A)F[A]=S;function I(ne,Q){for(var q=0;q<ne.length;){var Z=Math.min(65535,ne.length-q),ue=q+Z==ne.length;for(Q.write_shift(1,+ue),Q.write_shift(2,Z),Q.write_shift(2,~Z&65535);Z-- >0;)Q[Q.l++]=ne[q++]}return Q.l}function Y(ne,Q){for(var q=0,Z=0,ue=be?new Uint16Array(32768):[];Z<ne.length;){var ge=Math.min(65535,ne.length-Z);if(ge<10){for(q=Tt(Q,q,+(Z+ge==ne.length)),q&7&&(q+=8-(q&7)),Q.l=q/8|0,Q.write_shift(2,ge),Q.write_shift(2,~ge&65535);ge-- >0;)Q[Q.l++]=ne[Z++];q=Q.l*8;continue}q=Tt(Q,q,+(Z+ge==ne.length)+2);for(var Te=0;ge-- >0;){var _e=ne[Z];Te=(Te<<5^_e)&32767;var xe=-1,Le=0;if((xe=ue[Te])&&(xe|=Z&-32768,xe>Z&&(xe-=32768),xe<Z))for(;ne[xe+Le]==ne[Z+Le]&&Le<250;)++Le;if(Le>2){_e=F[Le],_e<=22?q=zr(Q,q,fe[_e+1]>>1)-1:(zr(Q,q,3),q+=5,zr(Q,q,fe[_e-23]>>5),q+=3);var pt=_e<8?0:_e-4>>2;pt>0&&(ba(Q,q,Le-ae[_e]),q+=pt),_e=C[Z-xe],q=zr(Q,q,fe[_e]>>3),q-=3;var or=_e<4?0:_e-2>>1;or>0&&(ba(Q,q,Z-xe-Ee[_e]),q+=or);for(var Ft=0;Ft<Le;++Ft)ue[Te]=Z&32767,Te=(Te<<5^ne[Z])&32767,++Z;ge-=Le-1}else _e<=143?_e=_e+48:q=mr(Q,q,1),q=zr(Q,q,fe[_e]),ue[Te]=Z&32767,++Z}q=zr(Q,q,0)-1}return Q.l=(q+7)/8|0,Q.l}return function(Q,q){return Q.length<8?I(Q,q):Y(Q,q)}}();function He(w){var C=zt(50+Math.floor(w.length*1.1)),S=Xr(w,C);return C.slice(0,S)}var yt=be?new Uint16Array(32768):Cr(32768),pr=be?new Uint16Array(32768):Cr(32768),Ct=be?new Uint16Array(128):Cr(128),Nn=1,as=1;function Ou(w,C){var S=Xe(w,C)+257;C+=5;var A=Xe(w,C)+1;C+=5;var F=Ze(w,C)+4;C+=4;for(var I=0,Y=be?new Uint8Array(19):Cr(19),ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Q=1,q=be?new Uint8Array(8):Cr(8),Z=be?new Uint8Array(8):Cr(8),ue=Y.length,ge=0;ge<F;++ge)Y[B[ge]]=I=rt(w,C),Q<I&&(Q=I),q[I]++,C+=3;var Te=0;for(q[0]=0,ge=1;ge<=Q;++ge)Z[ge]=Te=Te+q[ge-1]<<1;for(ge=0;ge<ue;++ge)(Te=Y[ge])!=0&&(ne[ge]=Z[Te]++);var _e=0;for(ge=0;ge<ue;++ge)if(_e=Y[ge],_e!=0){Te=fe[ne[ge]]>>8-_e;for(var xe=(1<<7-_e)-1;xe>=0;--xe)Ct[Te|xe<<_e]=_e&7|ge<<3}var Le=[];for(Q=1;Le.length<S+A;)switch(Te=Ct[we(w,C)],C+=Te&7,Te>>>=3){case 16:for(I=3+ht(w,C),C+=2,Te=Le[Le.length-1];I-- >0;)Le.push(Te);break;case 17:for(I=3+rt(w,C),C+=3;I-- >0;)Le.push(0);break;case 18:for(I=11+we(w,C),C+=7;I-- >0;)Le.push(0);break;default:Le.push(Te),Q<Te&&(Q=Te);break}var pt=Le.slice(0,S),or=Le.slice(S);for(ge=S;ge<286;++ge)pt[ge]=0;for(ge=A;ge<30;++ge)or[ge]=0;return Nn=Fr(pt,yt,286),as=Fr(or,pr,30),C}function Pu(w,C){if(w[0]==3&&!(w[1]&3))return[_a(C),2];for(var S=0,A=0,F=Ub(C||1<<18),I=0,Y=F.length>>>0,ne=0,Q=0;!(A&1);){if(A=rt(w,S),S+=3,A>>>1)A>>1==1?(ne=9,Q=5):(S=Ou(w,S),ne=Nn,Q=as);else{S&7&&(S+=8-(S&7));var q=w[S>>>3]|w[(S>>>3)+1]<<8;if(S+=32,q>0)for(!C&&Y<I+q&&(F=Gr(F,I+q),Y=F.length);q-- >0;)F[I++]=w[S>>>3],S+=8;continue}for(;;){!C&&Y<I+32767&&(F=Gr(F,I+32767),Y=F.length);var Z=gt(w,S,ne),ue=A>>>1==1?Ir[Z]:yt[Z];if(S+=ue&15,ue>>>=4,!(ue>>>8&255))F[I++]=ue;else{if(ue==256)break;ue-=257;var ge=ue<8?0:ue-4>>2;ge>5&&(ge=0);var Te=I+ae[ue];ge>0&&(Te+=gt(w,S,ge),S+=ge),Z=gt(w,S,Q),ue=A>>>1==1?mi[Z]:pr[Z],S+=ue&15,ue>>>=4;var _e=ue<4?0:ue-2>>1,xe=Ee[ue];for(_e>0&&(xe+=gt(w,S,_e),S+=_e),!C&&Y<Te&&(F=Gr(F,Te+100),Y=F.length);I<Te;)F[I]=F[I-xe],++I}}}return C?[F,S+7>>>3]:[F.slice(0,I),S+7>>>3]}function Jc(w,C){var S=w.slice(w.l||0),A=Pu(S,C);return w.l+=A[1],A[0]}function po(w,C){if(w)typeof console<"u"&&console.error(C);else throw new Error(C)}function go(w,C){var S=w;ur(S,0);var A=[],F=[],I={FileIndex:A,FullPaths:F};D(I,{root:C.root});for(var Y=S.length-4;(S[Y]!=80||S[Y+1]!=75||S[Y+2]!=5||S[Y+3]!=6)&&Y>=0;)--Y;S.l=Y+4,S.l+=4;var ne=S.read_shift(2);S.l+=6;var Q=S.read_shift(4);for(S.l=Q,Y=0;Y<ne;++Y){S.l+=20;var q=S.read_shift(4),Z=S.read_shift(4),ue=S.read_shift(2),ge=S.read_shift(2),Te=S.read_shift(2);S.l+=8;var _e=S.read_shift(4),xe=l(S.slice(S.l+ue,S.l+ue+ge));S.l+=ue+ge+Te;var Le=S.l;S.l=_e+4,Lu(S,q,Z,I,xe),S.l=Le}return I}function Lu(w,C,S,A,F){w.l+=2;var I=w.read_shift(2),Y=w.read_shift(2),ne=o(w);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var Q=w.read_shift(4),q=w.read_shift(4),Z=w.read_shift(4),ue=w.read_shift(2),ge=w.read_shift(2),Te="",_e=0;_e<ue;++_e)Te+=String.fromCharCode(w[w.l++]);if(ge){var xe=l(w.slice(w.l,w.l+ge));(xe[21589]||{}).mt&&(ne=xe[21589].mt),((F||{})[21589]||{}).mt&&(ne=F[21589].mt)}w.l+=ge;var Le=w.slice(w.l,w.l+q);switch(Y){case 8:Le=K(w,Z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Y)}var pt=!1;I&8&&(Q=w.read_shift(4),Q==134695760&&(Q=w.read_shift(4),pt=!0),q=w.read_shift(4),Z=w.read_shift(4)),q!=C&&po(pt,"Bad compressed size: "+C+" != "+q),Z!=S&&po(pt,"Bad uncompressed size: "+S+" != "+Z),vo(A,Te,Le,{unsafe:!0,mt:ne})}function Mu(w,C){var S=C||{},A=[],F=[],I=zt(1),Y=S.compression?8:0,ne=0,Q=!1;Q&&(ne|=8);var q=0,Z=0,ue=0,ge=0,Te=w.FullPaths[0],_e=Te,xe=w.FileIndex[0],Le=[],pt=0;for(q=1;q<w.FullPaths.length;++q)if(_e=w.FullPaths[q].slice(Te.length),xe=w.FileIndex[q],!(!xe.size||!xe.content||_e=="Sh33tJ5")){var or=ue,Ft=zt(_e.length);for(Z=0;Z<_e.length;++Z)Ft.write_shift(1,_e.charCodeAt(Z)&127);Ft=Ft.slice(0,Ft.l),Le[ge]=dN.buf(xe.content,0);var Rr=xe.content;Y==8&&(Rr=W(Rr)),I=zt(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,ne),I.write_shift(2,Y),xe.mt?a(I,xe.mt):I.write_shift(4,0),I.write_shift(-4,ne&8?0:Le[ge]),I.write_shift(4,ne&8?0:Rr.length),I.write_shift(4,ne&8?0:xe.content.length),I.write_shift(2,Ft.length),I.write_shift(2,0),ue+=I.length,A.push(I),ue+=Ft.length,A.push(Ft),ue+=Rr.length,A.push(Rr),ne&8&&(I=zt(12),I.write_shift(-4,Le[ge]),I.write_shift(4,Rr.length),I.write_shift(4,xe.content.length),ue+=I.l,A.push(I)),I=zt(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,ne),I.write_shift(2,Y),I.write_shift(4,0),I.write_shift(-4,Le[ge]),I.write_shift(4,Rr.length),I.write_shift(4,xe.content.length),I.write_shift(2,Ft.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,or),pt+=I.l,F.push(I),pt+=Ft.length,F.push(Ft),++ge}return I=zt(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,ge),I.write_shift(2,ge),I.write_shift(4,pt),I.write_shift(4,ue),I.write_shift(2,0),ha([ha(A),ha(F),I])}var ss={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Bu(w,C){if(w.ctype)return w.ctype;var S=w.name||"",A=S.match(/\.([^\.]+)$/);return A&&ss[A[1]]||C&&(A=(S=C).match(/[\.\\]([^\.\\])+$/),A&&ss[A[1]])?ss[A[1]]:"application/octet-stream"}function Zc(w){for(var C=Bb(w),S=[],A=0;A<C.length;A+=76)S.push(C.slice(A,A+76));return S.join(`\r
`)+`\r
`}function Uu(w){var C=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(q){var Z=q.charCodeAt(0).toString(16).toUpperCase();return"="+(Z.length==1?"0"+Z:Z)});C=C.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),C.charAt(0)==`
`&&(C="=0D"+C.slice(1)),C=C.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],A=C.split(`\r
`),F=0;F<A.length;++F){var I=A[F];if(I.length==0){S.push("");continue}for(var Y=0;Y<I.length;){var ne=76,Q=I.slice(Y,Y+ne);Q.charAt(ne-1)=="="?ne--:Q.charAt(ne-2)=="="?ne-=2:Q.charAt(ne-3)=="="&&(ne-=3),Q=I.slice(Y,Y+ne),Y+=ne,Y<I.length&&(Q+="="),S.push(Q)}}return S.join(`\r
`)}function Wu(w){for(var C=[],S=0;S<w.length;++S){for(var A=w[S];S<=w.length&&A.charAt(A.length-1)=="=";)A=A.slice(0,A.length-1)+w[++S];C.push(A)}for(var F=0;F<C.length;++F)C[F]=C[F].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return Xn(C.join(`\r
`))}function Hu(w,C,S){for(var A="",F="",I="",Y,ne=0;ne<10;++ne){var Q=C[ne];if(!Q||Q.match(/^\s*$/))break;var q=Q.match(/^(.*?):\s*([^\s].*)$/);if(q)switch(q[1].toLowerCase()){case"content-location":A=q[2].trim();break;case"content-type":I=q[2].trim();break;case"content-transfer-encoding":F=q[2].trim();break}}switch(++ne,F.toLowerCase()){case"base64":Y=Xn(hn(C.slice(ne).join("")));break;case"quoted-printable":Y=Wu(C.slice(ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var Z=vo(w,A.slice(S.length),Y,{unsafe:!0});I&&(Z.ctype=I)}function _o(w,C){if(pe(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=C&&C.root||"",A=(it&&Buffer.isBuffer(w)?w.toString("binary"):pe(w)).split(`\r
`),F=0,I="";for(F=0;F<A.length;++F)if(I=A[F],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),S||(S=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),I.slice(0,S.length)!=S););var Y=(A[1]||"").match(/boundary="(.*?)"/);if(!Y)throw new Error("MAD cannot find boundary");var ne="--"+(Y[1]||""),Q=[],q=[],Z={FileIndex:Q,FullPaths:q};D(Z);var ue,ge=0;for(F=0;F<A.length;++F){var Te=A[F];Te!==ne&&Te!==ne+"--"||(ge++&&Hu(Z,A.slice(ue,F),S),ue=F)}return Z}function Vu(w,C){var S=C||{},A=S.boundary||"SheetJS";A="------="+A;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+A.slice(2)+'"',"","",""],I=w.FullPaths[0],Y=I,ne=w.FileIndex[0],Q=1;Q<w.FullPaths.length;++Q)if(Y=w.FullPaths[Q].slice(I.length),ne=w.FileIndex[Q],!(!ne.size||!ne.content||Y=="Sh33tJ5")){Y=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Le){return"_x"+Le.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Le){return"_u"+Le.charCodeAt(0).toString(16)+"_"});for(var q=ne.content,Z=it&&Buffer.isBuffer(q)?q.toString("binary"):pe(q),ue=0,ge=Math.min(1024,Z.length),Te=0,_e=0;_e<=ge;++_e)(Te=Z.charCodeAt(_e))>=32&&Te<128&&++ue;var xe=ue>=ge*4/5;F.push(A),F.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+Y),F.push("Content-Transfer-Encoding: "+(xe?"quoted-printable":"base64")),F.push("Content-Type: "+Bu(ne,Y)),F.push(""),F.push(xe?Uu(Z):Zc(Z))}return F.push(A+`--\r
`),F.join(`\r
`)}function xo(w){var C={};return D(C,w),C}function vo(w,C,S,A){var F=A&&A.unsafe;F||D(w);var I=!F&&at.find(w,C);if(!I){var Y=w.FullPaths[0];C.slice(0,Y.length)==Y?Y=C:(Y.slice(-1)!="/"&&(Y+="/"),Y=(Y+C).replace("//","/")),I={name:i(C),type:2},w.FileIndex.push(I),w.FullPaths.push(Y),F||at.utils.cfb_gc(w)}return I.content=S,I.size=S?S.length:0,A&&(A.CLSID&&(I.clsid=A.CLSID),A.mt&&(I.mt=A.mt),A.ct&&(I.ct=A.ct)),I}function zu(w,C){D(w);var S=at.find(w,C);if(S){for(var A=0;A<w.FileIndex.length;++A)if(w.FileIndex[A]==S)return w.FileIndex.splice(A,1),w.FullPaths.splice(A,1),!0}return!1}function Gu(w,C,S){D(w);var A=at.find(w,C);if(A){for(var F=0;F<w.FileIndex.length;++F)if(w.FileIndex[F]==A)return w.FileIndex[F].name=i(S),w.FullPaths[F]=S,!0}return!1}function Xu(w){V(w,!0)}return r.find=te,r.read=U,r.parse=h,r.write=Fe,r.writeFile=qe,r.utils={cfb_new:xo,cfb_add:vo,cfb_del:zu,cfb_mov:Gu,cfb_gc:Xu,ReadShift:Ic,CheckField:x2,prep_blob:ur,bconcat:ha,use_zlib:L,_deflateRaw:He,_inflateRaw:Jc,consts:Se},r}(),jb;function hN(e){if(typeof jb<"u")return jb.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ui(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function rp(e){for(var r=[],t=ui(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var bu=new Date(1899,11,30,0,0,0);function Vr(e,r){var t=e.getTime();r&&(t-=1462*24*60*60*1e3);var n=bu.getTime()+(e.getTimezoneOffset()-bu.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var t2=new Date,mN=bu.getTime()+(t2.getTimezoneOffset()-bu.getTimezoneOffset())*6e4,Kb=t2.getTimezoneOffset();function Fu(e){var r=new Date;return r.setTime(e*24*60*60*1e3+mN),r.getTimezoneOffset()!==Kb&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Kb)*6e4),r}function pN(e){var r=0,t=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(t=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}r+=t*parseInt(i[a],10)}return r}var Yb=new Date("2017-02-19T19:06:09.000Z"),r2=isNaN(Yb.getFullYear())?new Date("2/19/17"):Yb,gN=r2.getFullYear()==2017;function sr(e,r){var t=new Date(e);if(gN)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(r2.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Qa(e,r){if(it&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Fc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Fc(Vw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Fc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Fc(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return t[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function dr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=dr(e[t]));return r}function Ot(e,r){for(var t="";t.length<r;)t+=e;return t}function Kn(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return t=-t,a}),!isNaN(r=Number(n)))?r/t:r}var _N=["january","february","march","april","may","june","july","august","september","october","november","december"];function co(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),i=r.getMonth(),a=r.getDate();if(isNaN(a))return t;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&_N.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||a>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var xN=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(e||typeof n=="string")return t.split(n);for(var a=t.split(n),o=[a[0]],l=1;l<a.length;++l)o.push(i),o.push(a[l]);return o}}();function n2(e){return e?e.content&&e.type?Qa(e.content,!0):e.data?Sc(e.data):e.asNodeBuffer&&it?Sc(e.asNodeBuffer().toString("binary")):e.asBinary?Sc(e.asBinary()):e._data&&e._data.getContent?Sc(Qa(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function i2(e){if(!e)return null;if(e.data)return Wm(e.data);if(e.asNodeBuffer&&it)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Wm(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function vN(e){return e&&e.name.slice(-4)===".bin"?i2(e):n2(e)}function Fn(e,r){for(var t=e.FullPaths||ui(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<t.length;++a){var o=t[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[t[a]]:e.FileIndex[a]}return null}function np(e,r){var t=Fn(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function Ht(e,r,t){if(!t)return vN(np(e,r));if(!r)return null;try{return Ht(e,r)}catch{return null}}function dn(e,r,t){if(!t)return n2(np(e,r));if(!r)return null;try{return dn(e,r)}catch{return null}}function a2(e,r,t){if(!t)return i2(np(e,r));if(!r)return null;try{return a2(e,r)}catch{return null}}function qb(e){for(var r=e.FullPaths||ui(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function bN(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return it?n=Za(t):n=WR(t),at.utils.cfb_add(e,r,n)}at.utils.cfb_add(e,r,t)}else e.file(r,t)}function s2(e,r){switch(r.type){case"base64":return at.read(e,{type:"base64"});case"binary":return at.read(e,{type:"binary"});case"buffer":case"array":return at.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Cc(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var o2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,wN=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Qb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,yN=/<[^>]*>/g,Ar=o2.match(Qb)?Qb:yN,EN=/<\w*:/,TN=/<(\/?)\w+:/;function Pe(e,r,t){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(r||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(wN),l=0,f="",d=0,h="",p="",g=1;if(o)for(d=0;d!=o.length;++d){for(p=o[d],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(h=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(g=(i=p.charCodeAt(a+1))==34||i==39?1:0,f=p.slice(a+1+g,p.length-g),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=f,t||(n[h.toLowerCase()]=f);else{var x=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[x]&&h.slice(l-3,l)=="ext")continue;n[x]=f,t||(n[x.toLowerCase()]=f)}}return n}function di(e){return e.replace(TN,"<$1")}var c2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kN=rp(c2),ot=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(l,f){return c2[l]||String.fromCharCode(parseInt(f,l.indexOf("x")>-1?16:10))||l}).replace(r,function(l,f){return String.fromCharCode(parseInt(f,16))});var o=i.indexOf("]]>");return t(i.slice(0,a))+i.slice(a+9,o)+t(i.slice(o+3))}}(),SN=/[&<>'"]/g;var AN=/[\u0000-\u001f]/g;function ip(e){var r=e+"";return r.replace(SN,function(t){return kN[t]}).replace(/\n/g,"<br/>").replace(AN,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Jb=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function At(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Rm(e){for(var r="",t=0,n=0,i=0,a=0,o=0,l=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(i=e.charCodeAt(t++),n>191&&n<224){o=(n&31)<<6,o|=i&63,r+=String.fromCharCode(o);continue}if(a=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(t++),l=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(l&1023))}return r}function Zb(e){var r=_a(2*e.length),t,n,i=1,a=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?t=l:l<224?(t=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(t=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,t=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(r[a++]=o&255,r[a++]=o>>>8,o=0),r[a++]=t%256,r[a++]=t>>>8;return r.slice(0,a).toString("ucs2")}function ew(e){return Za(e,"binary").toString("utf8")}var lu="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",wt=it&&(ew(lu)==Rm(lu)&&ew||Zb(lu)==Rm(lu)&&Zb)||Rm,Fc=it?function(e){return Za(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,i=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Wc=function(){var e={};return function(t,n){var i=t+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),l2=function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),CN=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),FN=/<\/?(?:vt:)?variant>/g,IN=/<(?:vt:)([^>]*)>([\s\S]*)</;function tw(e,r){var t=Pe(e),n=e.match(CN(t.baseType))||[],i=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(a){var o=a.replace(FN,"").match(IN);o&&i.push({v:wt(o[2]),t:o[1]})}),i}var RN=/(^\s|\s$|\n)/;function NN(e){return ui(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function DN(e,r,t){return"<"+e+(t!=null?NN(t):"")+(r!=null?(r.match(RN)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function ap(e){if(it&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return wt(es(Zm(e)));throw new Error("Bad input format: expected Buffer or string")}var Hc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ON={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},PN=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function LN(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),i=e[r+6]&15,a=5;a>=0;--a)i=i*256+e[r+a];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function MN(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,i=0,a=0,o=n?-r:r;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(r)?26985:0);for(var l=0;l<=5;++l,a/=256)e[t+l]=a&255;e[t+6]=(i&15)<<4|a&15,e[t+7]=i>>4|n}var rw=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=t)r.push.apply(r,e[0][n].slice(i,i+t));return r},nw=it?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Za(r)})):rw(e)}:rw,iw=function(e,r,t){for(var n=[],i=r;i<t;i+=2)n.push(String.fromCharCode(Di(e,i)));return n.join("").replace(Tr,"")},Iu=it?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Tr,""):iw(e,r,t)}:iw,aw=function(e,r,t){for(var n=[],i=r;i<r+t;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},f2=it?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):aw(e,r,t)}:aw,sw=function(e,r,t){for(var n=[],i=r;i<t;i++)n.push(String.fromCharCode(no(e,i)));return n.join("")},uo=it?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):sw(r,t,n)}:sw,u2=function(e,r){var t=ar(e,r);return t>0?uo(e,r+4,r+4+t-1):""},sp=u2,d2=function(e,r){var t=ar(e,r);return t>0?uo(e,r+4,r+4+t-1):""},op=d2,h2=function(e,r){var t=2*ar(e,r);return t>0?uo(e,r+4,r+4+t-1):""},cp=h2,m2=function(r,t){var n=ar(r,t);return n>0?Iu(r,t+4,t+4+n):""},lp=m2,p2=function(e,r){var t=ar(e,r);return t>0?uo(e,r+4,r+4+t):""},fp=p2,g2=function(e,r){return LN(e,r)},wu=g2,_2=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};it&&(sp=function(r,t){if(!Buffer.isBuffer(r))return u2(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},op=function(r,t){if(!Buffer.isBuffer(r))return d2(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},cp=function(r,t){if(!Buffer.isBuffer(r))return h2(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},lp=function(r,t){if(!Buffer.isBuffer(r))return m2(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},fp=function(r,t){if(!Buffer.isBuffer(r))return p2(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},wu=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):g2(r,t)},_2=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});function BN(){Iu=function(e,r,t){return dt.utils.decode(1200,e.slice(r,t)).replace(Tr,"")},uo=function(e,r,t){return dt.utils.decode(65001,e.slice(r,t))},sp=function(e,r){var t=ar(e,r);return t>0?dt.utils.decode(oo,e.slice(r+4,r+4+t-1)):""},op=function(e,r){var t=ar(e,r);return t>0?dt.utils.decode(fi,e.slice(r+4,r+4+t-1)):""},cp=function(e,r){var t=2*ar(e,r);return t>0?dt.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},lp=function(e,r){var t=ar(e,r);return t>0?dt.utils.decode(1200,e.slice(r+4,r+4+t)):""},fp=function(e,r){var t=ar(e,r);return t>0?dt.utils.decode(65001,e.slice(r+4,r+4+t)):""}}typeof dt<"u"&&BN();var no=function(e,r){return e[r]},Di=function(e,r){return e[r+1]*256+e[r]},UN=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},ar=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},$a=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},WN=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Ic(e,r){var t="",n,i,a=[],o,l,f,d;switch(r){case"dbcs":if(d=this.l,it&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(Di(this,d)),d+=2;e*=2;break;case"utf8":t=uo(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Iu(this,this.l,this.l+e);break;case"wstr":if(typeof dt<"u")t=dt.utils.decode(fi,this.slice(this.l,this.l+2*e));else return Ic.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":t=sp(this,this.l),e=4+ar(this,this.l);break;case"lpstr-cp":t=op(this,this.l),e=4+ar(this,this.l);break;case"lpwstr":t=cp(this,this.l),e=4+2*ar(this,this.l);break;case"lpp4":e=4+ar(this,this.l),t=lp(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ar(this,this.l),t=fp(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(o=no(this,this.l+e++))!==0;)a.push(cu(o));t=a.join("");break;case"_wstr":for(e=0,t="";(o=Di(this,this.l+e))!==0;)a.push(cu(o)),e+=2;e+=2,t=a.join("");break;case"dbcs-cont":for(t="",d=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=no(this,d),this.l=d+1,l=Ic.call(this,e-f,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(cu(Di(this,d))),d+=2}t=a.join(""),e*=2;break;case"cpstr":if(typeof dt<"u"){t=dt.utils.decode(fi,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",d=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=no(this,d),this.l=d+1,l=Ic.call(this,e-f,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(cu(no(this,d))),d+=1}t=a.join("");break;default:switch(e){case 1:return n=no(this,this.l),this.l++,n;case 2:return n=(r==="i"?UN:Di)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?$a:WN)(this,this.l),this.l+=4,n):(i=ar(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return e==8?i=wu(this,this.l):i=wu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=f2(this,this.l,e);break}}return this.l+=e,t}var HN=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},VN=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},zN=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function GN(e,r,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=r.length;++i)zN(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if(t==="sbcs"){if(typeof dt<"u"&&oo==874)for(i=0;i!=r.length;++i){var a=dt.utils.encode(oo,r.charAt(i));this[this.l+i]=a[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;n=r.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var l=r.charCodeAt(i);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,HN(this,r,this.l);break;case 8:if(n=8,t==="f"){MN(this,r,this.l);break}case 16:break;case-4:n=4,VN(this,r,this.l);break}return this.l+=n,this}function x2(e,r){var t=f2(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function ur(e,r){e.l=r,e.read_shift=Ic,e.chk=x2,e.write_shift=GN}function Sr(e,r){e.l+=r}function zt(e){var r=_a(e);return ur(r,0),r}function Mi(e,r,t){if(e){var n,i,a;ur(e,e.l||0);for(var o=e.length,l=0,f=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=Au[l]||Au[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;f=e.l+a;var h=d.f&&d.f(e,a,t);if(e.l=f,r(h,d,l))return}}}function Hm(){var e=[],r=it?256:2048,t=function(d){var h=zt(d);return ur(h,0),h},n=t(r),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(d){return n&&d<n.length-n.l?n:(i(),n=t(Math.max(d+1,r)))},o=function(){return i(),ha(e)},l=function(d){i(),n=d,n.l==null&&(n.l=n.length),a(r)};return{next:a,push:l,end:o,_bufs:e}}function Rc(e,r,t){var n=dr(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function ow(e,r,t){var n=dr(e);return n.s=Rc(n.s,r.s,t),n.e=Rc(n.e,r.s,t),n}function Nc(e,r){if(e.cRel&&e.c<0)for(e=dr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=dr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Be(e);return!e.cRel&&e.cRel!=null&&(t=jN(t)),!e.rRel&&e.rRel!=null&&(t=XN(t)),t}function Nm(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Qt(e.s.c)+":"+(e.e.cRel?"":"$")+Qt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+hr(e.s.r)+":"+(e.e.rRel?"":"$")+hr(e.e.r):Nc(e.s,r.biff)+":"+Nc(e.e,r.biff)}function up(e){return parseInt($N(e),10)-1}function hr(e){return""+(e+1)}function XN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $N(e){return e.replace(/\$(\d+)$/,"$1")}function dp(e){for(var r=KN(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function Qt(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function jN(e){return e.replace(/^([A-Z])/,"$$$1")}function KN(e){return e.replace(/^\$([A-Z])/,"$1")}function YN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Hr(e){for(var r=0,t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:r-1}}function Be(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function ho(e){var r=e.indexOf(":");return r==-1?{s:Hr(e),e:Hr(e)}:{s:Hr(e.slice(0,r)),e:Hr(e.slice(r+1))}}function st(e,r){return typeof r>"u"||typeof r=="number"?st(e.s,e.e):(typeof e!="string"&&(e=Be(e)),typeof r!="string"&&(r=Be(r)),e==r?e:e+":"+r)}function Pt(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,a=e.length;for(t=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.s.c=--t,t=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(r.s.r=--t,n===a||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.e.c=--t,t=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return r.e.r=--t,r}function cw(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=In(e.z,t?Vr(r):r)}catch{}try{return e.w=In((e.XF||{}).numFmtId||(t?14:0),t?Vr(r):r)}catch{return""+r}}function Li(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?ns[e.v]||e.v:r==null?cw(e,e.v):cw(e,r))}function va(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function v2(e,r,t){var n=t||{},i=e?Array.isArray(e):n.dense;Gt!=null&&i==null&&(i=Gt);var a=e||(i?[]:{}),o=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?Hr(n.origin):n.origin;o=f.r,l=f.c}a["!ref"]||(a["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var h=Pt(a["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(d.e.r=o=h.e.r+1)}for(var p=0;p!=r.length;++p)if(r[p]){if(!Array.isArray(r[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=r[p].length;++g)if(!(typeof r[p][g]>"u")){var x={v:r[p][g]},v=o+p,_=l+g;if(d.s.r>v&&(d.s.r=v),d.s.c>_&&(d.s.c=_),d.e.r<v&&(d.e.r=v),d.e.c<_&&(d.e.c=_),r[p][g]&&typeof r[p][g]=="object"&&!Array.isArray(r[p][g])&&!(r[p][g]instanceof Date))x=r[p][g];else if(Array.isArray(x.v)&&(x.f=r[p][g][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||ze[14],n.cellDates?(x.t="d",x.w=In(x.z,Vr(x.v))):(x.t="n",x.v=Vr(x.v),x.w=In(x.z,x.v))):x.t="s";if(i)a[v]||(a[v]=[]),a[v][_]&&a[v][_].z&&(x.z=a[v][_].z),a[v][_]=x;else{var y=Be({c:_,r:v});a[y]&&a[y].z&&(x.z=a[y].z),a[y]=x}}}return d.s.c<1e7&&(a["!ref"]=st(d)),a}function mo(e,r){return v2(null,e,r)}function qN(e){return e.read_shift(4,"i")}function kr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function QN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hp(e,r){var t=e.l,n=e.read_shift(1),i=kr(e),a=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),f=0;f!=l;++f)a.push(QN(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=t+r,o}var JN=hp;function Rn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function ts(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var ZN=kr;function mp(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var eD=kr,Vm=mp;function pp(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var i=n===0?wu([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):$a(r,0)>>2;return t?i/100:i}function b2(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var rs=b2;function yr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function tD(e){var r={},t=e.read_shift(1),n=t>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=i;var d=Ya[i];d&&(r.rgb=zc(d));break;case 2:r.rgb=zc([o,l,f]);break;case 3:r.theme=i;break}return a!=0&&(r.tint=a>0?a/32767:a/32768),r}function rD(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function w2(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function nD(e){return w2(e,1)}function iD(e){return w2(e,2)}var gp=2,Zr=3,fu=11,lw=12,yu=19;var uu=64,aD=65,sD=71;var oD=4108,cD=4126,ir=80,y2=81,lD=[ir,y2],fD={1:{n:"CodePage",t:gp},2:{n:"Category",t:ir},3:{n:"PresentationFormat",t:ir},4:{n:"ByteCount",t:Zr},5:{n:"LineCount",t:Zr},6:{n:"ParagraphCount",t:Zr},7:{n:"SlideCount",t:Zr},8:{n:"NoteCount",t:Zr},9:{n:"HiddenCount",t:Zr},10:{n:"MultimediaClipCount",t:Zr},11:{n:"ScaleCrop",t:fu},12:{n:"HeadingPairs",t:oD},13:{n:"TitlesOfParts",t:cD},14:{n:"Manager",t:ir},15:{n:"Company",t:ir},16:{n:"LinksUpToDate",t:fu},17:{n:"CharacterCount",t:Zr},19:{n:"SharedDoc",t:fu},22:{n:"HyperlinksChanged",t:fu},23:{n:"AppVersion",t:Zr,p:"version"},24:{n:"DigSig",t:aD},26:{n:"ContentType",t:ir},27:{n:"ContentStatus",t:ir},28:{n:"Language",t:ir},29:{n:"Version",t:ir},255:{},2147483648:{n:"Locale",t:yu},2147483651:{n:"Behavior",t:yu},1919054434:{}},uD={1:{n:"CodePage",t:gp},2:{n:"Title",t:ir},3:{n:"Subject",t:ir},4:{n:"Author",t:ir},5:{n:"Keywords",t:ir},6:{n:"Comments",t:ir},7:{n:"Template",t:ir},8:{n:"LastAuthor",t:ir},9:{n:"RevNumber",t:ir},10:{n:"EditTime",t:uu},11:{n:"LastPrinted",t:uu},12:{n:"CreatedDate",t:uu},13:{n:"ModifiedDate",t:uu},14:{n:"PageCount",t:Zr},15:{n:"WordCount",t:Zr},16:{n:"CharCount",t:Zr},17:{n:"Thumbnail",t:sD},18:{n:"Application",t:ir},19:{n:"DocSecurity",t:Zr},255:{},2147483648:{n:"Locale",t:yu},2147483651:{n:"Behavior",t:yu},1919054434:{}},fw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},dD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function hD(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var mD=hD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ya=dr(mD),ns={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},E2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},uw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function pD(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function gD(e){var r=pD();if(!e||!e.match)return r;var t={};if((e.match(Ar)||[]).forEach(function(n){var i=Pe(n);switch(i[0].replace(EN,"<")){case"<?xml":break;case"<Types":r.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":r[uw[i.ContentType]]!==void 0&&r[uw[i.ContentType]].push(i.PartName);break}}),r.xmlns!==ON.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var Ni={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zm(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Dc(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(Ar)||[]).forEach(function(i){var a=Pe(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:Cc(a.Target,r);t[l]=o,n[a.Id]=o}}),t["!id"]=n,t}var _D="application/vnd.oasis.opendocument.spreadsheet";function xD(e,r){for(var t=ap(e),n,i;n=Hc.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Pe(n[0],!1),i.path=="/"&&i.type!==_D)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var Oc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vD=function(){for(var e=new Array(Oc.length),r=0;r<Oc.length;++r){var t=Oc[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function T2(e){var r={};e=wt(e);for(var t=0;t<Oc.length;++t){var n=Oc[t],i=e.match(vD[t]);i!=null&&i.length>0&&(r[n[1]]=ot(i[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=sr(r[n[1]]))}return r}var bD=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function k2(e,r,t,n){var i=[];if(typeof e=="string")i=tw(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(h){return{v:h}}));var o=typeof r=="string"?tw(r,n).map(function(h){return h.v}):r,l=0,f=0;if(o.length>0)for(var d=0;d!==i.length;d+=2){switch(f=+i[d+1].v,i[d].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=o.slice(l,l+f);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":t.NamedRanges=f,t.DefinedNames=o.slice(l,l+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=o.slice(l,l+f);break}l+=f}}function wD(e,r,t){var n={};return r||(r={}),e=wt(e),bD.forEach(function(i){var a=(e.match(Wc(i[0]))||[])[1];switch(i[2]){case"string":a&&(r[i[1]]=ot(a));break;case"bool":r[i[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&k2(n.HeadingPairs,n.TitlesOfParts,r,t),r}var yD=/<[^>]+>[^<]*/g;function ED(e,r){var t={},n="",i=e.match(yD);if(i)for(var a=0;a!=i.length;++a){var o=i[a],l=Pe(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ot(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),d=f[0].slice(4),h=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":t[n]=ot(h);break;case"bool":t[n]=At(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(h);break;case"filetime":case"date":t[n]=sr(h);break;case"cy":case"error":t[n]=ot(h);break;default:if(d.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,f)}}else if(o.slice(0,2)!=="</"){if(r.WTF)throw new Error(o)}}}return t}var TD={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Dm;function kD(e,r,t){Dm||(Dm=rp(TD)),r=Dm[r]||r,e[r]=t}function _p(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function S2(e,r,t){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return i}function A2(e,r,t){var n=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(n.length+1&3)&3),n}function C2(e,r,t){return r===31?A2(e):S2(e,r,t)}function Gm(e,r,t){return C2(e,r,t===!1?0:4)}function SD(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return C2(e,r,0)}function AD(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var i=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Tr,""),e.l-i&2&&(e.l+=2)}return t}function CD(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Tr,"");return t}function FD(e){var r=e.l,t=Eu(e,y2);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Eu(e,Zr);return[t,n]}function ID(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(FD(e));return t}function dw(e,r){for(var t=e.read_shift(4),n={},i=0;i!=t;++i){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,r===1200?"utf16le":"utf8").replace(Tr,"").replace(Ac,"!"),r===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function F2(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function RD(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Eu(e,r,t){var n=e.read_shift(2),i,a=t||{};if(e.l+=2,r!==lw&&n!==r&&lD.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===lw?n:r){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return S2(e,n,4).replace(Tr,"");case 31:return A2(e);case 64:return _p(e);case 65:return F2(e);case 71:return RD(e);case 80:return Gm(e,n,!a.raw).replace(Tr,"");case 81:return SD(e,n).replace(Tr,"");case 4108:return ID(e);case 4126:case 4127:return n==4127?AD(e):CD(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function hw(e,r){var t=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0,l=0,f=-1,d={};for(o=0;o!=i;++o){var h=e.read_shift(4),p=e.read_shift(4);a[o]=[h,p+t]}a.sort(function(R,T){return R[1]-T[1]});var g={};for(o=0;o!=i;++o){if(e.l!==a[o][1]){var x=!0;if(o>0&&r)switch(r[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,x=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],x=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],x=!1);break}if((!r||o==0)&&e.l<=a[o][1]&&(x=!1,e.l=a[o][1]),x)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(r){var v=r[a[o][0]];if(g[v.n]=Eu(e,v.t,{raw:!0}),v.p==="version"&&(g[v.n]=String(g[v.n]>>16)+"."+("0000"+String(g[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(g[v.n]){case 0:g[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:$n(l=g[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[v.n])}}else if(a[o][0]===1){if(l=g.CodePage=Eu(e,gp),$n(l),f!==-1){var _=e.l;e.l=a[f][1],d=dw(e,l),e.l=_}}else if(a[o][0]===0){if(l===0){f=o,e.l=a[o+1][1];continue}d=dw(e,l)}else{var y=d[a[o][0]],N;switch(e[e.l]){case 65:e.l+=4,N=F2(e);break;case 30:e.l+=4,N=Gm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,N=Gm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,N=e.read_shift(4,"i");break;case 19:e.l+=4,N=e.read_shift(4);break;case 5:e.l+=4,N=e.read_shift(8,"f");break;case 11:e.l+=4,N=Bt(e,4);break;case 64:e.l+=4,N=sr(_p(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[y]=N}}return e.l=t+n,g}function mw(e,r,t){var n=e.content;if(!n)return{};ur(n,0);var i,a,o,l,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),h=n.read_shift(16);if(h!==at.utils.consts.HEADER_CLSID&&h!==t)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),f=n.read_shift(4));var p=hw(n,r),g={SystemIdentifier:d};for(var x in p)g[x]=p[x];if(g.FMTID=a,i===1)return g;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var v;try{v=hw(n,null)}catch{}for(x in v)g[x]=v[x];return g.FMTID=[a,o],g}function da(e,r){return e.read_shift(r),null}function ND(e,r,t){for(var n=[],i=e.l+r;e.l<i;)n.push(t(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Bt(e,r){return e.read_shift(r)===1}function Vt(e){return e.read_shift(2,"u")}function I2(e,r){return ND(e,r,Vt)}function DD(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function jc(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",a=fi;if(t&&t.biff>=8&&(fi=1200),!t||t.biff==8){var o=e.read_shift(1);o&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var l=n?e.read_shift(n,i):"";return fi=a,l}function OD(e){var r=fi;fi=1200;var t=e.read_shift(2),n=e.read_shift(1),i=n&4,a=n&8,o=1+(n&1),l=0,f,d={};a&&(l=e.read_shift(2)),i&&(f=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",p=t===0?"":e.read_shift(t,h);return a&&(e.l+=4*l),i&&(e.l+=f),d.t=p,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),fi=r,d}function Ja(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function Kc(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):Ja(e,n,t)}function is(e,r,t){if(t.biff>5)return Kc(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function PD(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function LD(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var i=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Tr,"");return n&&(e.l+=24),i}function MD(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(Tr,"");return t+o}function BD(e,r){var t=e.read_shift(16);switch(r-=16,t){case"e0c9ea79f9bace118c8200aa004ba90b":return LD(e,r);case"0303000000000000c000000000000046":return MD(e,r);default:throw new Error("Unsupported Moniker "+t)}}function du(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Tr,""):"";return t}function UD(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,o,l,f,d="",h,p;i&16&&(a=du(e,t-e.l)),i&128&&(o=du(e,t-e.l)),(i&257)===257&&(l=du(e,t-e.l)),(i&257)===1&&(f=BD(e,t-e.l)),i&8&&(d=du(e,t-e.l)),i&32&&(h=e.read_shift(16)),i&64&&(p=_p(e)),e.l=t;var g=o||l||f||"";g&&d&&(g+="#"+d),g||(g="#"+d),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var x={Target:g};return h&&(x.guid=h),p&&(x.time=p),a&&(x.Tooltip=a),x}function R2(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[r,t,n,i]}function N2(e,r){var t=R2(e,r);return t[3]=0,t}function hi(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function WD(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function HD(e,r,t){return r===0?"":is(e,r,t)}function VD(e,r,t){var n=t.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,a,o]}function D2(e){var r=e.read_shift(2),t=pp(e);return[r,t]}function zD(e,r,t){e.l+=4,r-=4;var n=e.l+r,i=jc(e,r,t),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function Ru(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r},e:{c:i,r:t}}}function O2(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r},e:{c:i,r:t}}}var GD=O2;function P2(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function XD(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function $D(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function br(e){e.l+=2,e.l+=e.read_shift(2)}var jD={0:br,4:br,5:br,6:br,7:$D,8:br,9:br,10:br,11:br,12:br,13:XD,14:br,15:br,16:br,17:br,18:br,19:br,20:br,21:P2};function KD(e,r){for(var t=e.l+r,n=[];e.l<t;){var i=e.read_shift(2);e.l-=2;try{n.push(jD[i](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function hu(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function YD(e,r){return r===0||e.read_shift(2),1200}function qD(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,i=is(e,0,t);return e.read_shift(r+n-e.l),i}function QD(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function JD(e,r,t){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=jc(e,0,t);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function ZD(e,r){for(var t=e.l+r,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0;o!=i&&e.l<t;++o)a.push(OD(e));return a.Count=n,a.Unique=i,a}function eO(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function tO(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function rO(e){var r=WD(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function nO(e){return e.read_shift(2),e.read_shift(4)}function pw(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function iO(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2);return{Pos:[r,t],Dim:[n,i],Flags:a,CurTab:o,FirstTab:l,Selected:f,TabRatio:d}}function aO(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function sO(){}function oO(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=jc(e,0,t),n}function cO(e){var r=hi(e);return r.isst=e.read_shift(4),r}function lO(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,i=hi(e,6);t.biff==2&&e.l++;var a=Kc(e,n-e.l,t);return i.val=a,i}function fO(e,r,t){var n=e.read_shift(2),i=is(e,0,t);return[n,i]}var uO=is;function gw(e,r,t){var n=e.l+r,i=t.biff==8||!t.biff?4:2,a=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),f=e.read_shift(2);return e.l=n,{s:{r:a,c:l},e:{r:o,c:f}}}function dO(e){var r=e.read_shift(2),t=e.read_shift(2),n=D2(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function hO(e,r){for(var t=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<t;)a.push(D2(e));if(e.l!==t)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function mO(e,r){for(var t=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<t;)a.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function pO(e,r,t,n){var i={},a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),f=e.read_shift(2);return i.patternType=dD[l>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=f&127,i.icvBack=f>>7&127,i.fsxButton=f>>14&1),i}function gO(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=pO(e,r,n.fStyle,t),n}function _O(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function _w(e,r,t){var n=hi(e,6);(t.biff==2||r==9)&&++e.l;var i=DD(e,2);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function xO(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=hi(e,6),i=yr(e,8);return n.val=i,n}var xw=HD;function vO(e,r,t){var n=e.l+r,i=e.read_shift(2),a=e.read_shift(2);if(t.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=Ja(e,a),l=[];n>e.l;)l.push(Kc(e));return[a,i,o,l]}function vw(e,r,t){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=zD(e,r-2,t)),a.body=i||e.read_shift(r-2),typeof i=="string"&&(a.Name=i),a}var bO=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function bw(e,r,t){var n=e.l+r,i=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),f=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var d=Ja(e,o,t);i&32&&(d=bO[d.charCodeAt(0)]);var h=n-e.l;t&&t.biff==2&&--h;var p=n==e.l||l===0||!(h>0)?[]:tL(e,h,t,l);return{chKey:a,Name:d,itab:f,rgce:p}}function L2(e,r,t){if(t.biff<8)return wO(e,r,t);for(var n=[],i=e.l+r,a=e.read_shift(t.biff>8?4:2);a--!==0;)n.push(VD(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function wO(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=jc(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function yO(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),i=e.read_shift(2),a=Ja(e,n,t),o=Ja(e,i,t);return[a,o]}function EO(e,r,t){var n=O2(e,6);e.l++;var i=e.read_shift(1);return r-=8,[rL(e,r,t),i,n]}function ww(e,r,t){var n=GD(e,6);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,Z6(e,r,t,n)]}function TO(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function kO(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=is(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,a]}}function SO(e,r,t){return kO(e,r,t)}function AO(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(Ru(e,r));return t}function CO(e,r,t){if(t&&t.biff<8)return IO(e,r,t);var n=P2(e,22),i=KD(e,r-22,n[1]);return{cmo:n,ft:i}}var FO={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=t,{fmt:n}}};function IO(e,r,t){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var o=[];return o.push((FO[n]||Sr)(e,r,t)),{cmo:[i,n,a],ft:o}}function RO(e,r,t){var n=e.l,i="";try{e.l+=4;var a=(t.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=PD(e,6,t);var l=e.read_shift(2);e.read_shift(2),Vt(e,2);var f=e.read_shift(2);e.l+=f;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var h=e[e.l],p=Ja(e,e.lens[d+1]-e.lens[d]-1);if(i+=p,i.length>=(h?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+r,{t:i}}catch{return e.l=n+r,{t:i}}}function NO(e,r){var t=Ru(e,8);e.l+=16;var n=UD(e,r-24);return[t,n]}function DO(e,r){e.read_shift(2);var t=Ru(e,8),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Tr,""),[t,n]}function OO(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=fw[t]||t,t=e.read_shift(2),r[1]=fw[t]||t,r}function PO(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(N2(e,8));return t}function LO(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(N2(e,8));return t}function MO(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function M2(e,r,t){if(!t.cellStyles)return Sr(e,r);var n=t&&t.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var d={s:i,e:a,w:o,ixfe:l,flags:f};return(t.biff>=5||!t.biff)&&(d.level=f>>8&7),d}function BO(e,r){var t={};return r<32||(e.l+=16,t.header=yr(e,8),t.footer=yr(e,8),e.l+=2),t}function UO(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var WO=hi,HO=I2,VO=Kc;function zO(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function GO(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=hi(e,6);++e.l;var i=is(e,r-7,t);return n.t="str",n.val=i,n}function XO(e){var r=hi(e,6);++e.l;var t=yr(e,8);return r.t="n",r.val=t,r}function $O(e){var r=hi(e,6);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function jO(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function KO(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function YO(e,r,t){var n=e.l+r,i=hi(e,6),a=e.read_shift(2),o=Ja(e,a,t);return e.l=n,i.t="str",i.val=o,i}var qO=[2,3,48,49,131,139,140,245],yw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=rp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(l,f){var d=[],h=_a(1);switch(f.type){case"base64":h=Xn(hn(l));break;case"binary":h=Xn(l);break;case"buffer":case"array":h=l;break}ur(h,0);var p=h.read_shift(1),g=!!(p&136),x=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:x=!0,g=!0;break;case 49:x=!0,g=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var _=0,y=521;p==2&&(_=h.read_shift(2)),h.l+=3,p!=2&&(_=h.read_shift(4)),_>1048576&&(_=1e6),p!=2&&(y=h.read_shift(2));var N=h.read_shift(2),R=f.codepage||1252;p!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(R=e[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var T=[],z={},J=Math.min(h.length,p==2?521:y-10-(x?264:0)),U=v?32:11;h.l<J&&h[h.l]!=13;)switch(z={},z.name=dt.utils.decode(R,h.slice(h.l,h.l+U)).replace(/[\u0000\r\n].*$/g,""),h.l+=U,z.type=String.fromCharCode(h.read_shift(1)),p!=2&&!v&&(z.offset=h.read_shift(4)),z.len=h.read_shift(1),p==2&&(z.offset=h.read_shift(2)),z.dec=h.read_shift(1),z.name.length&&T.push(z),p!=2&&(h.l+=v?13:14),z.type){case"B":(!x||z.len!=8)&&f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(h[h.l]!==13&&(h.l=y-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=y;var D=0,j=0;for(d[0]=[],j=0;j!=T.length;++j)d[0][j]=T[j].name;for(;_-- >0;){if(h[h.l]===42){h.l+=N;continue}for(++h.l,d[++D]=[],j=0,j=0;j!=T.length;++j){var V=h.slice(h.l,h.l+T[j].len);h.l+=T[j].len,ur(V,0);var re=dt.utils.decode(R,V);switch(T[j].type){case"C":re.trim().length&&(d[D][j]=re.replace(/\s+$/,""));break;case"D":re.length===8?d[D][j]=new Date(+re.slice(0,4),+re.slice(4,6)-1,+re.slice(6,8)):d[D][j]=re;break;case"F":d[D][j]=parseFloat(re.trim());break;case"+":case"I":d[D][j]=v?V.read_shift(-4,"i")^2147483648:V.read_shift(4,"i");break;case"L":switch(re.trim().toUpperCase()){case"Y":case"T":d[D][j]=!0;break;case"N":case"F":d[D][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+re+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));d[D][j]="##MEMO##"+(v?parseInt(re.trim(),10):V.read_shift(4));break;case"N":re=re.replace(/\u0000/g,"").trim(),re&&re!="."&&(d[D][j]=+re||0);break;case"@":d[D][j]=new Date(V.read_shift(-8,"f")-621356832e5);break;case"T":d[D][j]=new Date((V.read_shift(4)-2440588)*864e5+V.read_shift(4));break;case"Y":d[D][j]=V.read_shift(4,"i")/1e4+V.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[D][j]=-V.read_shift(-8,"f");break;case"B":if(x&&T[j].len==8){d[D][j]=V.read_shift(8,"f");break}case"G":case"P":V.l+=T[j].len;break;case"0":if(T[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[j].type)}}}if(p!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=T,d}function n(l,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var h=mo(t(l,d),d);return h["!cols"]=d.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete d.DBF,h}function i(l,f){try{return va(n(l,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,f){var d=f||{};if(+d.codepage>=0&&$n(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=Hm(),p=qm(l,{header:1,raw:!0,cellDates:!0}),g=p[0],x=p.slice(1),v=l["!cols"]||[],_=0,y=0,N=0,R=1;for(_=0;_<g.length;++_){if(((v[_]||{}).DBF||{}).name){g[_]=v[_].DBF.name,++N;continue}if(g[_]!=null){if(++N,typeof g[_]=="number"&&(g[_]=g[_].toString(10)),typeof g[_]!="string")throw new Error("DBF Invalid column name "+g[_]+" |"+typeof g[_]+"|");if(g.indexOf(g[_])!==_){for(y=0;y<1024;++y)if(g.indexOf(g[_]+"_"+y)==-1){g[_]+="_"+y;break}}}}var T=Pt(l["!ref"]),z=[],J=[],U=[];for(_=0;_<=T.e.c-T.s.c;++_){var D="",j="",V=0,re=[];for(y=0;y<x.length;++y)x[y][_]!=null&&re.push(x[y][_]);if(re.length==0||g[_]==null){z[_]="?";continue}for(y=0;y<re.length;++y){switch(typeof re[y]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=re[y]instanceof Date?"D":"C";break;default:j="C"}V=Math.max(V,String(re[y]).length),D=D&&D!=j?"C":j}V>250&&(V=250),j=((v[_]||{}).DBF||{}).type,j=="C"&&v[_].DBF.len>V&&(V=v[_].DBF.len),D=="B"&&j=="N"&&(D="N",U[_]=v[_].DBF.dec,V=v[_].DBF.len),J[_]=D=="C"||j=="N"?V:a[D]||0,R+=J[_],z[_]=D}var te=h.next(32);for(te.write_shift(4,318902576),te.write_shift(4,x.length),te.write_shift(2,296+32*N),te.write_shift(2,R),_=0;_<4;++_)te.write_shift(4,0);for(te.write_shift(4,0|(+r[oo]||3)<<8),_=0,y=0;_<g.length;++_)if(g[_]!=null){var X=h.next(32),me=(g[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,me,"sbcs"),X.write_shift(1,z[_]=="?"?"C":z[_],"sbcs"),X.write_shift(4,y),X.write_shift(1,J[_]||a[z[_]]||0),X.write_shift(1,U[_]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),y+=J[_]||a[z[_]]||0}var Ce=h.next(264);for(Ce.write_shift(4,13),_=0;_<65;++_)Ce.write_shift(4,0);for(_=0;_<x.length;++_){var he=h.next(R);for(he.write_shift(1,0),y=0;y<g.length;++y)if(g[y]!=null)switch(z[y]){case"L":he.write_shift(1,x[_][y]==null?63:x[_][y]?84:70);break;case"B":he.write_shift(8,x[_][y]||0,"f");break;case"N":var Ae="0";for(typeof x[_][y]=="number"&&(Ae=x[_][y].toFixed(U[y]||0)),N=0;N<J[y]-Ae.length;++N)he.write_shift(1,32);he.write_shift(1,Ae,"sbcs");break;case"D":x[_][y]?(he.write_shift(4,("0000"+x[_][y].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(x[_][y].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+x[_][y].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var Se=String(x[_][y]!=null?x[_][y]:"").slice(0,J[y]);for(he.write_shift(1,Se,"sbcs"),N=0;N<J[y]-Se.length;++N)he.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),QO=function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+ui(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,x){var v=e[x];return typeof v=="number"?Mb(v):v},n=function(g,x,v){var _=x.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return _==59?g:Mb(_)};e["|"]=254;function i(g,x){switch(x.type){case"base64":return a(hn(g),x);case"binary":return a(g,x);case"buffer":return a(it&&Buffer.isBuffer(g)?g.toString("binary"):es(g),x);case"array":return a(Qa(g),x)}throw new Error("Unrecognized type "+x.type)}function a(g,x){var v=g.split(/[\n\r]+/),_=-1,y=-1,N=0,R=0,T=[],z=[],J=null,U={},D=[],j=[],V=[],re=0,te;for(+x.codepage>=0&&$n(+x.codepage);N!==v.length;++N){re=0;var X=v[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),me=X.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),Ce=me[0],he;if(X.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":me[1].charAt(0)=="P"&&z.push(X.slice(3).replace(/;;/g,";"));break;case"C":var Ae=!1,Se=!1,qe=!1,pe=!1,Fe=-1,oe=-1;for(R=1;R<me.length;++R)switch(me[R].charAt(0)){case"A":break;case"X":y=parseInt(me[R].slice(1))-1,Se=!0;break;case"Y":for(_=parseInt(me[R].slice(1))-1,Se||(y=0),te=T.length;te<=_;++te)T[te]=[];break;case"K":he=me[R].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(Kn(he))?isNaN(co(he).getDate())||(he=sr(he)):(he=Kn(he),J!==null&&fo(J)&&(he=Fu(he))),typeof dt<"u"&&typeof he=="string"&&(x||{}).type!="string"&&(x||{}).codepage&&(he=dt.utils.decode(x.codepage,he)),Ae=!0;break;case"E":pe=!0;var L=ao(me[R].slice(1),{r:_,c:y});T[_][y]=[T[_][y],L];break;case"S":qe=!0,T[_][y]=[T[_][y],"S5S"];break;case"G":break;case"R":Fe=parseInt(me[R].slice(1))-1;break;case"C":oe=parseInt(me[R].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+X)}if(Ae&&(T[_][y]&&T[_][y].length==2?T[_][y][0]=he:T[_][y]=he,J=null),qe){if(pe)throw new Error("SYLK shared formula cannot have own formula");var K=Fe>-1&&T[Fe][oe];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");T[_][y][1]=j2(K[1],{r:_-Fe,c:y-oe})}break;case"F":var W=0;for(R=1;R<me.length;++R)switch(me[R].charAt(0)){case"X":y=parseInt(me[R].slice(1))-1,++W;break;case"Y":for(_=parseInt(me[R].slice(1))-1,te=T.length;te<=_;++te)T[te]=[];break;case"M":re=parseInt(me[R].slice(1))/20;break;case"F":break;case"G":break;case"P":J=z[parseInt(me[R].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(V=me[R].slice(1).split(" "),te=parseInt(V[0],10);te<=parseInt(V[1],10);++te)re=parseInt(V[2],10),j[te-1]=re===0?{hidden:!0}:{wch:re},lo(j[te-1]);break;case"C":y=parseInt(me[R].slice(1))-1,j[y]||(j[y]={});break;case"R":_=parseInt(me[R].slice(1))-1,D[_]||(D[_]={}),re>0?(D[_].hpt=re,D[_].hpx=Gc(re)):re===0&&(D[_].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+X)}W<1&&(J=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+X)}}return D.length>0&&(U["!rows"]=D),j.length>0&&(U["!cols"]=j),x&&x.sheetRows&&(T=T.slice(0,x.sheetRows)),[T,U]}function o(g,x){var v=i(g,x),_=v[0],y=v[1],N=mo(_,x);return ui(y).forEach(function(R){N[R]=y[R]}),N}function l(g,x){return va(o(g,x),x)}function f(g,x,v,_){var y="C;Y"+(v+1)+";X"+(_+1)+";K";switch(g.t){case"n":y+=g.v||0,g.f&&!g.F&&(y+=";E"+MP(g.f,{r:v,c:_}));break;case"b":y+=g.v?"TRUE":"FALSE";break;case"e":y+=g.w||g.v;break;case"d":y+='"'+(g.w||g.v)+'"';break;case"s":y+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function d(g,x){x.forEach(function(v,_){var y="F;W"+(_+1)+" "+(_+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=ku(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Su(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&g.push(y)})}function h(g,x){x.forEach(function(v,_){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*G2(v.hpx)+";"),y.length>2&&g.push(y+"R"+(_+1))})}function p(g,x){var v=["ID;PWXL;N;E"],_=[],y=Pt(g["!ref"]),N,R=Array.isArray(g),T=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),g["!cols"]&&d(v,g["!cols"]),g["!rows"]&&h(v,g["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var z=y.s.r;z<=y.e.r;++z)for(var J=y.s.c;J<=y.e.c;++J){var U=Be({r:z,c:J});N=R?(g[z]||[])[J]:g[U],!(!N||N.v==null&&(!N.f||N.F))&&_.push(f(N,g,z,J,x))}return v.join(T)+T+_.join(T)+T+"E"+T}return{to_workbook:l,to_sheet:o,from_sheet:p}}(),JO=function(){function e(a,o){switch(o.type){case"base64":return r(hn(a),o);case"binary":return r(a,o);case"buffer":return r(it&&Buffer.isBuffer(a)?a.toString("binary"):es(a),o);case"array":return r(Qa(a),o)}throw new Error("Unrecognized type "+o.type)}function r(a,o){for(var l=a.split(`
`),f=-1,d=-1,h=0,p=[];h!==l.length;++h){if(l[h].trim()==="BOT"){p[++f]=[],d=0;continue}if(!(f<0)){var g=l[h].trim().split(","),x=g[0],v=g[1];++h;for(var _=l[h]||"";(_.match(/["]/g)||[]).length&1&&h<l.length-1;)_+=`
`+l[++h];switch(_=_.trim(),+x){case-1:if(_==="BOT"){p[++f]=[],d=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?p[f][d]=!0:_==="FALSE"?p[f][d]=!1:isNaN(Kn(v))?isNaN(co(v).getDate())?p[f][d]=v:p[f][d]=sr(v):p[f][d]=Kn(v),++d;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),kc&&_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),p[f][d++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),p}function t(a,o){return mo(e(a,o),o)}function n(a,o){return va(t(a,o),o)}var i=function(){var a=function(f,d,h,p,g){f.push(d),f.push(h+","+p),f.push('"'+g.replace(/"/g,'""')+'"')},o=function(f,d,h,p){f.push(d+","+h),f.push(d==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(f){var d=[],h=Pt(f["!ref"]),p,g=Array.isArray(f);a(d,"TABLE",0,1,"sheetjs"),a(d,"VECTORS",0,h.e.r-h.s.r+1,""),a(d,"TUPLES",0,h.e.c-h.s.c+1,""),a(d,"DATA",0,0,"");for(var x=h.s.r;x<=h.e.r;++x){o(d,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var _=Be({r:x,c:v});if(p=g?(f[x]||[])[v]:f[_],!p){o(d,1,0,"");continue}switch(p.t){case"n":var y=kc?p.w:p.v;!y&&p.v!=null&&(y=p.v),y==null?kc&&p.f&&!p.F?o(d,1,0,"="+p.f):o(d,1,0,""):o(d,0,y,"V");break;case"b":o(d,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":o(d,1,0,!kc||isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=In(p.z||ze[14],Vr(sr(p.v)))),kc?o(d,0,p.w,"V"):o(d,1,0,p.w);break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var N=`\r
`,R=d.join(N);return R}}();return{to_workbook:n,to_sheet:t,from_sheet:i}}(),ZO=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(p,g){for(var x=p.split(`
`),v=-1,_=-1,y=0,N=[];y!==x.length;++y){var R=x[y].trim().split(":");if(R[0]==="cell"){var T=Hr(R[1]);if(N.length<=T.r)for(v=N.length;v<=T.r;++v)N[v]||(N[v]=[]);switch(v=T.r,_=T.c,R[2]){case"t":N[v][_]=e(R[3]);break;case"v":N[v][_]=+R[3];break;case"vtf":var z=R[R.length-1];case"vtc":switch(R[3]){case"nl":N[v][_]=!!+R[4];break;default:N[v][_]=+R[4];break}R[2]=="vtf"&&(N[v][_]=[N[v][_],z])}}}return g&&g.sheetRows&&(N=N.slice(0,g.sheetRows)),N}function n(p,g){return mo(t(p,g),g)}function i(p,g){return va(n(p,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(p){if(!p||!p["!ref"])return"";for(var g=[],x=[],v,_="",y=ho(p["!ref"]),N=Array.isArray(p),R=y.s.r;R<=y.e.r;++R)for(var T=y.s.c;T<=y.e.c;++T)if(_=Be({r:R,c:T}),v=N?(p[R]||[])[T]:p[_],!(!v||v.v==null||v.t==="z")){switch(x=["cell",_,"t"],v.t){case"s":case"str":x.push(r(v.v));break;case"n":v.f?(x[2]="vtf",x[3]="n",x[4]=v.v,x[5]=r(v.f)):(x[2]="v",x[3]=v.v);break;case"b":x[2]="vt"+(v.f?"f":"c"),x[3]="nl",x[4]=v.v?"1":"0",x[5]=r(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var z=Vr(sr(v.v));x[2]="vtc",x[3]="nd",x[4]=""+z,x[5]=v.w||In(v.z||ze[14],z);break;case"e":continue}g.push(x.join(":"))}return g.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(p){return[a,o,l,o,d(p),f].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),Vc=function(){function e(h,p,g,x,v){v.raw?p[g][x]=h:h===""||(h==="TRUE"?p[g][x]=!0:h==="FALSE"?p[g][x]=!1:isNaN(Kn(h))?isNaN(co(h).getDate())?p[g][x]=h:p[g][x]=sr(h):p[g][x]=Kn(h))}function r(h,p){var g=p||{},x=[];if(!h||h.length===0)return x;for(var v=h.split(/[\r\n]/),_=v.length-1;_>=0&&v[_].length===0;)--_;for(var y=10,N=0,R=0;R<=_;++R)N=v[R].indexOf(" "),N==-1?N=v[R].length:N++,y=Math.max(y,N);for(R=0;R<=_;++R){x[R]=[];var T=0;for(e(v[R].slice(0,y).trim(),x,R,T,g),T=1;T<=(v[R].length-y)/10+1;++T)e(v[R].slice(y+(T-1)*10,y+T*10).trim(),x,R,T,g)}return g.sheetRows&&(x=x.slice(0,g.sheetRows)),x}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var p={},g=!1,x=0,v=0;x<h.length;++x)(v=h.charCodeAt(x))==34?g=!g:!g&&v in t&&(p[v]=(p[v]||0)+1);v=[];for(x in p)Object.prototype.hasOwnProperty.call(p,x)&&v.push([p[x],x]);if(!v.length){p=n;for(x in p)Object.prototype.hasOwnProperty.call(p,x)&&v.push([p[x],x])}return v.sort(function(_,y){return _[0]-y[0]||n[_[1]]-n[y[1]]}),t[v.pop()[1]]||44}function a(h,p){var g=p||{},x="";Gt!=null&&g.dense==null&&(g.dense=Gt);var v=g.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(x=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(x=h.charAt(4),h=h.slice(6)):x=i(h.slice(0,1024)):g&&g.FS?x=g.FS:x=i(h.slice(0,1024));var y=0,N=0,R=0,T=0,z=0,J=x.charCodeAt(0),U=!1,D=0,j=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var V=g.dateNF!=null?fN(g.dateNF):null;function re(){var te=h.slice(T,z),X={};if(te.charAt(0)=='"'&&te.charAt(te.length-1)=='"'&&(te=te.slice(1,-1).replace(/""/g,'"')),te.length===0)X.t="z";else if(g.raw)X.t="s",X.v=te;else if(te.trim().length===0)X.t="s",X.v=te;else if(te.charCodeAt(0)==61)te.charCodeAt(1)==34&&te.charCodeAt(te.length-1)==34?(X.t="s",X.v=te.slice(2,-1).replace(/""/g,'"')):UP(te)?(X.t="n",X.f=te.slice(1)):(X.t="s",X.v=te);else if(te=="TRUE")X.t="b",X.v=!0;else if(te=="FALSE")X.t="b",X.v=!1;else if(!isNaN(R=Kn(te)))X.t="n",g.cellText!==!1&&(X.w=te),X.v=R;else if(!isNaN(co(te).getDate())||V&&te.match(V)){X.z=g.dateNF||ze[14];var me=0;V&&te.match(V)&&(te=uN(te,g.dateNF,te.match(V)||[]),me=1),g.cellDates?(X.t="d",X.v=sr(te,me)):(X.t="n",X.v=Vr(sr(te,me))),g.cellText!==!1&&(X.w=In(X.z,X.v instanceof Date?Vr(X.v):X.v)),g.cellNF||delete X.z}else X.t="s",X.v=te;if(X.t=="z"||(g.dense?(v[y]||(v[y]=[]),v[y][N]=X):v[Be({c:N,r:y})]=X),T=z+1,j=h.charCodeAt(T),_.e.c<N&&(_.e.c=N),_.e.r<y&&(_.e.r=y),D==J)++N;else if(N=0,++y,g.sheetRows&&g.sheetRows<=y)return!0}e:for(;z<h.length;++z)switch(D=h.charCodeAt(z)){case 34:j===34&&(U=!U);break;case J:case 10:case 13:if(!U&&re())break e;break;default:break}return z-T>0&&re(),v["!ref"]=st(_),v}function o(h,p){return!(p&&p.PRN)||p.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?a(h,p):mo(r(h,p),p)}function l(h,p){var g="",x=p.type=="string"?[0,0,0,0]:kp(h,p);switch(p.type){case"base64":g=hn(h);break;case"binary":g=h;break;case"buffer":p.codepage==65001?g=h.toString("utf8"):p.codepage&&typeof dt<"u"?g=dt.utils.decode(p.codepage,h):g=it&&Buffer.isBuffer(h)?h.toString("binary"):es(h);break;case"array":g=Qa(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+p.type)}return x[0]==239&&x[1]==187&&x[2]==191?g=wt(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=wt(g):p.type=="binary"&&typeof dt<"u"&&p.codepage&&(g=dt.utils.decode(p.codepage,dt.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?ZO.to_sheet(p.type=="string"?g:wt(g),p):o(g,p)}function f(h,p){return va(l(h,p),p)}function d(h){for(var p=[],g=Pt(h["!ref"]),x,v=Array.isArray(h),_=g.s.r;_<=g.e.r;++_){for(var y=[],N=g.s.c;N<=g.e.c;++N){var R=Be({r:_,c:N});if(x=v?(h[_]||[])[N]:h[R],!x||x.v==null){y.push("          ");continue}for(var T=(x.w||(Li(x),x.w)||"").slice(0,10);T.length<10;)T+=" ";y.push(T+(N===0?" ":""))}p.push(y.join(""))}return p.join(`
`)}return{to_workbook:f,to_sheet:l,from_sheet:d}}();function e8(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var i=QO.to_workbook(e,t);return t.WTF=n,i}catch(a){if(t.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Vc.to_workbook(e,r)}}var Pc=function(){function e(L,K,W){if(L){ur(L,L.l||0);for(var B=W.Enum||Fe;L.l<L.length;){var ae=L.read_shift(2),Ee=B[ae]||B[65535],ve=L.read_shift(2),be=L.l+ve,fe=Ee.f&&Ee.f(L,ve,W);if(L.l=be,K(fe,Ee,ae))return}}}function r(L,K){switch(K.type){case"base64":return t(Xn(hn(L)),K);case"binary":return t(Xn(L),K);case"buffer":case"array":return t(L,K)}throw"Unsupported type "+K.type}function t(L,K){if(!L)return L;var W=K||{};Gt!=null&&W.dense==null&&(W.dense=Gt);var B=W.dense?[]:{},ae="Sheet1",Ee="",ve=0,be={},fe=[],Je=[],O={s:{r:0,c:0},e:{r:0,c:0}},ht=W.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)W.Enum=Fe,e(L,function(we,gt,Tt){switch(Tt){case 0:W.vers=we,we>=4096&&(W.qpro=!0);break;case 6:O=we;break;case 204:we&&(Ee=we);break;case 222:Ee=we;break;case 15:case 51:W.qpro||(we[1].v=we[1].v.slice(1));case 13:case 14:case 16:Tt==14&&(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=W.dateNF||ze[14],W.cellDates&&(we[1].t="d",we[1].v=Fu(we[1].v))),W.qpro&&we[3]>ve&&(B["!ref"]=st(O),be[ae]=B,fe.push(ae),B=W.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},ve=we[3],ae=Ee||"Sheet"+(ve+1),Ee="");var mr=W.dense?(B[we[0].r]||[])[we[0].c]:B[Be(we[0])];if(mr){mr.t=we[1].t,mr.v=we[1].v,we[1].z!=null&&(mr.z=we[1].z),we[1].f!=null&&(mr.f=we[1].f);break}W.dense?(B[we[0].r]||(B[we[0].r]=[]),B[we[0].r][we[0].c]=we[1]):B[Be(we[0])]=we[1];break;default:}},W);else if(L[2]==26||L[2]==14)W.Enum=oe,L[2]==14&&(W.qpro=!0,L.l=0),e(L,function(we,gt,Tt){switch(Tt){case 204:ae=we;break;case 22:we[1].v=we[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>ve&&(B["!ref"]=st(O),be[ae]=B,fe.push(ae),B=W.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},ve=we[3],ae="Sheet"+(ve+1)),ht>0&&we[0].r>=ht)break;W.dense?(B[we[0].r]||(B[we[0].r]=[]),B[we[0].r][we[0].c]=we[1]):B[Be(we[0])]=we[1],O.e.c<we[0].c&&(O.e.c=we[0].c),O.e.r<we[0].r&&(O.e.r=we[0].r);break;case 27:we[14e3]&&(Je[we[14e3][0]]=we[14e3][1]);break;case 1537:Je[we[0]]=we[1],we[0]==ve&&(ae=we[1]);break;default:break}},W);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(B["!ref"]=st(O),be[Ee||ae]=B,fe.push(Ee||ae),!Je.length)return{SheetNames:fe,Sheets:be};for(var rt={},Ze=[],Xe=0;Xe<Je.length;++Xe)be[fe[Xe]]?(Ze.push(Je[Xe]||fe[Xe]),rt[Je[Xe]]=be[Je[Xe]]||be[fe[Xe]]):(Ze.push(Je[Xe]),rt[Je[Xe]]={"!ref":"A1"});return{SheetNames:Ze,Sheets:rt}}function n(L,K){var W=K||{};if(+W.codepage>=0&&$n(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Hm(),ae=Pt(L["!ref"]),Ee=Array.isArray(L),ve=[];Gn(B,0,a(1030)),Gn(B,6,f(ae));for(var be=Math.min(ae.e.r,8191),fe=ae.s.r;fe<=be;++fe)for(var Je=hr(fe),O=ae.s.c;O<=ae.e.c;++O){fe===ae.s.r&&(ve[O]=Qt(O));var ht=ve[O]+Je,rt=Ee?(L[fe]||[])[O]:L[ht];if(!(!rt||rt.t=="z"))if(rt.t=="n")(rt.v|0)==rt.v&&rt.v>=-32768&&rt.v<=32767?Gn(B,13,x(fe,O,rt.v)):Gn(B,14,_(fe,O,rt.v));else{var Ze=Li(rt);Gn(B,15,p(fe,O,Ze.slice(0,239)))}}return Gn(B,1),B.end()}function i(L,K){var W=K||{};if(+W.codepage>=0&&$n(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Hm();Gn(B,0,o(L));for(var ae=0,Ee=0;ae<L.SheetNames.length;++ae)(L.Sheets[L.SheetNames[ae]]||{})["!ref"]&&Gn(B,27,pe(L.SheetNames[ae],Ee++));var ve=0;for(ae=0;ae<L.SheetNames.length;++ae){var be=L.Sheets[L.SheetNames[ae]];if(!(!be||!be["!ref"])){for(var fe=Pt(be["!ref"]),Je=Array.isArray(be),O=[],ht=Math.min(fe.e.r,8191),rt=fe.s.r;rt<=ht;++rt)for(var Ze=hr(rt),Xe=fe.s.c;Xe<=fe.e.c;++Xe){rt===fe.s.r&&(O[Xe]=Qt(Xe));var we=O[Xe]+Ze,gt=Je?(be[rt]||[])[Xe]:be[we];if(!(!gt||gt.t=="z"))if(gt.t=="n")Gn(B,23,re(rt,Xe,ve,gt.v));else{var Tt=Li(gt);Gn(B,22,D(rt,Xe,ve,Tt.slice(0,239)))}}++ve}}return Gn(B,1),B.end()}function a(L){var K=zt(2);return K.write_shift(2,L),K}function o(L){var K=zt(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var W=0,B=0,ae=0,Ee=0;Ee<L.SheetNames.length;++Ee){var ve=L.SheetNames[Ee],be=L.Sheets[ve];if(!(!be||!be["!ref"])){++ae;var fe=ho(be["!ref"]);W<fe.e.r&&(W=fe.e.r),B<fe.e.c&&(B=fe.e.c)}}return W>8191&&(W=8191),K.write_shift(2,W),K.write_shift(1,ae),K.write_shift(1,B),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function l(L,K,W){var B={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&W.qpro?(B.s.c=L.read_shift(1),L.l++,B.s.r=L.read_shift(2),B.e.c=L.read_shift(1),L.l++,B.e.r=L.read_shift(2),B):(B.s.c=L.read_shift(2),B.s.r=L.read_shift(2),K==12&&W.qpro&&(L.l+=2),B.e.c=L.read_shift(2),B.e.r=L.read_shift(2),K==12&&W.qpro&&(L.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function f(L){var K=zt(8);return K.write_shift(2,L.s.c),K.write_shift(2,L.s.r),K.write_shift(2,L.e.c),K.write_shift(2,L.e.r),K}function d(L,K,W){var B=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(B[0].c=L.read_shift(1),B[3]=L.read_shift(1),B[0].r=L.read_shift(2),L.l+=2):(B[2]=L.read_shift(1),B[0].c=L.read_shift(2),B[0].r=L.read_shift(2)),B}function h(L,K,W){var B=L.l+K,ae=d(L,K,W);if(ae[1].t="s",W.vers==20768){L.l++;var Ee=L.read_shift(1);return ae[1].v=L.read_shift(Ee,"utf8"),ae}return W.qpro&&L.l++,ae[1].v=L.read_shift(B-L.l,"cstr"),ae}function p(L,K,W){var B=zt(7+W.length);B.write_shift(1,255),B.write_shift(2,K),B.write_shift(2,L),B.write_shift(1,39);for(var ae=0;ae<B.length;++ae){var Ee=W.charCodeAt(ae);B.write_shift(1,Ee>=128?95:Ee)}return B.write_shift(1,0),B}function g(L,K,W){var B=d(L,K,W);return B[1].v=L.read_shift(2,"i"),B}function x(L,K,W){var B=zt(7);return B.write_shift(1,255),B.write_shift(2,K),B.write_shift(2,L),B.write_shift(2,W,"i"),B}function v(L,K,W){var B=d(L,K,W);return B[1].v=L.read_shift(8,"f"),B}function _(L,K,W){var B=zt(13);return B.write_shift(1,255),B.write_shift(2,K),B.write_shift(2,L),B.write_shift(8,W,"f"),B}function y(L,K,W){var B=L.l+K,ae=d(L,K,W);if(ae[1].v=L.read_shift(8,"f"),W.qpro)L.l=B;else{var Ee=L.read_shift(2);z(L.slice(L.l,L.l+Ee),ae),L.l+=Ee}return ae}function N(L,K,W){var B=K&32768;return K&=-32769,K=(B?L:0)+(K>=8192?K-16384:K),(B?"":"$")+(W?Qt(K):hr(K))}var R={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(L,K){ur(L,0);for(var W=[],B=0,ae="",Ee="",ve="",be="";L.l<L.length;){var fe=L[L.l++];switch(fe){case 0:W.push(L.read_shift(8,"f"));break;case 1:Ee=N(K[0].c,L.read_shift(2),!0),ae=N(K[0].r,L.read_shift(2),!1),W.push(Ee+ae);break;case 2:{var Je=N(K[0].c,L.read_shift(2),!0),O=N(K[0].r,L.read_shift(2),!1);Ee=N(K[0].c,L.read_shift(2),!0),ae=N(K[0].r,L.read_shift(2),!1),W.push(Je+O+":"+Ee+ae)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(L.read_shift(2));break;case 6:{for(var ht="";fe=L[L.l++];)ht+=String.fromCharCode(fe);W.push('"'+ht.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:be=W.pop(),ve=W.pop(),W.push(["AND","OR"][fe-20]+"("+ve+","+be+")");break;default:if(fe<32&&T[fe])be=W.pop(),ve=W.pop(),W.push(ve+T[fe]+be);else if(R[fe]){if(B=R[fe][1],B==69&&(B=L[L.l++]),B>W.length){console.error("WK1 bad formula parse 0x"+fe.toString(16)+":|"+W.join("|")+"|");return}var rt=W.slice(-B);W.length-=B,W.push(R[fe][0]+"("+rt.join(",")+")")}else return fe<=7?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=24?console.error("WK1 unsupported op "+fe.toString(16)):fe<=30?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=115?console.error("WK1 unsupported function opcode "+fe.toString(16)):console.error("WK1 unrecognized opcode "+fe.toString(16))}}W.length==1?K[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function J(L){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=L.read_shift(2),K[3]=L[L.l++],K[0].c=L[L.l++],K}function U(L,K){var W=J(L,K);return W[1].t="s",W[1].v=L.read_shift(K-4,"cstr"),W}function D(L,K,W,B){var ae=zt(6+B.length);ae.write_shift(2,L),ae.write_shift(1,W),ae.write_shift(1,K),ae.write_shift(1,39);for(var Ee=0;Ee<B.length;++Ee){var ve=B.charCodeAt(Ee);ae.write_shift(1,ve>=128?95:ve)}return ae.write_shift(1,0),ae}function j(L,K){var W=J(L,K);W[1].v=L.read_shift(2);var B=W[1].v>>1;if(W[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return W[1].v=B,W}function V(L,K){var W=J(L,K),B=L.read_shift(4),ae=L.read_shift(4),Ee=L.read_shift(2);if(Ee==65535)return B===0&&ae===3221225472?(W[1].t="e",W[1].v=15):B===0&&ae===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var ve=Ee&32768;return Ee=(Ee&32767)-16446,W[1].v=(1-ve*2)*(ae*Math.pow(2,Ee+32)+B*Math.pow(2,Ee)),W}function re(L,K,W,B){var ae=zt(14);if(ae.write_shift(2,L),ae.write_shift(1,W),ae.write_shift(1,K),B==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var Ee=0,ve=0,be=0,fe=0;return B<0&&(Ee=1,B=-B),ve=Math.log2(B)|0,B/=Math.pow(2,ve-31),fe=B>>>0,fe&2147483648||(B/=2,++ve,fe=B>>>0),B-=fe,fe|=2147483648,fe>>>=0,B*=Math.pow(2,32),be=B>>>0,ae.write_shift(4,be),ae.write_shift(4,fe),ve+=16383+(Ee?32768:0),ae.write_shift(2,ve),ae}function te(L,K){var W=V(L,14);return L.l+=K-14,W}function X(L,K){var W=J(L,K),B=L.read_shift(4);return W[1].v=B>>6,W}function me(L,K){var W=J(L,K),B=L.read_shift(8,"f");return W[1].v=B,W}function Ce(L,K){var W=me(L,14);return L.l+=K-10,W}function he(L,K){return L[L.l+K-1]==0?L.read_shift(K,"cstr"):""}function Ae(L,K){var W=L[L.l++];W>K-1&&(W=K-1);for(var B="";B.length<W;)B+=String.fromCharCode(L[L.l++]);return B}function Se(L,K,W){if(!(!W.qpro||K<21)){var B=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var ae=L.read_shift(K-21,"cstr");return[B,ae]}}function qe(L,K){for(var W={},B=L.l+K;L.l<B;){var ae=L.read_shift(2);if(ae==14e3){for(W[ae]=[0,""],W[ae][0]=L.read_shift(2);L[L.l];)W[ae][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return W}function pe(L,K){var W=zt(5+L.length);W.write_shift(2,14e3),W.write_shift(2,K);for(var B=0;B<L.length;++B){var ae=L.charCodeAt(B);W[W.l++]=ae>127?95:ae}return W[W.l++]=0,W}var Fe={0:{n:"BOF",f:Vt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:Ae},65535:{n:""}},oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:V},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:te},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:qe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:me},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:r}}();function t8(e){var r={},t=e.match(Ar),n=0,i=!1;if(t)for(;n!=t.length;++n){var a=Pe(t[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;r.cp=Qm[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=a.val;break;case"<sz":r.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":a.rgb&&(r.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return r}var r8=function(){var e=Wc("t"),r=Wc("rPr");function t(a){var o=a.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:ot(o[1])},f=a.match(r);return f&&(l.s=t8(f[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(t).filter(function(l){return l.v})}}(),n8=function(){var r=/(\r\n|\n)/g;function t(i,a,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var f=i.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(a.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&t(i.s,a[0],a[2]),a[0].join("")+a[1].replace(r,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),i8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,a8=/<(?:\w+:)?r>/,s8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function xp(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ot(wt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=wt(e),t&&(n.h=ip(n.t))):e.match(a8)&&(n.r=wt(e),n.t=ot(wt((e.replace(s8,"").match(i8)||[]).join("").replace(Ar,""))),t&&(n.h=n8(r8(n.r)))),n):{t:""}}var o8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,c8=/<(?:\w+:)?(?:si|sstItem)>/g,l8=/<\/(?:\w+:)?(?:si|sstItem)>/;function f8(e,r){var t=[],n="";if(!e)return t;var i=e.match(o8);if(i){n=i[2].replace(c8,"").split(l8);for(var a=0;a!=n.length;++a){var o=xp(n[a].trim(),r);o!=null&&(t[t.length]=o)}i=Pe(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}function u8(e){return[e.read_shift(4),e.read_shift(4)]}function d8(e,r){var t=[],n=!1;return Mi(e,function(a,o,l){switch(l){case 159:t.Count=a[0],t.Unique=a[1];break;case 19:t.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t}function B2(e){if(typeof dt<"u")return dt.utils.encode(oo,e);for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Pi(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function h8(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Pi(e,4),r.U=Pi(e,4),r.W=Pi(e,4),r}function m8(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function p8(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(m8(e));return r}function g8(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function _8(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Pi(e,4),r.U=Pi(e,4),r.W=Pi(e,4),r}function x8(e){var r=_8(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function U2(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function W2(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function v8(e){var r=Pi(e);switch(r.Minor){case 2:return[r.Minor,b8(e,r)];case 3:return[r.Minor,w8(e,r)];case 4:return[r.Minor,y8(e,r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function b8(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=U2(e,t),i=W2(e,e.length-e.l);return{t:"Std",h:n,v:i}}function w8(){throw new Error("File is password-protected: ECMA-376 Extensible")}function y8(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(Ar,function(a){var o=Pe(a);switch(di(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function E8(e,r){var t={},n=t.EncryptionVersionInfo=Pi(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var i=e.read_shift(4);return r-=4,t.EncryptionHeader=U2(e,i),r-=i,t.EncryptionVerifier=W2(e,r),t}function T8(e){var r={},t=r.EncryptionVersionInfo=Pi(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function k8(e){var r=0,t,n=B2(e),i=n.length+1,a,o,l,f,d;for(t=_a(i),t[0]=n.length,a=1;a!=i;++a)t[a]=n[a-1];for(a=i-1;a>=0;--a)o=t[a],l=r&16384?1:0,f=r<<1&32767,d=l|f,r=d^o;return r^52811}var H2=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},a=function(o){for(var l=r[o.length-1],f=104,d=o.length-1;d>=0;--d)for(var h=o[d],p=0;p!=7;++p)h&64&&(l^=t[f]),h*=2,--f;return l};return function(o){for(var l=B2(o),f=a(l),d=l.length,h=_a(16),p=0;p!=16;++p)h[p]=0;var g,x,v;for((d&1)===1&&(g=f>>8,h[d]=i(e[0],g),--d,g=f&255,x=l[l.length-1],h[d]=i(x,g));d>0;)--d,g=f>>8,h[d]=i(l[d],g),--d,g=f&255,h[d]=i(l[d],g);for(d=15,v=15-l.length;v>0;)g=f>>8,h[d]=i(e[v],g),--d,--v,g=f&255,h[d]=i(l[d],g),--d,--v;return h}}(),S8=function(e,r,t,n,i){i||(i=r),n||(n=H2(e));var a,o;for(a=0;a!=r.length;++a)o=r[a],o^=n[t],o=(o>>5|o<<3)&255,i[a]=o,++t;return[i,t,n]},A8=function(e){var r=0,t=H2(e);return function(n){var i=S8("",n,r,t);return r=i[1],i[0]}};function C8(e,r,t,n){var i={key:Vt(e),verificationBytes:Vt(e)};return t.password&&(i.verifier=k8(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=A8(t.password)),i}function F8(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=T8(e,r):n.Data=E8(e,r),n}function I8(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?F8(e,r-2,n):C8(e,t.biff>=8?r:r-2,t,n),n}var R8=function(){function e(i,a){switch(a.type){case"base64":return r(hn(i),a);case"binary":return r(i,a);case"buffer":return r(it&&Buffer.isBuffer(i)?i.toString("binary"):es(i),a);case"array":return r(Qa(i),a)}throw new Error("Unrecognized type "+a.type)}function r(i,a){var o=a||{},l=o.dense?[]:{},f=i.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(h,p){Array.isArray(l)&&(l[p]=[]);for(var g=/\\\w+\b/g,x=0,v,_=-1;v=g.exec(h);){switch(v[0]){case"\\cell":var y=h.slice(x,g.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++_,y.length){var N={v:y,t:"s"};Array.isArray(l)?l[p][_]=N:l[Be({r:p,c:_})]=N}break}x=g.lastIndex}_>d.e.c&&(d.e.c=_)}),l["!ref"]=st(d),l}function t(i,a){return va(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=Pt(i["!ref"]),l,f=Array.isArray(i),d=o.s.r;d<=o.e.r;++d){a.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)a.push("\\cellx"+(h+1));for(a.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var p=Be({r:d,c:h});l=f?(i[d]||[])[h]:i[p],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(Li(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function N8(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function zc(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function D8(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,i=Math.max(r,t,n),a=Math.min(r,t,n),o=i-a;if(o===0)return[0,0,r];var l=0,f=0,d=i+a;switch(f=o/(d>1?2-d:d),i){case r:l=((t-n)/o+6)%6;break;case t:l=(n-r)/o+2;break;case n:l=(r-t)/o+4;break}return[l/6,f,d/2]}function O8(e){var r=e[0],t=e[1],n=e[2],i=t*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],l=6*r,f;if(t!==0)switch(l|0){case 0:case 6:f=i*l,o[0]+=i,o[1]+=f;break;case 1:f=i*(2-l),o[0]+=f,o[1]+=i;break;case 2:f=i*(l-2),o[1]+=i,o[2]+=f;break;case 3:f=i*(4-l),o[1]+=f,o[2]+=i;break;case 4:f=i*(l-4),o[2]+=i,o[0]+=f;break;case 5:f=i*(6-l),o[2]+=f,o[0]+=i;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Tu(e,r){if(r===0)return e;var t=D8(N8(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),zc(O8(t))}var V2=6,P8=15,L8=1,Wr=V2;function ku(e){return Math.floor((e+Math.round(128/Wr)/256)*Wr)}function Su(e){return Math.floor((e-5)/Wr*100+.5)/100}function Xm(e){return Math.round((e*Wr+5)/Wr*256)/256}function Om(e){return Xm(Su(ku(e)))}function vp(e){var r=Math.abs(e-Om(e)),t=Wr;if(r>.005)for(Wr=L8;Wr<P8;++Wr)Math.abs(e-Om(e))<=r&&(r=Math.abs(e-Om(e)),t=Wr);Wr=t}function lo(e){e.width?(e.wpx=ku(e.width),e.wch=Su(e.wpx),e.MDW=Wr):e.wpx?(e.wch=Su(e.wpx),e.width=Xm(e.wch),e.MDW=Wr):typeof e.wch=="number"&&(e.width=Xm(e.wch),e.wpx=ku(e.width),e.MDW=Wr),e.customWidth&&delete e.customWidth}var M8=96,z2=M8;function G2(e){return e*96/z2}function Gc(e){return e*z2/96}var B8={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function U8(e,r,t,n){r.Borders=[];var i={},a=!1;(e[0].match(Ar)||[]).forEach(function(o){var l=Pe(o);switch(di(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=At(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=At(l.diagonalDown)),r.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function W8(e,r,t,n){r.Fills=[];var i={},a=!1;(e[0].match(Ar)||[]).forEach(function(o){var l=Pe(o);switch(di(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},r.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function H8(e,r,t,n){r.Fonts=[];var i={},a=!1;(e[0].match(Ar)||[]).forEach(function(o){var l=Pe(o);switch(di(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=wt(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?At(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?At(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?At(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?At(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?At(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?At(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?At(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Qm[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=At(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var f=Ya[i.color.index];i.color.index==81&&(f=Ya[1]),f||(f=Ya[1]),i.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=Tu(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function V8(e,r,t){r.NumberFmt=[];for(var n=ui(ze),i=0;i<n.length;++i)r.NumberFmt[n[i]]=ze[n[i]];var a=e[0].match(Ar);if(a)for(i=0;i<a.length;++i){var o=Pe(a[i]);switch(di(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=ot(wt(o.formatCode)),f=parseInt(o.numFmtId,10);if(r.NumberFmt[f]=l,f>0){if(f>392){for(f=392;f>60&&r.NumberFmt[f]!=null;--f);r.NumberFmt[f]=l}Ka(l,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var mu=["numFmtId","fillId","fontId","borderId","xfId"],pu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function z8(e,r,t){r.CellXf=[];var n,i=!1;(e[0].match(Ar)||[]).forEach(function(a){var o=Pe(a),l=0;switch(di(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<mu.length;++l)n[mu[l]]&&(n[mu[l]]=parseInt(n[mu[l]],10));for(l=0;l<pu.length;++l)n[pu[l]]&&(n[pu[l]]=At(n[pu[l]]));if(r.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[l]){n.numFmtId=l;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=At(o.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var G8=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,f,d){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=l.match(r))&&V8(p,h,d),(p=l.match(i))&&H8(p,h,f,d),(p=l.match(n))&&W8(p,h,f,d),(p=l.match(a))&&U8(p,h,f,d),(p=l.match(t))&&z8(p,h,d),h}}();function X8(e,r){var t=e.read_shift(2),n=kr(e,r-2);return[t,n]}function $8(e,r,t){var n={};n.sz=e.read_shift(2)/20;var i=rD(e,2,t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=tD(e,8),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=kr(e,r-21),n}var j8=Sr;function K8(e,r){var t=e.l+r,n=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:i}}var Y8=Sr;function q8(e,r,t){var n={};n.NumberFmt=[];for(var i in ze)n.NumberFmt[i]=ze[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return Mi(e,function(f,d,h){switch(h){case 44:n.NumberFmt[f[0]]=f[1],Ka(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(f.color.rgb=Tu(r.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(h),o=!0;break;case 38:a.pop(),o=!1;break;default:if(d.T>0)a.push(h);else if(d.T<0)a.pop();else if(!o||t.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}var Q8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function J8(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(Ar)||[]).forEach(function(i){var a=Pe(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(r.themeElements.clrScheme[Q8.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Z8(){}function eP(){}var tP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,rP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,nP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function iP(e,r,t){r.themeElements={};var n;[["clrScheme",tP,J8],["fontScheme",rP,Z8],["fmtScheme",nP,eP]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,r,t)})}var aP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function X2(e,r){(!e||e.length===0)&&(e=sP());var t,n={};if(!(t=e.match(aP)))throw new Error("themeElements not found in theme");return iP(t[0],n,r),n.raw=e,n}function sP(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[o2];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function oP(e,r,t){var n=e.l+r,i=e.read_shift(4);if(i!==124226){if(!t.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=s2(a,{type:"array"})}catch{return}var l=dn(o,"theme/theme/theme1.xml",!0);if(l)return X2(l,t)}}function cP(e){return e.read_shift(4)}function lP(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=fP(e,4);break;case 2:r.xclrValue=R2(e,4);break;case 3:r.xclrValue=cP(e,4);break;case 4:e.l+=4;break}return e.l+=8,r}function fP(e,r){return Sr(e,r)}function uP(e,r){return Sr(e,r)}function dP(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=lP(e,t);break;case 6:n[1]=uP(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function hP(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(dP(e,t-e.l));return{ixfe:n,ext:a}}function mP(e,r){r.forEach(function(t){switch(t[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function pP(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:kr(e,r-8)}}function gP(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function _P(e){return e.l+=4,e.read_shift(4)!=0}function xP(e,r,t){var n={Types:[],Cell:[],Value:[]},i=t||{},a=[],o=!1,l=2;return Mi(e,function(f,d,h){switch(h){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(p){l==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):l==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:l=f?1:0;break;case 338:l=2;break;case 35:a.push(h),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!d.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function vP(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,o;return e.replace(Ar,function(l){var f=Pe(l);switch(di(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):a==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return l}),n}function bP(e){var r=[];if(!e)return r;var t=1;return(e.match(Ar)||[]).forEach(function(n){var i=Pe(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,r.push(i);break}}),r}function wP(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Be(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function yP(e,r,t){var n=[],i=!1;return Mi(e,function(o,l,f){switch(f){case 63:n.push(o);break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function EP(e,r,t,n){if(!e)return e;var i=n||{},a=!1,o=!1;Mi(e,function(f,d,h){if(!o)switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!d.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function TP(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function Ew(e,r,t,n){var i=Array.isArray(e),a;r.forEach(function(o){var l=Hr(o.ref);if(i?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[o.ref],!a){a={t:"z"},i?e[l.r][l.c]=a:e[o.ref]=a;var f=Pt(e["!ref"]||"BDWGO1000001:A1");f.s.r>l.r&&(f.s.r=l.r),f.e.r<l.r&&(f.e.r=l.r),f.s.c>l.c&&(f.s.c=l.c),f.e.c<l.c&&(f.e.c=l.c);var d=st(f);d!==e["!ref"]&&(e["!ref"]=d)}a.c||(a.c=[]);var h={a:o.author,t:o.t,r:o.r,T:t};o.h&&(h.h=o.h);for(var p=a.c.length-1;p>=0;--p){if(!t&&a.c[p].T)return;t&&!a.c[p].T&&a.c.splice(p,1)}if(t&&n){for(p=0;p<n.length;++p)if(h.a==n[p].id){h.a=n[p].name||h.a;break}}a.c.push(h)})}function kP(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&t.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var f=Pe(l[0]),d={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},h=Hr(f.ref);if(!(r.sheetRows&&r.sheetRows<=h.r)){var p=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&xp(p[1])||{r:"",t:"",h:""};d.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),d.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(d.h=g.h),n.push(d)}}}}),n}function SP(e,r){var t=[],n=!1,i={},a=0;return e.replace(Ar,function(l,f){var d=Pe(l);switch(di(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":a=f+l.length;break;case"</text>":i.t=e.slice(a,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),t}function AP(e,r){var t=[],n=!1;return e.replace(Ar,function(a){var o=Pe(a);switch(di(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),t}function CP(e){var r={};r.iauthor=e.read_shift(4);var t=rs(e,16);return r.rfx=t.s,r.ref=Be(t.s),e.l+=16,r}var FP=kr;function IP(e,r){var t=[],n=[],i={},a=!1;return Mi(e,function(l,f,d){switch(d){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,r.sheetRows&&i.rfx&&r.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!a||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),t}var RP="application/vnd.ms-office.vbaProject";function NP(e){var r=at.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");at.utils.cfb_add(r,i,e.FileIndex[n].content)}}),at.write(r)}function DP(){return{"!type":"dialog"}}function OP(){return{"!type":"dialog"}}function PP(){return{"!type":"macro"}}function LP(){return{"!type":"macro"}}var ao=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,i,a,o){var l=!1,f=!1;a.length==0?f=!0:a.charAt(0)=="["&&(f=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=a.length>0?parseInt(a,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=r.c:--h,f?d+=r.r:--d,i+(l?"":"$")+Qt(h)+(f?"":"$")+hr(d)}return function(i,a){return r=a,i.replace(e,t)}}(),$2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,MP=function(){return function(r,t){return r.replace($2,function(n,i,a,o,l,f){var d=dp(o)-(a?0:t.c),h=up(f)-(l?0:t.r),p=h==0?"":l?h+1:"["+h+"]",g=d==0?"":a?d+1:"["+d+"]";return i+"R"+p+"C"+g})}}();function j2(e,r){return e.replace($2,function(t,n,i,a,o,l){return n+(i=="$"?i+a:Qt(dp(a)+r.c))+(o=="$"?o+l:hr(up(l)+r.r))})}function BP(e,r,t){var n=ho(r),i=n.s,a=Hr(t),o={r:a.r-i.r,c:a.c-i.c};return j2(e,o)}function UP(e){return e.length!=1}function Tw(e){return e.replace(/_xlfn\./g,"")}function Wt(e){e.l+=1}function xa(e,r){var t=e.read_shift(r==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function K2(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Y2(e,r,t);t.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),o=xa(e,2),l=xa(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function Y2(e){var r=xa(e,2),t=xa(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function WP(e,r,t){if(t.biff<8)return Y2(e,r,t);var n=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),a=xa(e,2),o=xa(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function q2(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return HP(e,r,t);var n=e.read_shift(t&&t.biff==12?4:2),i=xa(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function HP(e){var r=xa(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function VP(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function zP(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return GP(e,r,t);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:l}}function GP(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),i==1&&t>=128&&(t=t-256),{r,c:t,cRel:i,rRel:n}}function XP(e,r,t){var n=(e[e.l++]&96)>>5,i=K2(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function $P(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(t)switch(t.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=K2(e,a,t);return[n,i,o]}function jP(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function KP(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(t)switch(t.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function YP(e,r,t){var n=(e[e.l++]&96)>>5,i=WP(e,r-1,t);return[n,i]}function qP(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function kw(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function QP(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function JP(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function ZP(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function e6(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function t6(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Q2(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function r6(e){return e.read_shift(2),Q2(e,2)}function n6(e){return e.read_shift(2),Q2(e,2)}function i6(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=q2(e,0,t);return[n,i]}function a6(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=zP(e,0,t);return[n,i]}function s6(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var a=q2(e,0,t);return[n,i,a]}function o6(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[cL[i],ey[i],n]}function c6(e,r,t){var n=e[e.l++],i=e.read_shift(1),a=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:l6(e);return[i,(a[0]===0?ey:oL)[a[1]]]}function l6(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function f6(e,r,t){e.l+=t&&t.biff==2?3:4}function u6(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function d6(e){return e.l++,ns[e.read_shift(1)]}function h6(e){return e.l++,e.read_shift(2)}function m6(e){return e.l++,e.read_shift(1)!==0}function p6(e){return e.l++,yr(e,8)}function g6(e,r,t){return e.l++,jc(e,r-1,t)}function _6(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Bt(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=ns[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=yr(e,8);break;case 2:t[1]=is(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function x6(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((t.biff==12?rs:Ru)(e,8));return i}function v6(e,r,t){var n=0,i=0;t.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var l=0;l!=i;++l)o[a][l]=_6(e,t.biff);return o}function b6(e,r,t){var n=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,a=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function w6(e,r,t){if(t.biff==5)return y6(e,r,t);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function y6(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function E6(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function T6(e,r,t){var n=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function k6(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function S6(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(t)switch(t.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var A6=Sr,C6=Sr,F6=Sr;function Yc(e,r,t){return e.l+=2,[VP(e,4,t)]}function bp(e){return e.l+=6,[]}var I6=Yc,R6=bp,N6=bp,D6=Yc;function J2(e){return e.l+=2,[Vt(e),e.read_shift(2)&1]}var O6=Yc,P6=J2,L6=bp,M6=Yc,B6=Yc,U6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function W6(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=U6[t>>2&31];return{ixti:r,coltype:t&3,rt:o,idx:n,c:i,C:a}}function H6(e){return e.l+=2,[e.read_shift(4)]}function V6(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function z6(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function G6(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function X6(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function $6(e){return e.l+=4,[0,0]}var Sw={1:{n:"PtgExp",f:u6},2:{n:"PtgTbl",f:F6},3:{n:"PtgAdd",f:Wt},4:{n:"PtgSub",f:Wt},5:{n:"PtgMul",f:Wt},6:{n:"PtgDiv",f:Wt},7:{n:"PtgPower",f:Wt},8:{n:"PtgConcat",f:Wt},9:{n:"PtgLt",f:Wt},10:{n:"PtgLe",f:Wt},11:{n:"PtgEq",f:Wt},12:{n:"PtgGe",f:Wt},13:{n:"PtgGt",f:Wt},14:{n:"PtgNe",f:Wt},15:{n:"PtgIsect",f:Wt},16:{n:"PtgUnion",f:Wt},17:{n:"PtgRange",f:Wt},18:{n:"PtgUplus",f:Wt},19:{n:"PtgUminus",f:Wt},20:{n:"PtgPercent",f:Wt},21:{n:"PtgParen",f:Wt},22:{n:"PtgMissArg",f:Wt},23:{n:"PtgStr",f:g6},26:{n:"PtgSheet",f:V6},27:{n:"PtgEndSheet",f:z6},28:{n:"PtgErr",f:d6},29:{n:"PtgBool",f:m6},30:{n:"PtgInt",f:h6},31:{n:"PtgNum",f:p6},32:{n:"PtgArray",f:qP},33:{n:"PtgFunc",f:o6},34:{n:"PtgFuncVar",f:c6},35:{n:"PtgName",f:b6},36:{n:"PtgRef",f:i6},37:{n:"PtgArea",f:XP},38:{n:"PtgMemArea",f:E6},39:{n:"PtgMemErr",f:A6},40:{n:"PtgMemNoMem",f:C6},41:{n:"PtgMemFunc",f:T6},42:{n:"PtgRefErr",f:k6},43:{n:"PtgAreaErr",f:jP},44:{n:"PtgRefN",f:a6},45:{n:"PtgAreaN",f:YP},46:{n:"PtgMemAreaN",f:G6},47:{n:"PtgMemNoMemN",f:X6},57:{n:"PtgNameX",f:w6},58:{n:"PtgRef3d",f:s6},59:{n:"PtgArea3d",f:$P},60:{n:"PtgRefErr3d",f:S6},61:{n:"PtgAreaErr3d",f:KP},255:{}},j6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},K6={1:{n:"PtgElfLel",f:J2},2:{n:"PtgElfRw",f:M6},3:{n:"PtgElfCol",f:I6},6:{n:"PtgElfRwV",f:B6},7:{n:"PtgElfColV",f:D6},10:{n:"PtgElfRadical",f:O6},11:{n:"PtgElfRadicalS",f:L6},13:{n:"PtgElfColS",f:R6},15:{n:"PtgElfColSV",f:N6},16:{n:"PtgElfRadicalLel",f:P6},25:{n:"PtgList",f:W6},29:{n:"PtgSxName",f:H6},255:{}},Y6={0:{n:"PtgAttrNoop",f:$6},1:{n:"PtgAttrSemi",f:t6},2:{n:"PtgAttrIf",f:ZP},4:{n:"PtgAttrChoose",f:QP},8:{n:"PtgAttrGoto",f:JP},16:{n:"PtgAttrSum",f:f6},32:{n:"PtgAttrBaxcel",f:kw},33:{n:"PtgAttrBaxcel",f:kw},64:{n:"PtgAttrSpace",f:r6},65:{n:"PtgAttrSpaceSemi",f:n6},128:{n:"PtgAttrIfError",f:e6},255:{}};function qc(e,r,t,n){if(n.biff<8)return Sr(e,r);for(var i=e.l+r,a=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=v6(e,0,n),a.push(t[o][1]);break;case"PtgMemArea":t[o][2]=x6(e,t[o][1],n),a.push(t[o][2]);break;case"PtgExp":n&&n.biff==12&&(t[o][1][1]=e.read_shift(4),a.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0];default:break}return r=i-e.l,r!==0&&a.push(Sr(e,r)),a}function Qc(e,r,t){for(var n=e.l+r,i,a,o=[];n!=e.l;)r=n-e.l,a=e[e.l],i=Sw[a]||Sw[j6[a]],(a===24||a===25)&&(i=(a===24?K6:Y6)[e[e.l+1]]),!i||!i.f?Sr(e,r):o.push([i.n,i.f(e,r,t)]);return o}function q6(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var Q6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function J6(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Z2(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Aw(e,r,t){var n=Z2(e,r,t);return n=="#REF"?n:J6(n,t)}function wr(e,r,t,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],f,d,h,p=0,g=0,x,v="";if(!e[0]||!e[0][0])return"";for(var _=-1,y="",N=0,R=e[0].length;N<R;++N){var T=e[0][N];switch(T[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=l.pop(),d=l.pop(),_>=0){switch(e[0][_][1][0]){case 0:y=Ot(" ",e[0][_][1][1]);break;case 1:y=Ot("\r",e[0][_][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}d=d+y,_=-1}l.push(d+Q6[T[0]]+f);break;case"PtgIsect":f=l.pop(),d=l.pop(),l.push(d+" "+f);break;case"PtgUnion":f=l.pop(),d=l.pop(),l.push(d+","+f);break;case"PtgRange":f=l.pop(),d=l.pop(),l.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Rc(T[1][1],o,i),l.push(Nc(h,a));break;case"PtgRefN":h=t?Rc(T[1][1],t,i):T[1][1],l.push(Nc(h,a));break;case"PtgRef3d":p=T[1][1],h=Rc(T[1][2],o,i),v=Aw(n,p,i);var z=v;l.push(v+"!"+Nc(h,a));break;case"PtgFunc":case"PtgFuncVar":var J=T[1][0],U=T[1][1];J||(J=0),J&=127;var D=J==0?[]:l.slice(-J);l.length-=J,U==="User"&&(U=D.shift()),l.push(U+"("+D.join(",")+")");break;case"PtgBool":l.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(T[1]);break;case"PtgNum":l.push(String(T[1]));break;case"PtgStr":l.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(T[1]);break;case"PtgAreaN":x=ow(T[1][1],t?{s:t}:o,i),l.push(Nm(x,i));break;case"PtgArea":x=ow(T[1][1],o,i),l.push(Nm(x,i));break;case"PtgArea3d":p=T[1][1],x=T[1][2],v=Aw(n,p,i),l.push(v+"!"+Nm(x,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=T[1][2];var j=(n.names||[])[g-1]||(n[0]||[])[g],V=j?j.Name:"SH33TJSNAME"+String(g);V&&V.slice(0,6)=="_xlfn."&&!i.xlfn&&(V=V.slice(6)),l.push(V);break;case"PtgNameX":var re=T[1][1];g=T[1][2];var te;if(i.biff<=5)re<0&&(re=-re),n[re]&&(te=n[re][g]);else{var X="";if(((n[re]||[])[0]||[])[0]==14849||(((n[re]||[])[0]||[])[0]==1025?n[re][g]&&n[re][g].itab>0&&(X=n.SheetNames[n[re][g].itab-1]+"!"):X=n.SheetNames[g-1]+"!"),n[re]&&n[re][g])X+=n[re][g].Name;else if(n[0]&&n[0][g])X+=n[0][g].Name;else{var me=(Z2(n,re,i)||"").split(";;");me[g-1]?X=me[g-1]:X+="SH33TJSERRX"}l.push(X);break}te||(te={Name:"SH33TJSERRY"}),l.push(te.Name);break;case"PtgParen":var Ce="(",he=")";if(_>=0){switch(y="",e[0][_][1][0]){case 2:Ce=Ot(" ",e[0][_][1][1])+Ce;break;case 3:Ce=Ot("\r",e[0][_][1][1])+Ce;break;case 4:he=Ot(" ",e[0][_][1][1])+he;break;case 5:he=Ot("\r",e[0][_][1][1])+he;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}l.push(Ce+l.pop()+he);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:T[1][1],r:T[1][0]};var Ae={c:t.c,r:t.r};if(n.sharedf[Be(h)]){var Se=n.sharedf[Be(h)];l.push(wr(Se,o,Ae,n,i))}else{var qe=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){l.push(wr(d[1],o,Ae,n,i)),qe=!0;break}qe||l.push(T[1])}break;case"PtgArray":l.push("{"+q6(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&pe.indexOf(e[0][N][0])==-1){T=e[0][_];var Fe=!0;switch(T[1][0]){case 4:Fe=!1;case 0:y=Ot(" ",T[1][1]);break;case 5:Fe=!1;case 1:y=Ot("\r",T[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}l.push((Fe?y:"")+l.pop()+(Fe?"":y)),_=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function Z6(e,r,t){var n=e.l+r,i=t.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],Sr(e,r-2)];var l=Qc(e,o,t);return r!==o+i&&(a=qc(e,r-o-i,l,t)),e.l=n,[l,a]}function eL(e,r,t){var n=e.l+r,i=t.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],Sr(e,r-2)];var l=Qc(e,o,t);return r!==o+i&&(a=qc(e,r-o-i,l,t)),e.l=n,[l,a]}function tL(e,r,t,n){var i=e.l+r,a=Qc(e,n,t),o;return i!==e.l&&(o=qc(e,i-e.l,a,t)),[a,o]}function rL(e,r,t){var n=e.l+r,i,a=e.read_shift(2),o=Qc(e,a,t);return a==65535?[[],Sr(e,r-2)]:(r!==a+2&&(i=qc(e,n-a-2,o,t)),[o,i])}function nL(e){var r;if(Di(e,e.l+6)!==65535)return[yr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Pm(e,r,t){var n=e.l+r,i=hi(e,6);t.biff==2&&++e.l;var a=nL(e,8),o=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var l=eL(e,n-e.l,t);return{cell:i,val:a[0],formula:l,shared:o>>3&1,tt:a[1]}}function Nu(e,r,t){var n=e.read_shift(4),i=Qc(e,n,t),a=e.read_shift(4),o=a>0?qc(e,a,i,t):null;return[i,o]}var iL=Nu,Du=Nu,aL=Nu,sL=Nu,oL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ey={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Cw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Lm(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Lc={},so={};function Mc(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function ty(e,r,t,n,i,a){try{n.cellNF&&(e.z=ze[r])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=sr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ze[r]==null&&Ka(lN[r]||"General",r),e.t==="e")e.w=e.w||ns[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Uc(e.v);else if(e.t==="d"){var o=Vr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Uc(o)}else{if(e.v===void 0)return"";e.w=qa(e.v,so)}else e.t==="d"?e.w=In(r,Vr(e.v),so):e.w=In(r,e.v,so)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&t!=null)try{e.s=a.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Tu(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Tu(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function lL(e,r){var t=Pt(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=st(t))}var fL=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,uL=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,dL=/<(?:\w:)?hyperlink [^>]*>/mg,hL=/"(\w*:\w*)"/,mL=/<(?:\w:)?col\b[^>]*[\/]?>/g,pL=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,gL=/<(?:\w:)?pageMargins[^>]*\/>/g,ry=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,_L=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,xL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function vL(e,r,t,n,i,a,o){if(!e)return e;n||(n={"!id":{}}),Gt!=null&&r.dense==null&&(r.dense=Gt);var l=r.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",p=e.match(uL);p?(d=e.slice(0,p.index),h=e.slice(p.index+p[0].length)):d=h=e;var g=d.match(ry);g?wp(g[0],l,i,t):(g=d.match(_L))&&bL(g[0],g[1]||"",l,i,t,o,a);var x=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var v=d.slice(x,x+50).match(hL);v&&lL(l,v[1])}var _=d.match(xL);_&&_[1]&&SL(_[1],i);var y=[];if(r.cellStyles){var N=d.match(mL);N&&EL(y,N)}p&&AL(p[1],l,r,f,a,o);var R=h.match(pL);R&&(l["!autofilter"]=TL(R[0]));var T=[],z=h.match(fL);if(z)for(x=0;x!=z.length;++x)T[x]=Pt(z[x].slice(z[x].indexOf('"')+1));var J=h.match(dL);J&&wL(l,J,n);var U=h.match(gL);if(U&&(l["!margins"]=yL(Pe(U[0]))),!l["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(l["!ref"]=st(f)),r.sheetRows>0&&l["!ref"]){var D=Pt(l["!ref"]);r.sheetRows<=+D.e.r&&(D.e.r=r.sheetRows-1,D.e.r>f.e.r&&(D.e.r=f.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>f.e.c&&(D.e.c=f.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),l["!fullref"]=l["!ref"],l["!ref"]=st(D))}return y.length>0&&(l["!cols"]=y),T.length>0&&(l["!merges"]=T),l}function wp(e,r,t,n){var i=Pe(e);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=ot(wt(i.codeName)))}function bL(e,r,t,n,i){wp(e.slice(0,e.indexOf(">")),t,n,i)}function wL(e,r,t){for(var n=Array.isArray(e),i=0;i!=r.length;++i){var a=Pe(wt(r[i]),!0);if(!a.ref)return;var o=((t||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+ot(a.location))):(a.Target="#"+ot(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=Pt(a.ref),f=l.s.r;f<=l.e.r;++f)for(var d=l.s.c;d<=l.e.c;++d){var h=Be({c:d,r:f});n?(e[f]||(e[f]=[]),e[f][d]||(e[f][d]={t:"z",v:void 0}),e[f][d].l=a):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=a)}}}function yL(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function EL(e,r){for(var t=!1,n=0;n!=r.length;++n){var i=Pe(r[n],!0);i.hidden&&(i.hidden=At(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,vp(i.width)),lo(i);a<=o;)e[a++]=dr(i)}}function TL(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var kL=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function SL(e,r){r.Views||(r.Views=[{}]),(e.match(kL)||[]).forEach(function(t,n){var i=Pe(t);r.Views[n]||(r.Views[n]={}),+i.zoomScale&&(r.Views[n].zoom=+i.zoomScale),At(i.rightToLeft)&&(r.Views[n].RTL=!0)})}var AL=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=Wc("v"),o=Wc("f");return function(f,d,h,p,g,x){for(var v=0,_="",y=[],N=[],R=0,T=0,z=0,J="",U,D,j=0,V=0,re,te,X=0,me=0,Ce=Array.isArray(x.CellXf),he,Ae=[],Se=[],qe=Array.isArray(d),pe=[],Fe={},oe=!1,L=!!h.sheetStubs,K=f.split(r),W=0,B=K.length;W!=B;++W){_=K[W].trim();var ae=_.length;if(ae!==0){var Ee=0;e:for(v=0;v<ae;++v)switch(_[v]){case">":if(_[v-1]!="/"){++v;break e}if(h&&h.cellStyles){if(D=Pe(_.slice(Ee,v),!0),j=D.r!=null?parseInt(D.r,10):j+1,V=-1,h.sheetRows&&h.sheetRows<j)continue;Fe={},oe=!1,D.ht&&(oe=!0,Fe.hpt=parseFloat(D.ht),Fe.hpx=Gc(Fe.hpt)),D.hidden=="1"&&(oe=!0,Fe.hidden=!0),D.outlineLevel!=null&&(oe=!0,Fe.level=+D.outlineLevel),oe&&(pe[j-1]=Fe)}break;case"<":Ee=v;break}if(Ee>=v)break;if(D=Pe(_.slice(Ee,v),!0),j=D.r!=null?parseInt(D.r,10):j+1,V=-1,!(h.sheetRows&&h.sheetRows<j)){p.s.r>j-1&&(p.s.r=j-1),p.e.r<j-1&&(p.e.r=j-1),h&&h.cellStyles&&(Fe={},oe=!1,D.ht&&(oe=!0,Fe.hpt=parseFloat(D.ht),Fe.hpx=Gc(Fe.hpt)),D.hidden=="1"&&(oe=!0,Fe.hidden=!0),D.outlineLevel!=null&&(oe=!0,Fe.level=+D.outlineLevel),oe&&(pe[j-1]=Fe)),y=_.slice(v).split(e);for(var ve=0;ve!=y.length&&y[ve].trim().charAt(0)=="<";++ve);for(y=y.slice(ve),v=0;v!=y.length;++v)if(_=y[v].trim(),_.length!==0){if(N=_.match(t),R=v,T=0,z=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,N!=null&&N.length===2){for(R=0,J=N[1],T=0;T!=J.length&&!((z=J.charCodeAt(T)-64)<1||z>26);++T)R=26*R+z;--R,V=R}else++V;for(T=0;T!=_.length&&_.charCodeAt(T)!==62;++T);if(++T,D=Pe(_.slice(0,T),!0),D.r||(D.r=Be({r:j-1,c:V})),J=_.slice(T),U={t:""},(N=J.match(a))!=null&&N[1]!==""&&(U.v=ot(N[1])),h.cellFormula){if((N=J.match(o))!=null&&N[1]!==""){if(U.f=ot(wt(N[1])).replace(/\r\n/g,`
`),h.xlfn||(U.f=Tw(U.f)),N[0].indexOf('t="array"')>-1)U.F=(J.match(i)||[])[1],U.F.indexOf(":")>-1&&Ae.push([Pt(U.F),U.F]);else if(N[0].indexOf('t="shared"')>-1){te=Pe(N[0]);var be=ot(wt(N[1]));h.xlfn||(be=Tw(be)),Se[parseInt(te.si,10)]=[te,be,D.r]}}else(N=J.match(/<f[^>]*\/>/))&&(te=Pe(N[0]),Se[te.si]&&(U.f=BP(Se[te.si][1],Se[te.si][2],D.r)));var fe=Hr(D.r);for(T=0;T<Ae.length;++T)fe.r>=Ae[T][0].s.r&&fe.r<=Ae[T][0].e.r&&fe.c>=Ae[T][0].s.c&&fe.c<=Ae[T][0].e.c&&(U.F=Ae[T][1])}if(D.t==null&&U.v===void 0)if(U.f||U.F)U.v=0,U.t="n";else if(L)U.t="z";else continue;else U.t=D.t||"n";switch(p.s.c>V&&(p.s.c=V),p.e.c<V&&(p.e.c=V),U.t){case"n":if(U.v==""||U.v==null){if(!L)continue;U.t="z"}else U.v=parseFloat(U.v);break;case"s":if(typeof U.v>"u"){if(!L)continue;U.t="z"}else re=Lc[parseInt(U.v,10)],U.v=re.t,U.r=re.r,h.cellHTML&&(U.h=re.h);break;case"str":U.t="s",U.v=U.v!=null?wt(U.v):"",h.cellHTML&&(U.h=ip(U.v));break;case"inlineStr":N=J.match(n),U.t="s",N!=null&&(re=xp(N[1]))?(U.v=re.t,h.cellHTML&&(U.h=re.h)):U.v="";break;case"b":U.v=At(U.v);break;case"d":h.cellDates?U.v=sr(U.v,1):(U.v=Vr(sr(U.v,1)),U.t="n");break;case"e":(!h||h.cellText!==!1)&&(U.w=U.v),U.v=E2[U.v];break}if(X=me=0,he=null,Ce&&D.s!==void 0&&(he=x.CellXf[D.s],he!=null&&(he.numFmtId!=null&&(X=he.numFmtId),h.cellStyles&&he.fillId!=null&&(me=he.fillId))),ty(U,X,me,h,g,x),h.cellDates&&Ce&&U.t=="n"&&fo(ze[X])&&(U.t="d",U.v=Fu(U.v)),D.cm&&h.xlmeta){var Je=(h.xlmeta.Cell||[])[+D.cm-1];Je&&Je.type=="XLDAPR"&&(U.D=!0)}if(qe){var O=Hr(D.r);d[O.r]||(d[O.r]=[]),d[O.r][O.c]=U}else d[D.r]=U}}}}pe.length>0&&(d["!rows"]=pe)}}();function CL(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(t.level=a&7),a&16&&(t.hidden=!0),a&32&&(t.hpt=i/20),t}var FL=rs;function IL(){}function RL(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=ZN(e,r-19),t}function NL(e){var r=Rn(e);return[r]}function DL(e){var r=ts(e);return[r]}function OL(e){var r=Rn(e),t=e.read_shift(1);return[r,t,"b"]}function PL(e){var r=ts(e),t=e.read_shift(1);return[r,t,"b"]}function LL(e){var r=Rn(e),t=e.read_shift(1);return[r,t,"e"]}function ML(e){var r=ts(e),t=e.read_shift(1);return[r,t,"e"]}function BL(e){var r=Rn(e),t=e.read_shift(4);return[r,t,"s"]}function UL(e){var r=ts(e),t=e.read_shift(4);return[r,t,"s"]}function WL(e){var r=Rn(e),t=yr(e);return[r,t,"n"]}function ny(e){var r=ts(e),t=yr(e);return[r,t,"n"]}function HL(e){var r=Rn(e),t=pp(e);return[r,t,"n"]}function VL(e){var r=ts(e),t=pp(e);return[r,t,"n"]}function zL(e){var r=Rn(e),t=hp(e);return[r,t,"is"]}function GL(e){var r=Rn(e),t=kr(e);return[r,t,"str"]}function XL(e){var r=ts(e),t=kr(e);return[r,t,"str"]}function $L(e,r,t){var n=e.l+r,i=Rn(e);i.r=t["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(t.cellFormula){e.l+=2;var l=Du(e,n-e.l,t);o[3]=wr(l,null,i,t.supbooks,t)}else e.l=n;return o}function jL(e,r,t){var n=e.l+r,i=Rn(e);i.r=t["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(t.cellFormula){e.l+=2;var l=Du(e,n-e.l,t);o[3]=wr(l,null,i,t.supbooks,t)}else e.l=n;return o}function KL(e,r,t){var n=e.l+r,i=Rn(e);i.r=t["!row"];var a=yr(e),o=[i,a,"n"];if(t.cellFormula){e.l+=2;var l=Du(e,n-e.l,t);o[3]=wr(l,null,i,t.supbooks,t)}else e.l=n;return o}function YL(e,r,t){var n=e.l+r,i=Rn(e);i.r=t["!row"];var a=kr(e),o=[i,a,"str"];if(t.cellFormula){e.l+=2;var l=Du(e,n-e.l,t);o[3]=wr(l,null,i,t.supbooks,t)}else e.l=n;return o}var qL=rs;function QL(e,r){var t=e.l+r,n=rs(e,16),i=mp(e),a=kr(e),o=kr(e),l=kr(e);e.l=t;var f={rfx:n,relId:i,loc:a,display:l};return o&&(f.Tooltip=o),f}function JL(){}function ZL(e,r,t){var n=e.l+r,i=b2(e,16),a=e.read_shift(1),o=[i];if(o[2]=a,t.cellFormula){var l=iL(e,n-e.l,t);o[1]=l}else e.l=n;return o}function e5(e,r,t){var n=e.l+r,i=rs(e,16),a=[i];if(t.cellFormula){var o=sL(e,n-e.l,t);a[1]=o,e.l=n}else e.l=n;return a}var t5=["left","right","top","bottom","header","footer"];function r5(e){var r={};return t5.forEach(function(t){r[t]=yr(e,8)}),r}function n5(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function i5(){}function a5(){}function s5(e,r,t,n,i,a,o){if(!e)return e;var l=r||{};n||(n={"!id":{}}),Gt!=null&&l.dense==null&&(l.dense=Gt);var f=l.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=[],g=!1,x=!1,v,_,y,N,R,T,z,J,U,D=[];l.biff=12,l["!row"]=0;var j=0,V=!1,re=[],te={},X=l.supbooks||i.supbooks||[[]];if(X.sharedf=te,X.arrayf=re,X.SheetNames=i.SheetNames||i.Sheets.map(function(Fe){return Fe.name}),!l.supbooks&&(l.supbooks=X,i.Names))for(var me=0;me<i.Names.length;++me)X[0][me+1]=i.Names[me];var Ce=[],he=[],Ae=!1;Au[16]={n:"BrtShortReal",f:ny};var Se,qe;if(Mi(e,function(oe,L,K){if(!x)switch(K){case 148:d=oe;break;case 0:v=oe,l.sheetRows&&l.sheetRows<=v.r&&(x=!0),J=hr(N=v.r),l["!row"]=v.r,(oe.hidden||oe.hpt||oe.level!=null)&&(oe.hpt&&(oe.hpx=Gc(oe.hpt)),he[oe.r]=oe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(_={t:oe[2]},oe[2]){case"n":_.v=oe[1];break;case"s":z=Lc[oe[1]],_.v=z.t,_.r=z.r;break;case"b":_.v=!!oe[1];break;case"e":_.v=oe[1],l.cellText!==!1&&(_.w=ns[_.v]);break;case"str":_.t="s",_.v=oe[1];break;case"is":_.t="s",_.v=oe[1].t;break}if((y=o.CellXf[oe[0].iStyleRef])&&ty(_,y.numFmtId,null,l,a,o),R=oe[0].c==-1?R+1:oe[0].c,l.dense?(f[N]||(f[N]=[]),f[N][R]=_):f[Qt(R)+J]=_,l.cellFormula){for(V=!1,j=0;j<re.length;++j){var W=re[j];v.r>=W[0].s.r&&v.r<=W[0].e.r&&R>=W[0].s.c&&R<=W[0].e.c&&(_.F=st(W[0]),V=!0)}!V&&oe.length>3&&(_.f=oe[3])}if(h.s.r>v.r&&(h.s.r=v.r),h.s.c>R&&(h.s.c=R),h.e.r<v.r&&(h.e.r=v.r),h.e.c<R&&(h.e.c=R),l.cellDates&&y&&_.t=="n"&&fo(ze[y.numFmtId])){var B=ja(_.v);B&&(_.t="d",_.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}Se&&(Se.type=="XLDAPR"&&(_.D=!0),Se=void 0),qe&&(qe=void 0);break;case 1:case 12:if(!l.sheetStubs||g)break;_={t:"z",v:void 0},R=oe[0].c==-1?R+1:oe[0].c,l.dense?(f[N]||(f[N]=[]),f[N][R]=_):f[Qt(R)+J]=_,h.s.r>v.r&&(h.s.r=v.r),h.s.c>R&&(h.s.c=R),h.e.r<v.r&&(h.e.r=v.r),h.e.c<R&&(h.e.c=R),Se&&(Se.type=="XLDAPR"&&(_.D=!0),Se=void 0),qe&&(qe=void 0);break;case 176:D.push(oe);break;case 49:Se=((l.xlmeta||{}).Cell||[])[oe-1];break;case 494:var ae=n["!id"][oe.relId];for(ae?(oe.Target=ae.Target,oe.loc&&(oe.Target+="#"+oe.loc),oe.Rel=ae):oe.relId==""&&(oe.Target="#"+oe.loc),N=oe.rfx.s.r;N<=oe.rfx.e.r;++N)for(R=oe.rfx.s.c;R<=oe.rfx.e.c;++R)l.dense?(f[N]||(f[N]=[]),f[N][R]||(f[N][R]={t:"z",v:void 0}),f[N][R].l=oe):(T=Be({c:R,r:N}),f[T]||(f[T]={t:"z",v:void 0}),f[T].l=oe);break;case 426:if(!l.cellFormula)break;re.push(oe),U=l.dense?f[N][R]:f[Qt(R)+J],U.f=wr(oe[1],h,{r:v.r,c:R},X,l),U.F=st(oe[0]);break;case 427:if(!l.cellFormula)break;te[Be(oe[0].s)]=oe[1],U=l.dense?f[N][R]:f[Qt(R)+J],U.f=wr(oe[1],h,{r:v.r,c:R},X,l);break;case 60:if(!l.cellStyles)break;for(;oe.e>=oe.s;)Ce[oe.e--]={width:oe.w/256,hidden:!!(oe.flags&1),level:oe.level},Ae||(Ae=!0,vp(oe.w/256)),lo(Ce[oe.e+1]);break;case 161:f["!autofilter"]={ref:st(oe)};break;case 476:f["!margins"]=oe;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),oe.name&&(i.Sheets[t].CodeName=oe.name),(oe.above||oe.left)&&(f["!outline"]={above:oe.above,left:oe.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),oe.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:p.push(K),g=!0;break;case 38:p.pop(),g=!1;break;default:if(!L.T){if(!g||l.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},l),delete l.supbooks,delete l["!row"],!f["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=st(d||h)),l.sheetRows&&f["!ref"]){var pe=Pt(f["!ref"]);l.sheetRows<=+pe.e.r&&(pe.e.r=l.sheetRows-1,pe.e.r>h.e.r&&(pe.e.r=h.e.r),pe.e.r<pe.s.r&&(pe.s.r=pe.e.r),pe.e.c>h.e.c&&(pe.e.c=h.e.c),pe.e.c<pe.s.c&&(pe.s.c=pe.e.c),f["!fullref"]=f["!ref"],f["!ref"]=st(pe))}return D.length>0&&(f["!merges"]=D),Ce.length>0&&(f["!cols"]=Ce),he.length>0&&(f["!rows"]=he),f}function o5(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(r[+o[1]]=t?+o[2]:o[2])});var i=ot((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[r,i,n]}function c5(e,r,t,n,i,a){var o=a||{"!type":"chart"};if(!e)return a;var l=0,f=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=o5(p);h.s.r=h.s.c=0,h.e.c=l,d=Qt(l),g[0].forEach(function(x,v){o[d+hr(v)]={t:"n",v:x,z:g[1]},f=v}),h.e.r<f&&(h.e.r=f),++l}),l>0&&(o["!ref"]=st(h)),o}function l5(e,r,t,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(ry);return l&&wp(l[0],a,i,t),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function f5(e,r){e.l+=10;var t=kr(e,r-10);return{name:t}}function u5(e,r,t,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=[],l=!1;return Mi(e,function(d,h,p){switch(p){case 550:a["!rel"]=d;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),d.name&&(i.Sheets[t].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p);break;case 38:o.pop();break;default:if(h.T>0)o.push(p);else if(h.T<0)o.pop();else if(!l||r.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}},r),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var iy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],d5=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],h5=[],m5=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Fw(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],i=0;i!=r.length;++i){var a=r[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=At(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Iw(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=At(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function ay(e){Iw(e.WBProps,iy),Iw(e.CalcPr,m5),Fw(e.WBView,d5),Fw(e.Sheets,h5),so.date1904=At(e.WBProps.date1904)}var p5="][*?/\\".split("");function g5(e,r){if(e.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return p5.forEach(function(n){if(e.indexOf(n)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}var _5=/<\w+:workbook/;function x5(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(e.replace(Ar,function(f,d){var h=Pe(f);switch(di(h[0])){case"<?xml":break;case"<workbook":f.match(_5)&&(i="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],t.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":iy.forEach(function(p){if(h[p[0]]!=null)switch(p[2]){case"bool":t.WBProps[p[0]]=At(h[p[0]]);break;case"int":t.WBProps[p[0]]=parseInt(h[p[0]],10);break;default:t.WBProps[p[0]]=h[p[0]]}}),h.codeName&&(t.WBProps.CodeName=wt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],t.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=ot(wt(h.name)),delete h[0],t.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=wt(h.name),h.comment&&(a.Comment=h.comment),h.localSheetId&&(a.Sheet=+h.localSheetId),At(h.hidden||"0")&&(a.Hidden=!0),o=d+f.length;break;case"</definedName>":a.Ref=ot(wt(e.slice(o,d))),t.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete h[0],t.CalcPr=h;break;case"<calcPr/>":delete h[0],t.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return f}),PN.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return ay(t),t}function v5(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Vm(e,r-8),t.name=kr(e),t}function b5(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=r>8?kr(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function w5(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function y5(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var i=e.read_shift(4),a=eD(e),o=aL(e,0,t),l=mp(e);e.l=n;var f={Name:a,Ptg:o};return i<268435455&&(f.Sheet=i),l&&(f.Comment=l),f}function E5(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;r||(r={}),r.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],Au[16]={n:"BrtFRTArchID$",f:w5},Mi(e,function(f,d,h){switch(h){case 156:o.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(r.SID=f.Sheet),f.Ref=wr(f.Ptg,null,null,o,r),delete r.SID,delete f.Ptg,a.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,f]):o[0]=[h,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},r),ay(t),t.Names=a,t.supbooks=o,t}function T5(e,r,t){return r.slice(-4)===".bin"?E5(e,t):x5(e,t)}function k5(e,r,t,n,i,a,o,l){return r.slice(-4)===".bin"?s5(e,n,t,i,a,o,l):vL(e,n,t,i,a,o,l)}function S5(e,r,t,n,i,a,o,l){return r.slice(-4)===".bin"?u5(e,n,t,i,a,o,l):l5(e,n,t,i,a,o,l)}function A5(e,r,t,n,i,a,o,l){return r.slice(-4)===".bin"?PP(e,n,t,i,a,o,l):LP(e,n,t,i,a,o,l)}function C5(e,r,t,n,i,a,o,l){return r.slice(-4)===".bin"?DP(e,n,t,i,a,o,l):OP(e,n,t,i,a,o,l)}function F5(e,r,t,n){return r.slice(-4)===".bin"?q8(e,t,n):G8(e,t,n)}function I5(e,r,t){return X2(e,t)}function R5(e,r,t){return r.slice(-4)===".bin"?d8(e,t):f8(e,t)}function N5(e,r,t){return r.slice(-4)===".bin"?IP(e,t):kP(e,t)}function D5(e,r,t){return r.slice(-4)===".bin"?yP(e,r,t):bP(e,r,t)}function O5(e,r,t,n){return t.slice(-4)===".bin"?EP(e,r,t,n):void 0}function P5(e,r,t){return r.slice(-4)===".bin"?xP(e,r,t):vP(e,r,t)}var sy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,oy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function zn(e,r){var t=e.split(/\s+/),n=[];if(r||(n[0]=t[0]),t.length===1)return n;var i=e.match(sy),a,o,l,f;if(i)for(f=0;f!=i.length;++f)a=i[f].match(oy),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),n[l]=a[2].slice(1,a[2].length-1));return n}function L5(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(sy),i,a,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(oy),(a=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),t[o]=i[2].slice(1,i[2].length-1));return t}var Bc;function M5(e,r){var t=Bc[e]||ot(e);return t==="General"?qa(r):In(t,r)}function B5(e,r,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=At(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=sr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[ot(r)]=i}function U5(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ns[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Uc(e.v):e.w=qa(e.v):e.w=M5(r||"General",e.v)}catch(a){if(t.WTF)throw a}try{var n=Bc[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&fo(n)){var i=ja(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(t.WTF)throw a}}}function W5(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=B8[n.Pattern]||n.Pattern)}e[r.ID]=r}function H5(e,r,t,n,i,a,o,l,f,d){var h="General",p=n.StyleID,g={};d=d||{};var x=[],v=0;for(p===void 0&&l&&(p=l.StyleID),p===void 0&&o&&(p=o.StyleID);a[p]!==void 0&&(a[p].nf&&(h=a[p].nf),a[p].Interior&&x.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=At(e);break;case"String":n.t="s",n.r=Jb(ot(e)),n.v=e.indexOf("<")>-1?ot(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(sr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ot(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=E2[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=Jb(r||e));break}if(U5(n,h,d),d.cellFormula!==!1)if(n.Formula){var _=ot(n.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),n.f=ao(_,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ao("RC:RC",i):n.ArrayRange&&(n.F=ao(n.ArrayRange,i),f.push([Pt(n.F),n.F]))}else for(v=0;v<f.length;++v)i.r>=f[v][0].s.r&&i.r<=f[v][0].e.r&&i.c>=f[v][0].s.c&&i.c<=f[v][0].e.c&&(n.F=f[v][1]);d.cellStyles&&(x.forEach(function(y){!g.patternType&&y.patternType&&(g.patternType=y.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function V5(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Mm(e,r){var t=r||{};Zw();var n=Sc(ap(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof dt<"u"?n=dt.utils.decode(65001,Wm(n)):n=wt(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=dr(t);return o.type="string",Vc.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(gt){i.indexOf("<"+gt)>=0&&(a=!0)}),a)return Q5(n,t);Bc={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,f=[],d;Gt!=null&&t.dense==null&&(t.dense=Gt);var h={},p=[],g=t.dense?[]:{},x="",v={},_={},y=zn('<Data ss:Type="String">'),N=0,R=0,T=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},J={},U={},D="",j=0,V=[],re={},te={},X=0,me=[],Ce=[],he={},Ae=[],Se,qe=!1,pe=[],Fe=[],oe={},L=0,K=0,W={Sheets:[],WBProps:{date1904:!1}},B={};Hc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";l=Hc.exec(n);)switch(l[3]=(ae=l[3]).toLowerCase()){case"data":if(ae=="data"){if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&f.push([l[3],!0]);break}if(f[f.length-1][1])break;l[1]==="/"?H5(n.slice(N,l.index),D,y,f[f.length-1][0]=="comment"?he:v,{c:R,r:T},J,Ae[R],_,pe,t):(D="",y=zn(l[0]),N=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Ce.length>0&&(v.c=Ce),(!t.sheetRows||t.sheetRows>T)&&v.v!==void 0&&(t.dense?(g[T]||(g[T]=[]),g[T][R]=v):g[Qt(R)+hr(T)]=v),v.HRef&&(v.l={Target:ot(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(L=R+(parseInt(v.MergeAcross,10)|0),K=T+(parseInt(v.MergeDown,10)|0),V.push({s:{c:R,r:T},e:{c:L,r:K}})),!t.sheetStubs)v.MergeAcross?R=L+1:++R;else if(v.MergeAcross||v.MergeDown){for(var Ee=R;Ee<=L;++Ee)for(var ve=T;ve<=K;++ve)(Ee>R||ve>T)&&(t.dense?(g[ve]||(g[ve]=[]),g[ve][Ee]={t:"z"}):g[Qt(Ee)+hr(ve)]={t:"z"});R=L+1}else++R;else v=L5(l[0]),v.Index&&(R=+v.Index-1),R<z.s.c&&(z.s.c=R),R>z.e.c&&(z.e.c=R),l[0].slice(-2)==="/>"&&++R,Ce=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(T<z.s.r&&(z.s.r=T),T>z.e.r&&(z.e.r=T),l[0].slice(-2)==="/>"&&(_=zn(l[0]),_.Index&&(T=+_.Index-1)),R=0,++T):(_=zn(l[0]),_.Index&&(T=+_.Index-1),oe={},(_.AutoFitHeight=="0"||_.Height)&&(oe.hpx=parseInt(_.Height,10),oe.hpt=G2(oe.hpx),Fe[T]=oe),_.Hidden=="1"&&(oe.hidden=!0,Fe[T]=oe));break;case"worksheet":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));p.push(x),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(g["!ref"]=st(z),t.sheetRows&&t.sheetRows<=z.e.r&&(g["!fullref"]=g["!ref"],z.e.r=t.sheetRows-1,g["!ref"]=st(z))),V.length&&(g["!merges"]=V),Ae.length>0&&(g["!cols"]=Ae),Fe.length>0&&(g["!rows"]=Fe),h[x]=g}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=R=0,f.push([l[3],!1]),d=zn(l[0]),x=ot(d.Name),g=t.dense?[]:{},V=[],pe=[],Fe=[],B={name:x,Hidden:0},W.Sheets.push(B);break;case"table":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;f.push([l[3],!1]),Ae=[],qe=!1}break;case"style":l[1]==="/"?W5(J,U,t):U=zn(l[0]);break;case"numberformat":U.nf=ot(zn(l[0]).Format||"General"),Bc[U.nf]&&(U.nf=Bc[U.nf]);for(var be=0;be!=392&&ze[be]!=U.nf;++be);if(be==392){for(be=57;be!=392;++be)if(ze[be]==null){Ka(U.nf,be);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(Se=zn(l[0]),Se.Hidden&&(Se.hidden=!0,delete Se.Hidden),Se.Width&&(Se.wpx=parseInt(Se.Width,10)),!qe&&Se.wpx>10){qe=!0,Wr=V2;for(var fe=0;fe<Ae.length;++fe)Ae[fe]&&lo(Ae[fe])}qe&&lo(Se),Ae[Se.Index-1||Ae.length]=Se;for(var Je=0;Je<+Se.Span;++Je)Ae[Ae.length]=dr(Se);break;case"namedrange":if(l[1]==="/")break;W.Names||(W.Names=[]);var O=Pe(l[0]),ht={Name:O.Name,Ref:ao(O.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(ht.Sheet=W.Sheets.length-1),W.Names.push(ht);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?D+=n.slice(j,l.index):j=l.index+l[0].length;break;case"interior":if(!t.cellStyles)break;U.Interior=zn(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?kD(re,ae,n.slice(X,l.index)):X=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else f.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));V5(he),Ce.push(he)}else f.push([l[3],!1]),d=zn(l[0]),he={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var rt=zn(l[0]);g["!autofilter"]={ref:ao(rt.Range).replace(/\$/g,"")},f.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&f.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=f.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&f.push([l[3],!0]);break;case"null":break;default:if(f.length==0&&l[3]=="document"||f.length==0&&l[3]=="uof")return Lw(n,t);var Ze=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ze=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ze=!1}break;case"excelworkbook":switch(l[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ze=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ze=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(X,l.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else X=l.index+l[0].length;break;case"header":g["!margins"]||Mc(g["!margins"]={},"xlml"),isNaN(+Pe(l[0]).Margin)||(g["!margins"].header=+Pe(l[0]).Margin);break;case"footer":g["!margins"]||Mc(g["!margins"]={},"xlml"),isNaN(+Pe(l[0]).Margin)||(g["!margins"].footer=+Pe(l[0]).Margin);break;case"pagemargins":var Xe=Pe(l[0]);g["!margins"]||Mc(g["!margins"]={},"xlml"),isNaN(+Xe.Top)||(g["!margins"].top=+Xe.Top),isNaN(+Xe.Left)||(g["!margins"].left=+Xe.Left),isNaN(+Xe.Right)||(g["!margins"].right=+Xe.Right),isNaN(+Xe.Bottom)||(g["!margins"].bottom=+Xe.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ze=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ze=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ze=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ze=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ze=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ze=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ze=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ze=!1}break;case"smarttags":break;default:Ze=!1;break}if(Ze||l[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?B5(te,ae,me,n.slice(X,l.index)):(me=l,X=l.index+l[0].length);break}if(t.WTF)throw"Unrecognized tag: "+l[3]+"|"+f.join("|")}var we={};return!t.bookSheets&&!t.bookProps&&(we.Sheets=h),we.SheetNames=p,we.Workbook=W,we.SSF=dr(ze),we.Props=re,we.Custprops=te,we}function $m(e,r){switch(Tp(r=r||{}),r.type||"base64"){case"base64":return Mm(hn(e),r);case"binary":case"buffer":case"file":return Mm(e,r);case"array":return Mm(es(e),r)}}function z5(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=nD(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=iD(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var G5=[60,1084,2066,2165,2175];function X5(e,r,t,n,i){var a=n,o=[],l=t.slice(t.l,t.l+a);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),t.l+=a;for(var f=Di(t,t.l),d=jm[f],h=0;d!=null&&G5.indexOf(f)>-1;)a=Di(t,t.l+2),h=t.l+4,f==2066?h+=4:(f==2165||f==2175)&&(h+=12),l=t.slice(h,t.l+4+a),o.push(l),t.l+=4+a,d=jm[f=Di(t,t.l)];var p=ha(o);ur(p,0);var g=0;p.lens=[];for(var x=0;x<o.length;++x)p.lens.push(g),g+=o[x].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return r.f(p,p.length,i)}function ci(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=ze[n])}catch(a){if(r.WTF)throw a}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ns[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Uc(e.v):e.w=qa(e.v):e.w=In(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(a){if(r.WTF)throw a}if(r.cellDates&&n&&e.t=="n"&&fo(ze[n]||String(n))){var i=ja(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function gu(e,r,t){return{v:e,ixfe:r,t}}function $5(e,r){var t={opts:{}},n={};Gt!=null&&r.dense==null&&(r.dense=Gt);var i=r.dense?[]:{},a={},o={},l=null,f=[],d="",h={},p,g="",x,v,_,y,N={},R=[],T,z,J=[],U=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},V=function(He){return He<8?Ya[He]:He<64&&U[He-8]||Ya[He]},re=function(He,yt,pr){var Ct=yt.XF.data;if(!(!Ct||!Ct.patternType||!pr||!pr.cellStyles)){yt.s={},yt.s.patternType=Ct.patternType;var Nn;(Nn=zc(V(Ct.icvFore)))&&(yt.s.fgColor={rgb:Nn}),(Nn=zc(V(Ct.icvBack)))&&(yt.s.bgColor={rgb:Nn})}},te=function(He,yt,pr){if(!(oe>1)&&!(pr.sheetRows&&He.r>=pr.sheetRows)){if(pr.cellStyles&&yt.XF&&yt.XF.data&&re(He,yt,pr),delete yt.ixfe,delete yt.XF,p=He,g=Be(He),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),He.r<o.s.r&&(o.s.r=He.r),He.c<o.s.c&&(o.s.c=He.c),He.r+1>o.e.r&&(o.e.r=He.r+1),He.c+1>o.e.c&&(o.e.c=He.c+1),pr.cellFormula&&yt.f){for(var Ct=0;Ct<R.length;++Ct)if(!(R[Ct][0].s.c>He.c||R[Ct][0].s.r>He.r)&&!(R[Ct][0].e.c<He.c||R[Ct][0].e.r<He.r)){yt.F=st(R[Ct][0]),(R[Ct][0].s.c!=He.c||R[Ct][0].s.r!=He.r)&&delete yt.f,yt.f&&(yt.f=""+wr(R[Ct][1],o,He,pe,X));break}}pr.dense?(i[He.r]||(i[He.r]=[]),i[He.r][He.c]=yt):i[g]=yt}},X={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:R,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(X.password=r.password);var me,Ce=[],he=[],Ae=[],Se=[],qe=!1,pe=[];pe.SheetNames=X.snames,pe.sharedf=X.sharedf,pe.arrayf=X.arrayf,pe.names=[],pe.XTI=[];var Fe=0,oe=0,L=0,K=[],W=[],B;X.codepage=1200,$n(1200);for(var ae=!1;e.l<e.length-1;){var Ee=e.l,ve=e.read_shift(2);if(ve===0&&Fe===10)break;var be=e.l===e.length?0:e.read_shift(2),fe=jm[ve];if(fe&&fe.f){if(r.bookSheets&&Fe===133&&ve!==133)break;if(Fe=ve,fe.r===2||fe.r==12){var Je=e.read_shift(2);if(be-=2,!X.enc&&Je!==ve&&((Je&255)<<8|Je>>8)!==ve)throw new Error("rt mismatch: "+Je+"!="+ve);fe.r==12&&(e.l+=10,be-=10)}var O={};if(ve===10?O=fe.f(e,be,X):O=X5(ve,fe,e,be,X),oe==0&&[9,521,1033,2057].indexOf(Fe)===-1)continue;switch(ve){case 34:t.opts.Date1904=D.WBProps.date1904=O;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(X.enc||(e.l=0),X.enc=O,!r.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:X.lastuser=O;break;case 66:var ht=Number(O);switch(ht){case 21010:ht=1200;break;case 32768:ht=1e4;break;case 32769:ht=1252;break}$n(X.codepage=ht),ae=!0;break;case 317:X.rrtabid=O;break;case 25:X.winlocked=O;break;case 439:t.opts.RefreshAll=O;break;case 12:t.opts.CalcCount=O;break;case 16:t.opts.CalcDelta=O;break;case 17:t.opts.CalcIter=O;break;case 13:t.opts.CalcMode=O;break;case 14:t.opts.CalcPrecision=O;break;case 95:t.opts.CalcSaveRecalc=O;break;case 15:X.CalcRefMode=O;break;case 2211:t.opts.FullCalc=O;break;case 129:O.fDialog&&(i["!type"]="dialog"),O.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),O.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:J.push(O);break;case 430:pe.push([O]),pe[pe.length-1].XTI=[];break;case 35:case 547:pe[pe.length-1].push(O);break;case 24:case 536:B={Name:O.Name,Ref:wr(O.rgce,o,null,pe,X)},O.itab>0&&(B.Sheet=O.itab-1),pe.names.push(B),pe[0]||(pe[0]=[],pe[0].XTI=[]),pe[pe.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(W[O.itab-1]={ref:st(O.rgce[0][0][1][2])});break;case 22:X.ExternCount=O;break;case 23:pe.length==0&&(pe[0]=[],pe[0].XTI=[]),pe[pe.length-1].XTI=pe[pe.length-1].XTI.concat(O),pe.XTI=pe.XTI.concat(O);break;case 2196:if(X.biff<8)break;B!=null&&(B.Comment=O[1]);break;case 18:i["!protect"]=O;break;case 19:O!==0&&X.WTF&&console.error("Password verifier: "+O);break;case 133:a[O.pos]=O,X.snames.push(O.name);break;case 10:{if(--oe)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=st(o),r.sheetRows&&r.sheetRows<=o.e.r){var rt=o.e.r;o.e.r=r.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=st(o),o.e.r=rt}o.e.r++,o.e.c++}Ce.length>0&&(i["!merges"]=Ce),he.length>0&&(i["!objects"]=he),Ae.length>0&&(i["!cols"]=Ae),Se.length>0&&(i["!rows"]=Se),D.Sheets.push(j)}d===""?h=i:n[d]=i,i=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(X.biff===8&&(X.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),X.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(X.biff=5,ae=!0,$n(X.codepage=28591)),X.biff==8&&O.BIFFVer==0&&O.dt==16&&(X.biff=2),oe++)break;if(i=r.dense?[]:{},X.biff<8&&!ae&&(ae=!0,$n(X.codepage=r.codepage||1252)),X.biff<5||O.BIFFVer==0&&O.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Ze={pos:e.l-be,name:d};a[Ze.pos]=Ze,X.snames.push(d)}else d=(a[Ee]||{name:""}).name;O.dt==32&&(i["!type"]="chart"),O.dt==64&&(i["!type"]="macro"),Ce=[],he=[],X.arrayf=R=[],Ae=[],Se=[],qe=!1,j={Hidden:(a[Ee]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(r.dense?(i[O.r]||[])[O.c]:i[Be({c:O.c,r:O.r})])&&++O.c,T={ixfe:O.ixfe,XF:J[O.ixfe]||{},v:O.val,t:"n"},L>0&&(T.z=K[T.ixfe>>8&63]),ci(T,r,t.opts.Date1904),te({c:O.c,r:O.r},T,r);break;case 5:case 517:T={ixfe:O.ixfe,XF:J[O.ixfe],v:O.val,t:O.t},L>0&&(T.z=K[T.ixfe>>8&63]),ci(T,r,t.opts.Date1904),te({c:O.c,r:O.r},T,r);break;case 638:T={ixfe:O.ixfe,XF:J[O.ixfe],v:O.rknum,t:"n"},L>0&&(T.z=K[T.ixfe>>8&63]),ci(T,r,t.opts.Date1904),te({c:O.c,r:O.r},T,r);break;case 189:for(var Xe=O.c;Xe<=O.C;++Xe){var we=O.rkrec[Xe-O.c][0];T={ixfe:we,XF:J[we],v:O.rkrec[Xe-O.c][1],t:"n"},L>0&&(T.z=K[T.ixfe>>8&63]),ci(T,r,t.opts.Date1904),te({c:Xe,r:O.r},T,r)}break;case 6:case 518:case 1030:{if(O.val=="String"){l=O;break}if(T=gu(O.val,O.cell.ixfe,O.tt),T.XF=J[T.ixfe],r.cellFormula){var gt=O.formula;if(gt&&gt[0]&&gt[0][0]&&gt[0][0][0]=="PtgExp"){var Tt=gt[0][0][1][0],mr=gt[0][0][1][1],zr=Be({r:Tt,c:mr});N[zr]?T.f=""+wr(O.formula,o,O.cell,pe,X):T.F=((r.dense?(i[Tt]||[])[mr]:i[zr])||{}).F}else T.f=""+wr(O.formula,o,O.cell,pe,X)}L>0&&(T.z=K[T.ixfe>>8&63]),ci(T,r,t.opts.Date1904),te(O.cell,T,r),l=O}break;case 7:case 519:if(l)l.val=O,T=gu(O,l.cell.ixfe,"s"),T.XF=J[T.ixfe],r.cellFormula&&(T.f=""+wr(l.formula,o,l.cell,pe,X)),L>0&&(T.z=K[T.ixfe>>8&63]),ci(T,r,t.opts.Date1904),te(l.cell,T,r),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{R.push(O);var ba=Be(O[0].s);if(x=r.dense?(i[O[0].s.r]||[])[O[0].s.c]:i[ba],r.cellFormula&&x){if(!l||!ba||!x)break;x.f=""+wr(O[1],o,O[0],pe,X),x.F=st(O[0])}}break;case 1212:{if(!r.cellFormula)break;if(g){if(!l)break;N[Be(l.cell)]=O[0],x=r.dense?(i[l.cell.r]||[])[l.cell.c]:i[Be(l.cell)],(x||{}).f=""+wr(O[0],o,p,pe,X)}}break;case 253:T=gu(f[O.isst].t,O.ixfe,"s"),f[O.isst].h&&(T.h=f[O.isst].h),T.XF=J[T.ixfe],L>0&&(T.z=K[T.ixfe>>8&63]),ci(T,r,t.opts.Date1904),te({c:O.c,r:O.r},T,r);break;case 513:r.sheetStubs&&(T={ixfe:O.ixfe,XF:J[O.ixfe],t:"z"},L>0&&(T.z=K[T.ixfe>>8&63]),ci(T,r,t.opts.Date1904),te({c:O.c,r:O.r},T,r));break;case 190:if(r.sheetStubs)for(var Gr=O.c;Gr<=O.C;++Gr){var Cr=O.ixfe[Gr-O.c];T={ixfe:Cr,XF:J[Cr],t:"z"},L>0&&(T.z=K[T.ixfe>>8&63]),ci(T,r,t.opts.Date1904),te({c:Gr,r:O.r},T,r)}break;case 214:case 516:case 4:T=gu(O.val,O.ixfe,"s"),T.XF=J[T.ixfe],L>0&&(T.z=K[T.ixfe>>8&63]),ci(T,r,t.opts.Date1904),te({c:O.c,r:O.r},T,r);break;case 0:case 512:oe===1&&(o=O);break;case 252:f=O;break;case 1054:if(X.biff==4){K[L++]=O[1];for(var Fr=0;Fr<L+163&&ze[Fr]!=O[1];++Fr);Fr>=163&&Ka(O[1],L+163)}else Ka(O[1],O[0]);break;case 30:{K[L++]=O;for(var Ir=0;Ir<L+163&&ze[Ir]!=O;++Ir);Ir>=163&&Ka(O,L+163)}break;case 229:Ce=Ce.concat(O);break;case 93:he[O.cmo[0]]=X.lastobj=O;break;case 438:X.lastobj.TxO=O;break;case 127:X.lastobj.ImData=O;break;case 440:for(y=O[0].s.r;y<=O[0].e.r;++y)for(_=O[0].s.c;_<=O[0].e.c;++_)x=r.dense?(i[y]||[])[_]:i[Be({c:_,r:y})],x&&(x.l=O[1]);break;case 2048:for(y=O[0].s.r;y<=O[0].e.r;++y)for(_=O[0].s.c;_<=O[0].e.c;++_)x=r.dense?(i[y]||[])[_]:i[Be({c:_,r:y})],x&&x.l&&(x.l.Tooltip=O[1]);break;case 28:{if(X.biff<=5&&X.biff>=2)break;x=r.dense?(i[O[0].r]||[])[O[0].c]:i[Be(O[0])];var mi=he[O[2]];x||(r.dense?(i[O[0].r]||(i[O[0].r]=[]),x=i[O[0].r][O[0].c]={t:"z"}):x=i[Be(O[0])]={t:"z"},o.e.r=Math.max(o.e.r,O[0].r),o.s.r=Math.min(o.s.r,O[0].r),o.e.c=Math.max(o.e.c,O[0].c),o.s.c=Math.min(o.s.c,O[0].c)),x.c||(x.c=[]),v={a:O[1],t:mi.TxO.t},x.c.push(v)}break;case 2173:mP(J[O.ixfe],O.ext);break;case 125:{if(!X.cellStyles)break;for(;O.e>=O.s;)Ae[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},qe||(qe=!0,vp(O.w/256)),lo(Ae[O.e+1])}break;case 520:{var Xt={};O.level!=null&&(Se[O.r]=Xt,Xt.level=O.level),O.hidden&&(Se[O.r]=Xt,Xt.hidden=!0),O.hpt&&(Se[O.r]=Xt,Xt.hpt=O.hpt,Xt.hpx=Gc(O.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Mc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=O;break;case 161:i["!margins"]||Mc(i["!margins"]={}),i["!margins"].header=O.header,i["!margins"].footer=O.footer;break;case 574:O.RTL&&(D.Views[0].RTL=!0);break;case 146:U=O;break;case 2198:me=O;break;case 140:z=O;break;case 442:d?j.CodeName=O||j.name:D.WBProps.CodeName=O||"ThisWorkbook";break}}else fe||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),e.l+=be}return t.SheetNames=ui(a).sort(function(Xr,He){return Number(Xr)-Number(He)}).map(function(Xr){return a[Xr].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&h["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=h)):t.Preamble=h,t.Sheets&&W.forEach(function(Xr,He){t.Sheets[t.SheetNames[He]]["!autofilter"]=Xr}),t.Strings=f,t.SSF=dr(ze),X.enc&&(t.Encryption=X.enc),me&&(t.Themes=me),t.Metadata={},z!==void 0&&(t.Metadata.Country=z),pe.names.length>0&&(D.Names=pe.names),t.Workbook=D,t}var Rw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function j5(e,r,t){var n=at.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=mw(n,fD,Rw.DSI);for(var a in i)r[a]=i[a]}catch(d){if(t.WTF)throw d}var o=at.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=mw(o,uD,Rw.SI);for(var f in l)r[f]==null&&(r[f]=l[f])}catch(d){if(t.WTF)throw d}r.HeadingPairs&&r.TitlesOfParts&&(k2(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function cy(e,r){r||(r={}),Tp(r),Hw(),r.codepage&&Jm(r.codepage);var t,n;if(e.FullPaths){if(at.find(e,"/encryption"))throw new Error("File is password-protected");t=at.find(e,"!CompObj"),n=at.find(e,"/Workbook")||at.find(e,"/Book")}else{switch(r.type){case"base64":e=Xn(hn(e));break;case"binary":e=Xn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ur(e,0),n={content:e}}var i,a;if(t&&z5(t),r.bookProps&&!r.bookSheets)i={};else{var o=it?"buffer":"array";if(n&&n.content)i=$5(n.content,r);else if((a=at.find(e,"PerfectOffice_MAIN"))&&a.content)i=Pc.to_workbook(a.content,(r.type=o,r));else if((a=at.find(e,"NativeContent_MAIN"))&&a.content)i=Pc.to_workbook(a.content,(r.type=o,r));else throw(a=at.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&at.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=NP(e))}var l={};return e.FullPaths&&j5(e,l,r),i.Props=i.Custprops=l,r.bookFiles&&(i.cfb=e),i}var Au={0:{f:CL},1:{f:NL},2:{f:HL},3:{f:LL},4:{f:OL},5:{f:WL},6:{f:GL},7:{f:BL},8:{f:YL},9:{f:KL},10:{f:$L},11:{f:jL},12:{f:DL},13:{f:VL},14:{f:ML},15:{f:PL},16:{f:ny},17:{f:XL},18:{f:UL},19:{f:hp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:y5},40:{},42:{},43:{f:$8},44:{f:X8},45:{f:j8},46:{f:Y8},47:{f:K8},48:{},49:{f:qN},50:{},51:{f:gP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:M2},62:{f:zL},63:{f:wP},64:{f:i5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Sr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:n5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:RL},148:{f:FL,p:16},151:{f:JL},152:{},153:{f:b5},154:{},155:{},156:{f:v5},157:{},158:{},159:{T:1,f:u8},160:{T:-1},161:{T:1,f:rs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:pP},336:{T:-1},337:{f:_P,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:L2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZL},427:{f:e5},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:r5},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:IL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:QL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:FP},633:{T:1},634:{T:-1},635:{T:1,f:CP},636:{T:-1},637:{f:JN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:f5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:a5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},jm={6:{f:Pm},10:{f:da},12:{f:Vt},13:{f:Vt},14:{f:Bt},15:{f:Bt},16:{f:yr},17:{f:Bt},18:{f:Bt},19:{f:Vt},20:{f:xw},21:{f:xw},23:{f:L2},24:{f:bw},25:{f:Bt},26:{},27:{},28:{f:SO},29:{},34:{f:Bt},35:{f:vw},38:{f:yr},39:{f:yr},40:{f:yr},41:{f:yr},42:{f:Bt},43:{f:Bt},47:{f:I8},49:{f:oO},51:{f:Vt},60:{},61:{f:iO},64:{f:Bt},65:{f:sO},66:{f:Vt},77:{},80:{},81:{},82:{},85:{f:Vt},89:{},90:{},91:{},92:{f:qD},93:{f:CO},94:{},95:{f:Bt},96:{},97:{},99:{f:Bt},125:{f:M2},128:{f:_O},129:{f:QD},130:{f:Vt},131:{f:Bt},132:{f:Bt},133:{f:JD},134:{},140:{f:OO},141:{f:Vt},144:{},146:{f:LO},151:{},152:{},153:{},154:{},155:{},156:{f:Vt},157:{},158:{},160:{f:HO},161:{f:BO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:hO},190:{f:mO},193:{f:da},197:{},198:{},199:{},200:{},201:{},202:{f:Bt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Vt},220:{},221:{f:Bt},222:{},224:{f:gO},225:{f:YD},226:{f:da},227:{},229:{f:AO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ZD},253:{f:cO},255:{f:eO},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:I2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Bt},353:{f:da},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:vO},431:{f:Bt},432:{},433:{},434:{},437:{},438:{f:RO},439:{f:Bt},440:{f:NO},441:{},442:{f:Kc},443:{},444:{f:Vt},445:{},446:{},448:{f:da},449:{f:nO,r:2},450:{f:da},512:{f:gw},513:{f:WO},515:{f:xO},516:{f:lO},517:{f:_w},519:{f:VO},520:{f:tO},523:{},545:{f:ww},549:{f:pw},566:{},574:{f:aO},638:{f:dO},659:{},1048:{},1054:{f:fO},1084:{},1212:{f:EO},2048:{f:DO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:hu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:da},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:MO,r:12},2173:{f:hP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Bt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yO,r:12},2197:{},2198:{f:oP,r:12},2199:{},2200:{},2201:{},2202:{f:TO,r:12},2203:{f:da},2204:{},2205:{},2206:{},2207:{},2211:{f:rO},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Vt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:UO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:PO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:gw},1:{},2:{f:$O},3:{f:XO},4:{f:GO},5:{f:_w},7:{f:jO},8:{},9:{f:hu},11:{},22:{f:Vt},30:{f:uO},31:{},32:{},33:{f:ww},36:{},37:{f:pw},50:{f:KO},62:{},52:{},67:{},68:{f:Vt},69:{},86:{},126:{},127:{f:zO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:YO},223:{},234:{},354:{},421:{},518:{f:Pm},521:{f:hu},536:{f:bw},547:{f:vw},561:{},579:{},1030:{f:Pm},1033:{f:hu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Gn(e,r,t,n){var i=r;if(!isNaN(i)){var a=n||(t||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&_2(t)&&e.push(t)}}function Nw(e,r){var t=r||{};Gt!=null&&t.dense==null&&(t.dense=Gt);var n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=i.index,l=a&&a.index||e.length,f=xN(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,p=0,g=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(o=0;o<f.length;++o){var _=f[o].trim(),y=_.slice(0,3).toLowerCase();if(y=="<tr"){if(++d,t.sheetRows&&t.sheetRows<=d){--d;break}h=0;continue}if(!(y!="<td"&&y!="<th")){var N=_.split(/<\/t[dh]>/i);for(l=0;l<N.length;++l){var R=N[l].trim();if(R.match(/<t[dh]/i)){for(var T=R,z=0;T.charAt(0)=="<"&&(z=T.indexOf(">"))>-1;)T=T.slice(z+1);for(var J=0;J<v.length;++J){var U=v[J];U.s.c==h&&U.s.r<d&&d<=U.e.r&&(h=U.e.c+1,J=-1)}var D=Pe(R.slice(0,R.indexOf(">")));g=D.colspan?+D.colspan:1,((p=+D.rowspan)>1||g>1)&&v.push({s:{r:d,c:h},e:{r:d+(p||1)-1,c:h+g-1}});var j=D.t||D["data-t"]||"";if(!T.length){h+=g;continue}if(T=l2(T),x.s.r>d&&(x.s.r=d),x.e.r<d&&(x.e.r=d),x.s.c>h&&(x.s.c=h),x.e.c<h&&(x.e.c=h),!T.length){h+=g;continue}var V={t:"s",v:T};t.raw||!T.trim().length||j=="s"||(T==="TRUE"?V={t:"b",v:!0}:T==="FALSE"?V={t:"b",v:!1}:isNaN(Kn(T))?isNaN(co(T).getDate())||(V={t:"d",v:sr(T)},t.cellDates||(V={t:"n",v:Vr(V.v)}),V.z=t.dateNF||ze[14]):V={t:"n",v:Kn(T)}),t.dense?(n[d]||(n[d]=[]),n[d][h]=V):n[Be({r:d,c:h})]=V,h+=g}}}}return n["!ref"]=st(x),v.length&&(n["!merges"]=v),n}function K5(e,r,t,n){for(var i=e["!merges"]||[],a=[],o=r.s.c;o<=r.e.c;++o){for(var l=0,f=0,d=0;d<i.length;++d)if(!(i[d].s.r>t||i[d].s.c>o)&&!(i[d].e.r<t||i[d].e.c<o)){if(i[d].s.r<t||i[d].s.c<o){l=-1;break}l=i[d].e.r-i[d].s.r+1,f=i[d].e.c-i[d].s.c+1;break}if(!(l<0)){var h=Be({r:t,c:o}),p=n.dense?(e[t]||[])[o]:e[h],g=p&&p.v!=null&&(p.h||ip(p.w||(Li(p),p.w)||""))||"",x={};l>1&&(x.rowspan=l),f>1&&(x.colspan=f),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(x["data-t"]=p&&p.t||"z",p.v!=null&&(x["data-v"]=p.v),p.z!=null&&(x["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),x.id=(n.id||"sjs")+"-"+h,a.push(DN("td",g,x))}}var v="<tr>";return v+a.join("")+"</tr>"}var Y5='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',q5="</body></html>";function Q5(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return va(Nw(t[0],r),r);var n=Sp();return t.forEach(function(i,a){Ap(n,Nw(i,r),"Sheet"+(a+1))}),n}function J5(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Z5(e,r){var t=r||{},n=t.header!=null?t.header:Y5,i=t.footer!=null?t.footer:q5,a=[n],o=ho(e["!ref"]);t.dense=Array.isArray(e),a.push(J5(e,o,t));for(var l=o.s.r;l<=o.e.r;++l)a.push(K5(e,o,l,t));return a.push("</table>"+i),a.join("")}function ly(e,r,t){var n=t||{};Gt!=null&&(n.dense=Gt);var i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Hr(n.origin):n.origin;i=o.r,a=o.c}var l=r.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var h=ho(e["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),i==-1&&(d.e.r=i=h.e.r+1)}var p=[],g=0,x=e["!rows"]||(e["!rows"]=[]),v=0,_=0,y=0,N=0,R=0,T=0;for(e["!cols"]||(e["!cols"]=[]);v<l.length&&_<f;++v){var z=l[v];if(Dw(z)){if(n.display)continue;x[_]={hidden:!0}}var J=z.children;for(y=N=0;y<J.length;++y){var U=J[y];if(!(n.display&&Dw(U))){var D=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):l2(U.innerHTML),j=U.getAttribute("data-z")||U.getAttribute("z");for(g=0;g<p.length;++g){var V=p[g];V.s.c==N+a&&V.s.r<_+i&&_+i<=V.e.r&&(N=V.e.c+1-a,g=-1)}T=+U.getAttribute("colspan")||1,((R=+U.getAttribute("rowspan")||1)>1||T>1)&&p.push({s:{r:_+i,c:N+a},e:{r:_+i+(R||1)-1,c:N+a+(T||1)-1}});var re={t:"s",v:D},te=U.getAttribute("data-t")||U.getAttribute("t")||"";D!=null&&(D.length==0?re.t=te||"z":n.raw||D.trim().length==0||te=="s"||(D==="TRUE"?re={t:"b",v:!0}:D==="FALSE"?re={t:"b",v:!1}:isNaN(Kn(D))?isNaN(co(D).getDate())||(re={t:"d",v:sr(D)},n.cellDates||(re={t:"n",v:Vr(re.v)}),re.z=n.dateNF||ze[14]):re={t:"n",v:Kn(D)})),re.z===void 0&&j!=null&&(re.z=j);var X="",me=U.getElementsByTagName("A");if(me&&me.length)for(var Ce=0;Ce<me.length&&!(me[Ce].hasAttribute("href")&&(X=me[Ce].getAttribute("href"),X.charAt(0)!="#"));++Ce);X&&X.charAt(0)!="#"&&(re.l={Target:X}),n.dense?(e[_+i]||(e[_+i]=[]),e[_+i][N+a]=re):e[Be({c:N+a,r:_+i})]=re,d.e.c<N+a&&(d.e.c=N+a),N+=T}}++_}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,_-1+i),e["!ref"]=st(d),_>=f&&(e["!fullref"]=st((d.e.r=l.length-v+_-1+i,d))),e}function fy(e,r){var t=r||{},n=t.dense?[]:{};return ly(n,e,r)}function eM(e,r){return va(fy(e,r),r)}function Dw(e){var r="",t=tM(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function tM(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function rM(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=ot(r.replace(/<[^>]*>/g,""));return[t]}var Ow={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function uy(e,r){var t=r||{};Gt!=null&&t.dense==null&&(t.dense=Gt);var n=ap(e),i=[],a,o,l={name:""},f="",d=0,h,p,g={},x=[],v=t.dense?[]:{},_,y,N={value:""},R="",T=0,z,J=[],U=-1,D=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,re={},te=[],X={},me=0,Ce=0,he=[],Ae=1,Se=1,qe=[],pe={Names:[]},Fe={},oe=["",""],L=[],K={},W="",B=0,ae=!1,Ee=!1,ve=0;for(Hc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=Hc.exec(n);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":_[1]==="/"?(j.e.c>=j.s.c&&j.e.r>=j.s.r?v["!ref"]=st(j):v["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=j.e.r&&(v["!fullref"]=v["!ref"],j.e.r=t.sheetRows-1,v["!ref"]=st(j)),te.length&&(v["!merges"]=te),he.length&&(v["!rows"]=he),h.name=h.\u540D\u79F0||h.name,typeof JSON<"u"&&JSON.stringify(h),x.push(h.name),g[h.name]=v,Ee=!1):_[0].charAt(_[0].length-2)!=="/"&&(h=Pe(_[0],!1),U=D=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,v=t.dense?[]:{},te=[],he=[],Ee=!0);break;case"table-row-group":_[1]==="/"?--V:++V;break;case"table-row":case"\u884C":if(_[1]==="/"){U+=Ae,Ae=1;break}if(p=Pe(_[0],!1),p.\u884C\u53F7?U=p.\u884C\u53F7-1:U==-1&&(U=0),Ae=+p["number-rows-repeated"]||1,Ae<10)for(ve=0;ve<Ae;++ve)V>0&&(he[U+ve]={level:V});D=-1;break;case"covered-table-cell":_[1]!=="/"&&++D,t.sheetStubs&&(t.dense?(v[U]||(v[U]=[]),v[U][D]={t:"z"}):v[Be({r:U,c:D})]={t:"z"}),R="",J=[];break;case"table-cell":case"\u6570\u636E":if(_[0].charAt(_[0].length-2)==="/")++D,N=Pe(_[0],!1),Se=parseInt(N["number-columns-repeated"]||"1",10),y={t:"z",v:null},N.formula&&t.cellFormula!=!1&&(y.f=Cw(ot(N.formula))),(N.\u6570\u636E\u7C7B\u578B||N["value-type"])=="string"&&(y.t="s",y.v=ot(N["string-value"]||""),t.dense?(v[U]||(v[U]=[]),v[U][D]=y):v[Be({r:U,c:D})]=y),D+=Se-1;else if(_[1]!=="/"){++D,R="",T=0,J=[],Se=1;var be=Ae?U+Ae-1:U;if(D>j.e.c&&(j.e.c=D),D<j.s.c&&(j.s.c=D),U<j.s.r&&(j.s.r=U),be>j.e.r&&(j.e.r=be),N=Pe(_[0],!1),L=[],K={},y={t:N.\u6570\u636E\u7C7B\u578B||N["value-type"],v:null},t.cellFormula)if(N.formula&&(N.formula=ot(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(me=parseInt(N["number-matrix-rows-spanned"],10)||0,Ce=parseInt(N["number-matrix-columns-spanned"],10)||0,X={s:{r:U,c:D},e:{r:U+me-1,c:D+Ce-1}},y.F=st(X),qe.push([X,y.F])),N.formula)y.f=Cw(N.formula);else for(ve=0;ve<qe.length;++ve)U>=qe[ve][0].s.r&&U<=qe[ve][0].e.r&&D>=qe[ve][0].s.c&&D<=qe[ve][0].e.c&&(y.F=qe[ve][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(me=parseInt(N["number-rows-spanned"],10)||0,Ce=parseInt(N["number-columns-spanned"],10)||0,X={s:{r:U,c:D},e:{r:U+me-1,c:D+Ce-1}},te.push(X)),N["number-columns-repeated"]&&(Se=parseInt(N["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=At(N["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(N.value);break;case"percentage":y.t="n",y.v=parseFloat(N.value);break;case"currency":y.t="n",y.v=parseFloat(N.value);break;case"date":y.t="d",y.v=sr(N["date-value"]),t.cellDates||(y.t="n",y.v=Vr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=pN(N["time-value"])/86400,t.cellDates&&(y.t="d",y.v=Fu(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(N.\u6570\u636E\u6570\u503C);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",N["string-value"]!=null&&(R=ot(N["string-value"]),J=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(ae=!1,y.t==="s"&&(y.v=R||"",J.length&&(y.R=J),ae=T==0),Fe.Target&&(y.l=Fe),L.length>0&&(y.c=L,L=[]),R&&t.cellText!==!1&&(y.w=R),ae&&(y.t="z",delete y.v),(!ae||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=U))for(var fe=0;fe<Ae;++fe){if(Se=parseInt(N["number-columns-repeated"]||"1",10),t.dense)for(v[U+fe]||(v[U+fe]=[]),v[U+fe][D]=fe==0?y:dr(y);--Se>0;)v[U+fe][D+Se]=dr(y);else for(v[Be({r:U+fe,c:D})]=y;--Se>0;)v[Be({r:U+fe,c:D+Se})]=dr(y);j.e.c<=D&&(j.e.c=D)}Se=parseInt(N["number-columns-repeated"]||"1",10),D+=Se-1,Se=0,y={},R="",J=[]}Fe={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a;K.t=R,J.length&&(K.R=J),K.a=W,L.push(K)}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);W="",B=0,R="",T=0,J=[];break;case"creator":_[1]==="/"?W=n.slice(B,_.index):B=_.index+_[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);R="",T=0,J=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(re[l.name]=f,(a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&(f="",l=Pe(_[0],!1),i.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Pe(_[0],!1),f+=Ow[_[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Pe(_[0],!1),f+=Ow[_[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,_.index);break}else d=_.index+_[0].length;break;case"named-range":o=Pe(_[0],!1),oe=Lm(o["cell-range-address"]);var Je={Name:o.name,Ref:oe[0]+"!"+oe[1]};Ee&&(Je.Sheet=x.length),pe.Names.push(Je);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(_[1]==="/"&&(!N||!N["string-value"])){var O=rM(n.slice(T,_.index),z);R=(R.length>0?R+`
`:"")+O[0]}else z=Pe(_[0],!1),T=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{oe=Lm(Pe(_[0])["target-range-address"]),g[oe[0]]["!autofilter"]={ref:oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(Fe=Pe(_[0],!1),!Fe.href)break;Fe.Target=ot(Fe.href),delete Fe.href,Fe.Target.charAt(0)=="#"&&Fe.Target.indexOf(".")>-1?(oe=Lm(Fe.Target.slice(1)),Fe.Target="#"+oe[0]+"!"+oe[1]):Fe.Target.match(/^\.\.[\\\/]/)&&(Fe.Target=Fe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(t.WTF)throw new Error(_)}}var ht={Sheets:g,SheetNames:x,Workbook:pe};return t.bookSheets&&delete ht.Sheets,ht}function Pw(e,r){r=r||{},Fn(e,"META-INF/manifest.xml")&&xD(Ht(e,"META-INF/manifest.xml"),r);var t=dn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=uy(wt(t),r);return Fn(e,"meta.xml")&&(n.Props=T2(Ht(e,"meta.xml"))),n}function Lw(e,r){return uy(e,r)}function yp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Km(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):wt(es(e))}function Ym(e){var r=e.reduce(function(i,a){return i+a.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(i){t.set(i,n),n+=i.length}),t}function Mw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function nM(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,i=r+13;i>=r;--i)n=n*256+e[i];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function Xc(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Jt(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Er(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],i=Xc(e,t),a=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(a){case 0:{for(var f=t[0];e[t[0]++]>=128;);l=e.slice(f,t[0])}break;case 5:o=4,l=e.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,l=e.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=Xc(e,t),l=e.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var d={data:l,type:a};r[i]==null?r[i]=[d]:r[i].push(d)}return r}function Ep(e,r){return e?.map(function(t){return r(t.data)})||[]}function iM(e){for(var r,t=[],n=[0];n[0]<e.length;){var i=Xc(e,n),a=Er(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Jt(a[1][0].data),messages:[]};a[2].forEach(function(l){var f=Er(l.data),d=Jt(f[3][0].data);o.messages.push({meta:f,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(r=a[3])!=null&&r[0]&&(o.merge=Jt(a[3][0].data)>>>0>0),t.push(o)}return t}function aM(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Xc(r,t),i=[];t[0]<r.length;){var a=r[t[0]]&3;if(a==0){var o=r[t[0]++]>>2;if(o<60)++o;else{var l=o-59;o=r[t[0]],l>1&&(o|=r[t[0]+1]<<8),l>2&&(o|=r[t[0]+2]<<16),l>3&&(o|=r[t[0]+3]<<24),o>>>=0,o++,t[0]+=l}i.push(r.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var f=0,d=0;if(a==1?(d=(r[t[0]]>>2&7)+4,f=(r[t[0]++]&224)<<3,f|=r[t[0]++]):(d=(r[t[0]++]>>2)+1,a==2?(f=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(f=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Ym(i)],f==0)throw new Error("Invalid offset 0");if(f>i[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(i.push(i[0].slice(-f)),d-=f;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-f,-f+d))}}var h=Ym(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function sM(e){for(var r=[],t=0;t<e.length;){var n=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(aM(n,e.slice(t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Ym(r)}function oM(e,r,t,n){var i=yp(e),a=i.getUint32(4,!0),o=(n>1?12:8)+Mw(a&(n>1?3470:398))*4,l=-1,f=-1,d=NaN,h=new Date(2001,0,1);a&512&&(l=i.getUint32(o,!0),o+=4),o+=Mw(a&(n>1?12288:4096))*4,a&16&&(f=i.getUint32(o,!0),o+=4),a&32&&(d=i.getFloat64(o,!0),o+=8),a&64&&(h.setTime(h.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:r[f]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(l>-1)p={t:"s",v:t[l]};else if(f>-1)p={t:"s",v:r[f]};else if(!isNaN(d))p={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function cM(e,r,t){var n=yp(e),i=n.getUint32(8,!0),a=12,o=-1,l=-1,f=NaN,d=NaN,h=new Date(2001,0,1);i&1&&(f=nM(e,a),a+=16),i&2&&(d=n.getFloat64(a,!0),a+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(l=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:r[l]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:t[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return p}function lM(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return oM(e,r,t,e[0]);case 5:return cM(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ga(e){var r=Er(e);return Xc(r[1][0].data)}function Bw(e,r){var t=Er(r.data),n=Jt(t[1][0].data),i=t[3],a=[];return(i||[]).forEach(function(o){var l=Er(o.data),f=Jt(l[1][0].data)>>>0;switch(n){case 1:a[f]=Km(l[3][0].data);break;case 8:{var d=e[ga(l[9][0].data)][0],h=Er(d.data),p=e[ga(h[1][0].data)][0],g=Jt(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var x=Er(p.data);a[f]=x[3].map(function(v){return Km(v.data)}).join("")}break}}),a}function fM(e,r){var t,n,i,a,o,l,f,d,h,p,g,x,v,_,y=Er(e),N=Jt(y[1][0].data)>>>0,R=Jt(y[2][0].data)>>>0,T=((n=(t=y[8])==null?void 0:t[0])==null?void 0:n.data)&&Jt(y[8][0].data)>0||!1,z,J;if((a=(i=y[7])==null?void 0:i[0])!=null&&a.data&&r!=0)z=(l=(o=y[7])==null?void 0:o[0])==null?void 0:l.data,J=(d=(f=y[6])==null?void 0:f[0])==null?void 0:d.data;else if((p=(h=y[4])==null?void 0:h[0])!=null&&p.data&&r!=1)z=(x=(g=y[4])==null?void 0:g[0])==null?void 0:x.data,J=(_=(v=y[3])==null?void 0:v[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var U=T?4:1,D=yp(z),j=[],V=0;V<z.length/2;++V){var re=D.getUint16(V*2,!0);re<65535&&j.push([V,re])}if(j.length!=R)throw"Expected ".concat(R," cells, found ").concat(j.length);var te=[];for(V=0;V<j.length-1;++V)te[j[V][0]]=J.subarray(j[V][1]*U,j[V+1][1]*U);return j.length>=1&&(te[j[j.length-1][0]]=J.subarray(j[j.length-1][1]*U)),{R:N,cells:te}}function uM(e,r){var t,n=Er(r.data),i=(t=n?.[7])!=null&&t[0]?Jt(n[7][0].data)>>>0>0?1:0:-1,a=Ep(n[5],function(o){return fM(o,i)});return{nrows:Jt(n[4][0].data)>>>0,data:a.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(f,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=f}),o},[])}}function dM(e,r,t){var n,i=Er(r.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Jt(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Jt(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=st(a);var o=Er(i[4][0].data),l=Bw(e,e[ga(o[4][0].data)][0]),f=(n=o[17])!=null&&n[0]?Bw(e,e[ga(o[17][0].data)][0]):[],d=Er(o[3][0].data),h=0;d[1].forEach(function(p){var g=Er(p.data),x=e[ga(g[2][0].data)][0],v=Jt(x.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var _=uM(e,x);_.data.forEach(function(y,N){y.forEach(function(R,T){var z=Be({r:h+N,c:T}),J=lM(R,l,f);J&&(t[z]=J)})}),h+=_.nrows})}function hM(e,r){var t=Er(r.data),n={"!ref":"A1"},i=e[ga(t[2][0].data)],a=Jt(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return dM(e,i[0],n),n}function mM(e,r){var t,n=Er(r.data),i={name:(t=n[1])!=null&&t[0]?Km(n[1][0].data):"",sheets:[]},a=Ep(n[2],ga);return a.forEach(function(o){e[o].forEach(function(l){var f=Jt(l.meta[1][0].data);f==6e3&&i.sheets.push(hM(e,l))})}),i}function pM(e,r){var t=Sp(),n=Er(r.data),i=Ep(n[1],ga);if(i.forEach(function(a){e[a].forEach(function(o){var l=Jt(o.meta[1][0].data);if(l==2){var f=mM(e,o);f.sheets.forEach(function(d,h){Ap(t,d,h==0?f.name:f.name+"_"+h,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Bm(e){var r,t,n,i,a={},o=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=sM(f.content)}catch(p){return console.log("?? "+f.content.length+" "+(p.message||p))}var h;try{h=iM(d)}catch(p){return console.log("## "+(p.message||p))}h.forEach(function(p){a[p.id]=p.messages,o.push(p.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(t=(r=a?.[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Jt(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||o.forEach(function(f){a[f].forEach(function(d){var h=Jt(d.meta[1][0].data)>>>0;if(h==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return pM(a,l)}function gM(e){return function(t){for(var n=0;n!=e.length;++n){var i=e[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function Tp(e){gM([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function _M(e){return Ni.WS.indexOf(e)>-1?"sheet":Ni.CS&&e==Ni.CS?"chart":Ni.DS&&e==Ni.DS?"dialog":Ni.MS&&e==Ni.MS?"macro":e&&e.length?e:"sheet"}function xM(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,_M(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function vM(e,r,t,n,i,a,o,l,f,d,h,p){try{a[n]=Dc(dn(e,t,!0),r);var g=Ht(e,r),x;switch(l){case"sheet":x=k5(g,r,i,f,a[n],d,h,p);break;case"chart":if(x=S5(g,r,i,f,a[n],d,h,p),!x||!x["!drawel"])break;var v=Cc(x["!drawel"].Target,r),_=zm(v),y=TP(dn(e,v,!0),Dc(dn(e,_,!0),v)),N=Cc(y,v),R=zm(N);x=c5(dn(e,N,!0),N,f,Dc(dn(e,R,!0),N),d,x);break;case"macro":x=A5(g,r,i,f,a[n],d,h,p);break;case"dialog":x=C5(g,r,i,f,a[n],d,h,p);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=x;var T=[];a&&a[n]&&ui(a[n]).forEach(function(z){var J="";if(a[n][z].Type==Ni.CMNT){J=Cc(a[n][z].Target,r);var U=N5(Ht(e,J,!0),J,f);if(!U||!U.length)return;Ew(x,U,!1)}a[n][z].Type==Ni.TCMNT&&(J=Cc(a[n][z].Target,r),T=T.concat(SP(Ht(e,J,!0),f)))}),T&&T.length&&Ew(x,T,!0,f.people||[])}catch(z){if(f.WTF)throw z}}function An(e){return e.charAt(0)=="/"?e.slice(1):e}function bM(e,r){if(Zw(),r=r||{},Tp(r),Fn(e,"META-INF/manifest.xml")||Fn(e,"objectdata.xml"))return Pw(e,r);if(Fn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Bm<"u"){if(e.FileIndex)return Bm(e);var t=at.utils.cfb_new();return qb(e).forEach(function(Ce){bN(t,Ce,a2(e,Ce))}),Bm(t)}throw new Error("Unsupported NUMBERS file")}if(!Fn(e,"[Content_Types].xml"))throw Fn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Fn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=qb(e),i=gD(dn(e,"[Content_Types].xml")),a=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",Ht(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!Ht(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var f={},d={};if(!r.bookSheets&&!r.bookProps){if(Lc=[],i.sst)try{Lc=R5(Ht(e,An(i.sst)),i.sst,r)}catch(Ce){if(r.WTF)throw Ce}r.cellStyles&&i.themes.length&&(f=I5(dn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],r)),i.style&&(d=F5(Ht(e,An(i.style)),i.style,f,r))}i.links.map(function(Ce){try{var he=Dc(dn(e,zm(An(Ce))),Ce);return O5(Ht(e,An(Ce)),he,Ce,r)}catch{}});var h=T5(Ht(e,An(i.workbooks[0])),i.workbooks[0],r),p={},g="";i.coreprops.length&&(g=Ht(e,An(i.coreprops[0]),!0),g&&(p=T2(g)),i.extprops.length!==0&&(g=Ht(e,An(i.extprops[0]),!0),g&&wD(g,p,r)));var x={};(!r.bookSheets||r.bookProps)&&i.custprops.length!==0&&(g=dn(e,An(i.custprops[0]),!0),g&&(x=ED(g,r)));var v={};if((r.bookSheets||r.bookProps)&&(h.Sheets?o=h.Sheets.map(function(he){return he.name}):p.Worksheets&&p.SheetNames.length>0&&(o=p.SheetNames),r.bookProps&&(v.Props=p,v.Custprops=x),r.bookSheets&&typeof o<"u"&&(v.SheetNames=o),r.bookSheets?v.SheetNames:r.bookProps))return v;o={};var _={};r.bookDeps&&i.calcchain&&(_=D5(Ht(e,An(i.calcchain)),i.calcchain,r));var y=0,N={},R,T;{var z=h.Sheets;p.Worksheets=z.length,p.SheetNames=[];for(var J=0;J!=z.length;++J)p.SheetNames[J]=z[J].name}var U=a?"bin":"xml",D=i.workbooks[0].lastIndexOf("/"),j=(i.workbooks[0].slice(0,D+1)+"_rels/"+i.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");Fn(e,j)||(j="xl/_rels/workbook."+U+".rels");var V=Dc(dn(e,j,!0),j.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(r.xlmeta=P5(Ht(e,An(i.metadata[0])),i.metadata[0],r)),(i.people||[]).length>=1&&(r.people=AP(Ht(e,An(i.people[0])),r)),V&&(V=xM(V,h.Sheets));var re=Ht(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=p.Worksheets;++y){var te="sheet";if(V&&V[y]?(R="xl/"+V[y][1].replace(/[\/]?xl\//,""),Fn(e,R)||(R=V[y][1]),Fn(e,R)||(R=j.replace(/_rels\/.*$/,"")+V[y][1]),te=V[y][2]):(R="xl/worksheets/sheet"+(y+1-re)+"."+U,R=R.replace(/sheet0\./,"sheet.")),T=R.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(y!=r.sheets)continue e;break;case"string":if(p.SheetNames[y].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var X=!1,me=0;me!=r.sheets.length;++me)typeof r.sheets[me]=="number"&&r.sheets[me]==y&&(X=1),typeof r.sheets[me]=="string"&&r.sheets[me].toLowerCase()==p.SheetNames[y].toLowerCase()&&(X=1);if(!X)continue e}}vM(e,R,T,p.SheetNames[y],y,N,o,te,r,h,f,d)}return v={Directory:i,Workbook:h,Props:p,Custprops:x,Deps:_,Sheets:o,SheetNames:p.SheetNames,Strings:Lc,Styles:d,Themes:f,SSF:dr(ze)},r&&r.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(Ce,he){Ce=Ce.replace(/^Root Entry[\/]/,""),v.keys.push(Ce),v.files[Ce]=e.FileIndex[he]}))),r&&r.bookVBA&&(i.vba.length>0?v.vbaraw=Ht(e,An(i.vba[0]),!0):i.defaults&&i.defaults.bin===RP&&(v.vbaraw=Ht(e,"xl/vbaProject.bin",!0))),v}function wM(e,r){var t=r||{},n="Workbook",i=at.find(e,n);try{if(n="/!DataSpaces/Version",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(h8(i.content),n="/!DataSpaces/DataSpaceMap",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=p8(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=g8(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);x8(i.content)}catch{}if(n="/EncryptionInfo",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=v8(i.content);if(n="/EncryptedPackage",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,t.password||"",t);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function kp(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=hn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function yM(e,r){return at.find(e,"EncryptedPackage")?wM(e,r):cy(e,r)}function EM(e,r){var t,n=e,i=r||{};return i.type||(i.type=it&&Buffer.isBuffer(e)?"buffer":"base64"),t=s2(n,i),bM(t,i)}function dy(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return $m(e.slice(t),r);default:break e}return Vc.to_workbook(e,r)}function TM(e,r){var t="",n=kp(e,r);switch(r.type){case"base64":t=hn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Qa(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=wt(t)),r.type="binary",dy(t,r)}function kM(e,r){var t=e;return r.type=="base64"&&(t=hn(t)),t=dt.utils.decode(1200,t.slice(2),"str"),r.type="binary",dy(t,r)}function SM(e){return e.match(/[^\x00-\x7F]/)?Fc(e):e}function Um(e,r,t,n){return n?(t.type="string",Vc.to_workbook(e,t)):Vc.to_workbook(r,t)}function Cu(e,r){Hw();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Cu(new Uint8Array(e),(t=dr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),so={},t.dateNF&&(so.dateNF=t.dateNF),t.type||(t.type=it&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=it?"buffer":"binary",n=hN(e),typeof Uint8Array<"u"&&!it&&(t.type="array")),t.type=="string"&&(a=!0,t.type="binary",t.codepage=65001,n=SM(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return t=dr(t),t.type="array",Cu(Zm(n),t)}switch((i=kp(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return yM(at.read(n,t),t);break;case 9:if(i[1]<=8)return cy(n,t);break;case 60:return $m(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return e8(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return JO.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?EM(n,t):Um(e,n,t,a);case 239:return i[3]===60?$m(n,t):Um(e,n,t,a);case 255:if(i[1]===254)return kM(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return Pc.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Pc.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return yw.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return R8.to_workbook(n,t);break;case 10:case 13:case 32:return TM(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return qO.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?yw.to_workbook(n,t):Um(e,n,t,a)}function AM(e,r,t,n,i,a,o,l){var f=hr(t),d=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!o||e[t])for(var x=r.s.c;x<=r.e.c;++x){var v=o?e[t][x]:e[n[x]+f];if(v===void 0||v.t===void 0){if(d===void 0)continue;a[x]!=null&&(g[a[x]]=d);continue}var _=v.v;switch(v.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[x]!=null){if(_==null)if(v.t=="e"&&_===null)g[a[x]]=null;else if(d!==void 0)g[a[x]]=d;else if(h&&_===null)g[a[x]]=null;else continue;else g[a[x]]=h&&(v.t!=="n"||v.t==="n"&&l.rawNumbers!==!1)?_:Li(v,_,l);_!=null&&(p=!1)}}return{row:g,isempty:p}}function qm(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,a=[],o=0,l="",f={s:{r:0,c:0},e:{r:0,c:0}},d=r||{},h=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof h){case"string":f=Pt(h);break;case"number":f=Pt(e["!ref"]),f.s.r=h;break;default:f=h}n>0&&(i=0);var p=hr(f.s.r),g=[],x=[],v=0,_=0,y=Array.isArray(e),N=f.s.r,R=0,T={};y&&!e[N]&&(e[N]=[]);var z=d.skipHidden&&e["!cols"]||[],J=d.skipHidden&&e["!rows"]||[];for(R=f.s.c;R<=f.e.c;++R)if(!(z[R]||{}).hidden)switch(g[R]=Qt(R),t=y?e[N][R]:e[g[R]+p],n){case 1:a[R]=R-f.s.c;break;case 2:a[R]=g[R];break;case 3:a[R]=d.header[R-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),l=o=Li(t,null,d),_=T[o]||0,!_)T[o]=1;else{do l=o+"_"+_++;while(T[l]);T[o]=_,T[l]=1}a[R]=l}for(N=f.s.r+i;N<=f.e.r;++N)if(!(J[N]||{}).hidden){var U=AM(e,f,N,g,n,a,y,d);(U.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(x[v++]=U.row)}return x.length=v,x}var Uw=/"/g;function CM(e,r,t,n,i,a,o,l){for(var f=!0,d=[],h="",p=hr(t),g=r.s.c;g<=r.e.c;++g)if(n[g]){var x=l.dense?(e[t]||[])[g]:e[n[g]+p];if(x==null)h="";else if(x.v!=null){f=!1,h=""+(l.rawNumbers&&x.t=="n"?x.v:Li(x,null,l));for(var v=0,_=0;v!==h.length;++v)if((_=h.charCodeAt(v))===i||_===a||_===34||l.forceQuotes){h='"'+h.replace(Uw,'""')+'"';break}h=="ID"&&(h='"ID"')}else x.f!=null&&!x.F?(f=!1,h="="+x.f,h.indexOf(",")>=0&&(h='"'+h.replace(Uw,'""')+'"')):h="";d.push(h)}return l.blankrows===!1&&f?null:d.join(o)}function hy(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var i=Pt(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,f=l.charCodeAt(0),d=new RegExp((a=="|"?"\\|":a)+"+$"),h="",p=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(g[v]||{}).hidden||(p[v]=Qt(v));for(var _=0,y=i.s.r;y<=i.e.r;++y)(x[y]||{}).hidden||(h=CM(e,i,y,p,o,f,a,n),h!=null&&(n.strip&&(h=h.replace(d,"")),(h||n.blankrows!==!1)&&t.push((_++?l:"")+h)));return delete n.dense,t.join("")}function FM(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=hy(e,r);if(typeof dt>"u"||r.type=="string")return t;var n=dt.utils.encode(1200,t,"str");return"\xFF\xFE"+n}function IM(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var i=Pt(e["!ref"]),a="",o=[],l,f=[],d=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=Qt(l);for(var h=i.s.r;h<=i.e.r;++h)for(a=hr(h),l=i.s.c;l<=i.e.c;++l)if(r=o[l]+a,t=d?(e[h]||[])[l]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}f[f.length]=r+"="+n}return f}function my(e,r,t){var n=t||{},i=+!n.skipHeader,a=e||{},o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?Hr(n.origin):n.origin;o=f.r,l=f.c}var d,h={s:{c:0,r:0},e:{c:l,r:o+r.length-1+i}};if(a["!ref"]){var p=Pt(a["!ref"]);h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),o==-1&&(o=p.e.r+1,h.e.r=o+r.length-1+i)}else o==-1&&(o=0,h.e.r=r.length-1+i);var g=n.header||[],x=0;r.forEach(function(_,y){ui(_).forEach(function(N){(x=g.indexOf(N))==-1&&(g[x=g.length]=N);var R=_[N],T="z",z="",J=Be({c:l+x,r:o+y+i});d=$c(a,J),R&&typeof R=="object"&&!(R instanceof Date)?a[J]=R:(typeof R=="number"?T="n":typeof R=="boolean"?T="b":typeof R=="string"?T="s":R instanceof Date?(T="d",n.cellDates||(T="n",R=Vr(R)),z=n.dateNF||ze[14]):R===null&&n.nullError&&(T="e",R=0),d?(d.t=T,d.v=R,delete d.w,delete d.R,z&&(d.z=z)):a[J]=d={t:T,v:R},z&&(d.z=z))})}),h.e.c=Math.max(h.e.c,l+g.length-1);var v=hr(o);if(i)for(x=0;x<g.length;++x)a[Qt(x+l)+v]={t:"s",v:g[x]};return a["!ref"]=st(h),a}function RM(e,r){return my(null,e,r)}function $c(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Hr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?$c(e,Be(r)):$c(e,Be({r,c:t||0}))}function NM(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Sp(){return{SheetNames:[],Sheets:{}}}function Ap(e,r,t,n){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var a=t.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=o+i)!=-1;++i);}if(g5(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function DM(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=NM(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function OM(e,r){return e.z=r,e}function py(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function PM(e,r,t){return py(e,"#"+r,t)}function LM(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function MM(e,r,t,n){for(var i=typeof r!="string"?r:Pt(r),a=typeof r=="string"?r:st(r),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var f=$c(e,o,l);f.t="n",f.F=a,delete f.v,o==i.s.r&&l==i.s.c&&(f.f=t,n&&(f.D=!0))}return e}var gy={encode_col:Qt,encode_row:hr,encode_cell:Be,encode_range:st,decode_col:dp,decode_row:up,split_cell:YN,decode_cell:Hr,decode_range:ho,format_cell:Li,sheet_add_aoa:v2,sheet_add_json:my,sheet_add_dom:ly,aoa_to_sheet:mo,json_to_sheet:RM,table_to_sheet:fy,table_to_book:eM,sheet_to_csv:hy,sheet_to_txt:FM,sheet_to_json:qm,sheet_to_html:Z5,sheet_to_formulae:IM,sheet_to_row_object_array:qm,sheet_get_cell:$c,book_new:Sp,book_append_sheet:Ap,book_set_sheet_visibility:DM,cell_set_number_format:OM,cell_set_hyperlink:py,cell_set_internal_link:PM,cell_add_comment:LM,sheet_set_array_formula:MM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var v9=Ww.version;var E9=(()=>{let r=class r{constructor(n){this.firebaseProvider=n,this.pushToFirebase=[]}handleSave(n,i,a,o){let l=i.rootPath,f=n.find(d=>d[l]);if(f)if(Array.isArray(f[l])){let d=f[l].map(h=>this.processSave(h,i,n,a,l,o));return Promise.all(d).then(h=>h[0])}else return this.processSave(f[l],i,n,a,l,o);return Promise.resolve({id:"",rev:""})}processSave(n,i,a,o,l,f){return i.objectType!=="primary"&&i?.parentObject&&(n[i?.parentObject]=o),this.saveToDB(n,l,f).then(d=>{if(console.log(`Saved ${i.objectName} with ID: ${d}`),i&&i.childObject&&i.childObject.length>0){let h=i.childObject.map(p=>this.handleSave(a,p,d,f));return Promise.all(h).then(()=>({id:d,rev:n.rev}))}return{id:d,rev:n.rev}})}saveToDB(n,i,a){return lr(this,null,function*(){let o=a.dataObject[i].id,l=a.dataObject[i].rev,f=o?"update":"add",d=this.findHierarchyByRootPath(a.objectHierarchy,i);try{let h=yield this.firebaseProvider.generateIdForPrimaryField(n.type,d);if(f==="add"){n[d.primaryFieldName]=h;let p={data:n,timestamp:xr.database.ServerValue.TIMESTAMP,id:n.type+"_2_"+ua(),rev:"0_"+ua()};console.log("Saving new record to DB:",p);let g=yield this.firebaseProvider.create(p);return a.dataObject[i].id=g.id,a.dataObject[i].rev=g.rev,g.id}else{let p={data:n,id:o,rev:l};if(console.log("Updating existing record in DB:",p),a.dirtyStatus[i]){let g=yield this.firebaseProvider.update(o,l,p);return a.dataObject[i].id=g.id,a.dataObject[i].rev=g.rev,g.id}else return o}}catch(h){throw console.error("Error during ID generation or DB operation:",h),h}})}fetch(n,i,a){return lr(this,null,function*(){for(let o of n){let l;if(o.objectType==="primary"){let f=yield this.firebaseProvider.queryDataWithFilter("ticRecordOBJECT","id",i,o.objectName);f&&f.length>0&&(l=f[0],a.dataObject[o.rootPath]=Yi(Ki({},l.data),{id:l.id,rev:l.rev}))}if(o.objectType==="ONETOONE"){let f=yield this.firebaseProvider.queryDataWithFilter("ticRecordOBJECT","data/"+o.parentObject,i,o.objectName);f&&f.length>0&&(l=f[0],a.dataObject[o.rootPath]=Yi(Ki({},l.data),{id:l.id,rev:l.rev}))}if(o.objectType==="ONETOMANY"){let f=yield this.firebaseProvider.queryDataByField("ticRecordOBJECT","data/"+o.parentKey,i);f&&f.length>0&&(a.dataObject[o.rootPath]=[],f.forEach(d=>{a.dataObject[o.rootPath].push(Yi(Ki({},d.data),{id:d.id,rev:d.rev}))}))}o.childObject&&o.childObject.length>0&&(yield this.fetch(o.childObject,l?.id,a))}})}listFetch(n,i,a){return lr(this,null,function*(){let o=gb(),l=a;for(let f of i){let d=l;if(f.objectType==="primary"){let h=Jr(wc(o,"ticRecordOBJECT"),nu("data/type"),iu(n)),p=yield tu(h);if(p.exists()){let g=p.val();g&&Object.keys(g).length>0&&Object.keys(g).forEach(x=>{let v={[f.objectName]:Yi(Ki({},g[x].data),{id:g[x].id,rev:g[x].rev})};d.push(v)})}}if(f.objectType==="ONETOONE"){let h=d.map(p=>lr(this,null,function*(){let g=yield this.firebaseProvider.queryDataWithFilter("ticRecordOBJECT","data/"+f.parentObject,p[f.parentObject]?.id,f.objectName);if(g&&g[0]){let x=g[0].data;p[f.objectName]=Yi(Ki({},x),{id:g[0].id,rev:g[0].rev})}}));yield Promise.all(h)}if(f.childObject&&f.childObject.length>0){let h=yield this.listFetch("",f.childObject,d);l=l.concat(h)}}return l=(0,_y.uniqBy)(l,f=>{let d=Object.keys(f)[0];return f[d]?.id}),l})}findHierarchyByRootPath(n,i){for(let a of n){if(a.rootPath===i)return a;if(a.childObject&&a.childObject.length>0){let o=this.findHierarchyByRootPath(a.childObject,i);if(o)return o}}return null}handleFileInput(n){let i=n.target.files[0];if(i){let a=new FileReader;a.onload=o=>{let l=new Uint8Array(o.target.result),f=Cu(l,{type:"array"}),d=f.Sheets[f.SheetNames[0]],h=gy.sheet_to_json(d,{header:1});this.processData(h.slice(1))},a.readAsArrayBuffer(i)}}processData(n){n.forEach((i,a)=>{let o={data:{Date:i[1].toString()||"",EventId:`Eve_${String(a+1).padStart(2,"0")}`,EventName:i[2]||"",Place:i[3]||"",Writers:i[4]||0,Contacts:i[5]||0,PhoneNumber:i[6]||"",Status:!0,type:"Event"},id:`Event_${a+1}_${ua()}`,rev:`1_${ua()}`,timestamp:Date.now()};this.pushToFirebase.push(o),this.firebaseProvider.pushToFirebases(o)}),console.log(this.pushToFirebase),alert("added successfully")}};r.\u0275fac=function(i){return new(i||r)(Ve(Pb))},r.\u0275prov=qr({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();var S9=(()=>{let r=class r{constructor(){this.layoutConfiguration={EventEntry_ENTRY:{layoutDisplayName:"Event Entry",headerActionInfo:[{buttonAction:"LIST",buttonType:"ICON-ONLY",redirectTo:"EventList_LIST",redirectFrom:"EventEntry_ENTRY",buttonText:"Event List",buttonIcon:"list",buttonBackgroundColor:"#3fb5b5",buttonTextColor:"#fff"},{buttonAction:"SAVE",buttonType:"TEXT+ICON",buttonText:"Save Event",buttonBackgroundColor:"#ff4081",buttonTextColor:"#fff",buttonIcon:"save",redirectNeeded:!0,redirectTo:"department_VIEW",redirectFrom:"department_ENTRY"}]},EventView_VIEW:{layoutDisplayName:"Event View",headerActionInfo:[{buttonAction:"ADD",buttonType:"TEXT-ONLY",redirectTo:"EventEntry_ENTRY",redirectFrom:"EventView_VIEW",buttonText:"Add Event",buttonBackgroundColor:"#3fb5b5",buttonTextColor:"#fff"},{buttonAction:"LIST",buttonType:"ICON-ONLY",buttonIcon:"lists",redirectTo:"EventList_LIST",redirectFrom:"EventView_VIEW",buttonText:"Event List",buttonBackgroundColor:"#ff4081",buttonIconColor:"#fff"},{buttonAction:"EDIT",buttonType:"ICON-ONLY",buttonIcon:"edit",redirectTo:"EventEntry_ENTRY",redirectFrom:"EventView_VIEW",buttonText:"Edit Event",buttonBackgroundColor:"#1e8347",buttonIconColor:"#fff"}]},EventList_LIST:{layoutDisplayName:"Event List",headerActionInfo:[{buttonAction:"ADD",buttonType:"TEXT-ONLY",redirectTo:"EventEntry_ENTRY",redirectFrom:"EventList_LIST",buttonText:"Add Event",buttonBackgroundColor:"#3fb5b5",buttonTextColor:"#fff"}],columnFieldInfo:[{fieldName:"Event.EventId",fieldDisplayName:"Event Id",sortable:!0,editable:!1,fieldType:"string",editor:{type:"text"}},{fieldName:"Event.EventName",fieldDisplayName:"Event Name",sortable:!0,editable:!1,fieldType:"string",editor:{type:"text"}},{fieldName:"Event.Place",fieldDisplayName:"Place",sortable:!0,editable:!1,fieldType:"string",editor:{type:"text"}},{fieldName:"Event.Date",fieldDisplayName:"Date",sortable:!0,editable:!1,fieldType:"string",editor:{type:"text"}},{fieldName:"Event.PhoneNumber",fieldDisplayName:"Phone Number",sortable:!0,editable:!1,fieldType:"number",editor:{type:"text"}},{fieldName:"Event.Writers",fieldDisplayName:"No Of Writers",sortable:!0,editable:!1,fieldType:"number",editor:{type:"text"}},{fieldName:"Event.Contacts",fieldDisplayName:"No Of Contacts",sortable:!0,editable:!1,fieldType:"number",editor:{type:"text"}},{fieldName:"Event.Status",fieldDisplayName:"Status",fieldType:"boolean",sortable:!0,editable:!1,editor:{type:"boolean",options:["Active","Inactive"]}},{fieldName:"Event.editEvent",fieldDisplayName:"Edit Event",fieldType:"action",buttonInfoSet:[{buttonAction:"EDIT",buttonType:"TEXT+ICON",redirectTo:"EventEntry_ENTRY",redirectFrom:"EventList_LIST",buttonText:"Edit Event",buttonIcon:"edit",buttonBackgroundColor:"#ffce33",buttonTextColor:"#fff"}]},{fieldName:"Event.addEvent",fieldDisplayName:"Add Event",fieldType:"action",buttonInfoSet:[{buttonAction:"ADD",buttonType:"TEXT-ONLY",redirectTo:"EventEntry_ENTRY",redirectFrom:"EventList_LIST",buttonText:"Add Event",buttonBackgroundColor:"#3fb5b5",buttonTextColor:"#fff"}]},{fieldName:"Event.view",fieldDisplayName:"View",fieldType:"action",buttonInfoSet:[{buttonAction:"VIEW",buttonType:"ICON-ONLY",buttonText:"Event View",buttonIcon:"visibility",redirectTo:"EventView_VIEW",redirectFrom:"EventList_LIST",buttonBackgroundColor:"#ff4081",buttonIconColor:"#fff"}]}]}}}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=qr({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();export{H_ as a,z_ as b,X_ as c,Q_ as d,J_ as e,_B as f,SB as g,GB as h,e9 as i,r9 as j,ua as k,Pb as l,Lb as m,E9 as n,S9 as o};
